Warning: Permanently added '[localhost]:38214' (ED25519) to the list of known hosts.
executing program
syzkaller login: [  138.282990] audit: type=1400 audit(1731032537.333:6): avc:  denied  { execmem } for  pid=236 comm="syz-executor422" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
[  138.316962] EXT4-fs (loop0): mounted filesystem without journal. Opts: ,errors=continue
[  138.365548] EXT4-fs error (device loop0): ext4_xattr_ibody_find:2175: inode #18: comm syz-executor422: corrupted in-inode xattr
[  138.377467] EXT4-fs error (device loop0): ext4_map_blocks:708: inode #18: block 4: comm syz-executor422: lblock 1 mapped to illegal pblock 4 (length 1)
[  138.382883] EXT4-fs (loop0): Delayed block allocation failed for inode 18 at logical offset 1 with max blocks 1 with error 117
[  138.386218] EXT4-fs (loop0): This should not happen!! Data will be lost
[  138.386218] 
[  138.388055] EXT4-fs warning (device loop0): ext4_da_release_space:1508: ext4_da_release_space: ino 18, to_free 1 with only 0 reserved data blocks
[  138.399276] ------------[ cut here ]------------
[  138.404122] WARNING: CPU: 0 PID: 236 at fs/ext4/inode.c:1512 ext4_da_release_space+0x4c5/0x5c0
[  138.405858] Modules linked in:
[  138.406396] CPU: 0 PID: 236 Comm: syz-executor422 Not tainted 5.10.0 #1
[  138.407562] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[  138.414425] RIP: 0010:ext4_da_release_space+0x4c5/0x5c0
[  138.416874] Code: 3c 11 00 0f 85 d4 00 00 00 48 8b 7d 28 41 57 41 89 d9 ba e4 05 00 00 48 c7 c1 20 a0 52 84 48 c7 c6 c0 b4 52 84 e8 7b 90 0e 00 <0f> 0b 48 b8 00 00 00 00 00 fc ff df 4c 89 f2 48 c1 ea 03 0f b6 04
[  138.421420] RSP: 0018:ffff888012be7140 EFLAGS: 00010282
[  138.422768] RAX: 0000000000000000 RBX: 0000000000000001 RCX: 0000000000000000
[  138.425417] RDX: ffff888011058000 RSI: ffffffff81b43718 RDI: ffffed100257cdf7
[  138.427263] RBP: ffff8880188720c0 R08: 0000000000000085 R09: ffff88806ce2fc0f
[  138.429341] R10: 0000000000000000 R11: 0000000000000001 R12: ffff888010df8000
[  138.431215] R13: ffff888018872678 R14: ffff8880188725b8 R15: 0000000000000000
[  138.433317] FS:  00005555559d8380(0000) GS:ffff88806ce00000(0000) knlGS:0000000000000000
[  138.435279] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  138.436872] CR2: 000055ec3f861268 CR3: 00000000088f0000 CR4: 0000000000350ef0
[  138.438375] Call Trace:
[  138.438968]  ext4_es_remove_extent+0x20d/0x460
[  138.439802]  ? ext4_es_lookup_extent+0xc90/0xc90
[  138.440605]  ? record_print_text.cold+0x16/0x16
[  138.441467]  mpage_release_unused_pages+0x4d3/0x680
[  138.442295]  ? ___ratelimit+0x21c/0x4b0
[  138.442965]  ? __ext4_expand_extra_isize+0x440/0x440
[  138.443885]  ? __ext4_msg+0x12b/0x190
[  138.444623]  ? ext4_decode_error+0x190/0x190
[  138.445424]  ? __put_compound_page+0x140/0x140
[  138.446379]  ext4_writepages+0x1548/0x3a00
[  138.447164]  ? __ext4_mark_inode_dirty+0x860/0x860
[  138.447964]  ? ext4_mark_iloc_dirty+0x1bd3/0x3710
[  138.448819]  ? __ext4_mark_inode_dirty+0x21b/0x860
[  138.449617]  ? ext4_expand_extra_isize+0x5a0/0x5a0
[  138.450396]  ? __ext4_mark_inode_dirty+0x860/0x860
[  138.451120]  do_writepages+0xee/0x290
[  138.451714]  ? page_writeback_cpu_online+0x10/0x10
[  138.452429]  ? __mark_inode_dirty+0x12e/0x11a0
[  138.453127]  ? generic_write_end+0x20e/0x400
[  138.453813]  __filemap_fdatawrite_range+0x24b/0x2f0
[  138.454520]  ? delete_from_page_cache_batch+0xb20/0xb20
[  138.455358]  file_write_and_wait_range+0xb2/0x120
[  138.456091]  ext4_sync_file+0x225/0xf40
[  138.456652]  ? ext4_getfsmap+0xa90/0xa90
[  138.457222]  vfs_fsync_range+0x13d/0x230
[  138.457806]  ext4_buffered_write_iter+0x36a/0x4d0
[  138.458469]  ext4_file_write_iter+0x431/0x1b20
[  138.459118]  ? __lock_acquire+0x1661/0x5ca0
[  138.459742]  ? ext4_file_read_iter+0x4c0/0x4c0
[  138.460376]  do_iter_readv_writev+0x476/0x760
[  138.461008]  ? new_sync_write+0x670/0x670
[  138.461575]  ? selinux_file_permission+0xcc/0x590
[  138.462267]  do_iter_write+0x18d/0x670
[  138.462829]  vfs_writev+0x1aa/0x660
[  138.463328]  ? vfs_iter_write+0xa0/0xa0
[  138.463914]  ? rcu_read_lock_sched_held+0x3a/0x70
[  138.464576]  ? __rseq_handle_notify_resume+0x605/0x1250
[  138.465335]  do_pwritev+0x1bc/0x270
[  138.465855]  ? __ia32_sys_writev+0xb0/0xb0
[  138.466441]  __x64_sys_pwritev2+0xeb/0x150
[  138.467045]  do_syscall_64+0x33/0x40
[  138.467560]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[  138.468293] RIP: 0033:0x7f538143cdcd
[  138.468819] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[  138.471418] RSP: 002b:00007ffde2c6cac8 EFLAGS: 00000246 ORIG_RAX: 0000000000000148
[  138.472574] RAX: ffffffffffffffda RBX: 0000000000000001 RCX: 00007f538143cdcd
[  138.473680] RDX: 0000000000000001 RSI: 0000000020001800 RDI: 0000000000000005
[  138.474780] RBP: 00007ffde2c6cb80 R08: 0000000000000000 R09: 0000000000000014
[  138.475849] R10: 0000000000000000 R11: 0000000000000246 R12: 00007ffde2c6cbf8
[  138.476908] R13: 00007ffde2c6cc08 R14: 00007f53814cad10 R15: 0000000000000001
[  138.478017] irq event stamp: 33233
[  138.478604] hardirqs last  enabled at (33241): [<ffffffff812d54e1>] console_unlock+0x991/0xba0
[  138.479974] hardirqs last disabled at (33250): [<ffffffff812d53cf>] console_unlock+0x87f/0xba0
[  138.481252] softirqs last  enabled at (32728): [<ffffffff84000f92>] asm_call_irq_on_stack+0x12/0x20
[  138.482714] softirqs last disabled at (32721): [<ffffffff84000f92>] asm_call_irq_on_stack+0x12/0x20
[  138.484196] ---[ end trace 7f1eb2466938346f ]---

VM DIAGNOSIS:
10:22:17  Registers:
info registers vcpu 0

CPU#0
RAX=dffffc0000000060 RBX=0000000000000005 RCX=0000000000000000 RDX=00000000000003fd
RSI=ffffffff823c0aec RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff888012be6b18
R8 =0000000000000001 R9 =0000000000000003 R10=000000000000001f R11=0000000000000001
R12=0000000000000000 R13=fffffbfff0f492a7 R14=fffffbfff0f4925e R15=dffffc0000000000
RIP=ffffffff823c0b14 RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00005555559d8380 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=000055ec3f861268 CR3=00000000088f0000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 2037313a32323a32 3020382020766f4e
YMM01=0000000000000000 0000000000000000 5d3834353536332e 38333120205b203a
YMM02=0000000000000000 0000000000000000 65203a2930706f6f 6c20656369766564
YMM03=0000000000000000 0000000000000000 65646f6e69203a35 3731323a646e6966
YMM04=0000000000000000 0000000000000000 646574707572726f 63203a323234726f
YMM05=0000000000000000 0000000000000000 3a3831232065646f 6e69203a35373132
YMM06=0000000000000000 0000000000000000 785f34747865203a 2930706f6f6c2065
YMM07=0000000000000000 0000000000000000 34545845205d3834 353536332e383331
YMM08=0000000000000000 0000000000000000 6f7475636578652d 7a7973223d6d6d6f
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=0000000000000050 RBX=ffff88800bbd0000 RCX=ffffffff8200b154 RDX=00000000000001f7
RSI=ffffffff8200b162 RDI=0000000000000007 RBP=00000000000101f7 RSP=ffff888010f1ead0
R8 =0000000000000000 R9 =ffffffff85d66c0f R10=0000000000010000 R11=0000000000000001
R12=ffffed100177a001 R13=dffffc0000000000 R14=ffffffff85876520 R15=ffff88800bbd0008
RIP=ffffffff8200b166 RFL=00000093 [--S-A-C] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007f2f17562700 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f2f1758fca0 CR3=000000000bce8000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 0000000000000000 00000000000000ff
YMM02=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM03=0000000000000000 0000000000000000 494950202b205846 3034346928204350
YMM04=0000000000000000 0000000000000000 6573657220302079 6c6e6f2068746977
YMM05=0000000000000000 0000000000000000 6e69203a65636170 735f657361656c65
YMM06=0000000000000000 0000000000000000 65636170735f6573 61656c65725f6164
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 322f31302f343020 322d332e36312e31
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
