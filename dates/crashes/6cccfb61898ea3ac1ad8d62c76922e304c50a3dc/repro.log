Warning: Permanently added '[localhost]:52524' (ED25519) to the list of known hosts.
executing program
syzkaller login: [  199.626231] audit: type=1400 audit(1730937622.967:6): avc:  denied  { execmem } for  pid=239 comm="syz-executor157" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
[  199.627926] kernel profiling enabled (shift: -2147483647)
[  199.633977] ================================================================================
[  199.635661] UBSAN: shift-out-of-bounds in kernel/profile.c:110:31
[  199.636938] shift exponent 18446744071562067969 is too large for 64-bit type 'long int'
[  199.638612] CPU: 1 PID: 239 Comm: syz-executor157 Not tainted 5.10.0 #1
[  199.640726] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[  199.642779] Call Trace:
[  199.643295]  dump_stack+0x107/0x163
[  199.644048]  ubsan_epilogue+0xb/0x5a
[  199.644808]  __ubsan_handle_shift_out_of_bounds.cold+0xb2/0x186
[  199.646045]  profile_init+0xfc/0x110
[  199.646797]  profiling_store+0x5e/0xd0
[  199.647582]  ? kexec_crash_loaded_show+0x30/0x30
[  199.648557]  kobj_attr_store+0x53/0x80
[  199.649228]  ? kobj_attr_show+0x70/0x70
[  199.649857]  sysfs_kf_write+0x113/0x170
[  199.650544]  ? sysfs_file_ops+0x1c0/0x1c0
[  199.651390]  kernfs_fop_write+0x26a/0x490
[  199.652230]  ? kernfs_notify+0x1f0/0x1f0
[  199.653071]  vfs_write+0x29a/0xac0
[  199.653834]  ksys_write+0x12d/0x250
[  199.654602]  ? __ia32_sys_read+0xb0/0xb0
[  199.655456]  ? syscall_enter_from_user_mode+0x27/0x80
[  199.656456]  do_syscall_64+0x33/0x40
[  199.657037]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[  199.657971] RIP: 0033:0x7fae697f415d
[  199.658676] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[  199.662233] RSP: 002b:00007ffce65938a8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
[  199.663766] RAX: ffffffffffffffda RBX: 0000000000000001 RCX: 00007fae697f415d
[  199.665263] RDX: 0000000000000012 RSI: 0000000020000000 RDI: 0000000000000003
[  199.666775] RBP: 00007ffce6593950 R08: 0000000000000003 R09: 00007ffce6593950
[  199.668341] R10: 0000000000000078 R11: 0000000000000246 R12: 00007ffce65939c8
[  199.669768] R13: 00007ffce65939d8 R14: 00007fae69888d10 R15: 0000000000000001
[  199.671442] ================================================================================
[  199.737559] ================================================================================
[  199.739328] UBSAN: shift-out-of-bounds in kernel/profile.c:291:7
[  199.740504] shift exponent 18446744071562067969 is too large for 64-bit type 'long unsigned int'
[  199.742214] CPU: 1 PID: 239 Comm: syz-executor157 Not tainted 5.10.0 #1
[  199.743449] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[  199.744976] Call Trace:
[  199.745424]  <IRQ>
[  199.745788]  dump_stack+0x107/0x163
[  199.746377]  ubsan_epilogue+0xb/0x5a
[  199.746951]  __ubsan_handle_shift_out_of_bounds.cold+0xb2/0x186
[  199.747878]  do_profile_hits.constprop.0.cold+0x17/0x1c
[  199.748700]  profile_tick+0xe7/0x100
[  199.749269]  tick_sched_timer+0x10f/0x150
[  199.749888]  __hrtimer_run_queues+0x1c1/0xba0
[  199.750565]  ? tick_sched_do_timer+0x1f0/0x1f0
[  199.751264]  ? hrtimer_sleeper_start_expires+0x80/0x80
[  199.752041]  ? ktime_get_update_offsets_now+0xac/0x3a0
[  199.752847]  hrtimer_interrupt+0x357/0x9b0
[  199.753535]  __sysvec_apic_timer_interrupt+0x170/0x560
[  199.754348]  asm_call_irq_on_stack+0x12/0x20
[  199.755033]  </IRQ>
[  199.755391]  sysvec_apic_timer_interrupt+0xb8/0xf0
[  199.756165]  asm_sysvec_apic_timer_interrupt+0x12/0x20
[  199.756996] RIP: 0010:_raw_spin_unlock_irq+0x25/0x40
[  199.757783] Code: 0f 1f 44 00 00 55 48 8b 74 24 08 48 89 fd 48 83 c7 18 e8 ae 1f 3e fd 48 89 ef e8 86 e2 3e fd e8 11 e6 5f fd fb bf 01 00 00 00 <e8> 86 08 34 fd 65 8b 05 ff 3d 15 7c 85 c0 74 02 5d c3 e8 bb 9c 13
[  199.760704] RSP: 0018:ffff888010f0f930 EFLAGS: 00000202
[  199.761505] RAX: 000000000000f085 RBX: ffff888008c4ce00 RCX: ffffffff812a3195
[  199.762588] RDX: 0000000000000000 RSI: 0000000000000002 RDI: 0000000000000001
[  199.763707] RBP: ffff88806cf33300 R08: 0000000000000001 R09: ffffffff86e5f6a7
[  199.764824] R10: 0000000000000001 R11: 0000000000000001 R12: ffff88806cf33300
[  199.765939] R13: ffff888008250000 R14: ffff88801134d7c0 R15: 0000000000000000
[  199.767049]  ? mark_lock+0xf5/0x32b0
[  199.767624]  finish_task_switch+0x182/0x830
[  199.768290]  ? finish_task_switch+0x14b/0x830
[  199.768997]  ? __switch_to+0x5a1/0x1090
[  199.769619]  ? __switch_to_asm+0x42/0x70
[  199.770261]  ? __switch_to_asm+0x36/0x70
[  199.770887]  __schedule+0x888/0x2030
[  199.771501]  ? io_schedule_timeout+0x140/0x140
[  199.772226]  schedule+0xcf/0x270
[  199.772746]  schedule_timeout+0x387/0x460
[  199.773386]  ? usleep_range+0x170/0x170
[  199.774008]  ? wait_for_completion+0x15b/0x260
[  199.774730]  ? mark_held_locks+0x9e/0xe0
[  199.775352]  ? rwlock_bug.part.0+0x90/0x90
[  199.775992]  ? _raw_spin_unlock_irq+0x1f/0x40
[  199.776686]  wait_for_completion+0x163/0x260
[  199.777361]  ? wait_for_completion_interruptible+0x2e0/0x2e0
[  199.778245]  __cpuhp_kick_ap+0x1d3/0x240
[  199.778842]  cpuhp_issue_call+0x332/0x600
[  199.779510]  __cpuhp_setup_state_cpuslocked+0x2d5/0x7b0
[  199.780388]  ? profile_prepare_cpu+0x4d0/0x4d0
[  199.781090]  __cpuhp_setup_state+0x123/0x2e0
[  199.781779]  create_proc_profile+0x93/0x130
[  199.782468]  profiling_store+0x8c/0xd0
[  199.783054]  ? kexec_crash_loaded_show+0x30/0x30
[  199.783780]  kobj_attr_store+0x53/0x80
[  199.784374]  ? kobj_attr_show+0x70/0x70
[  199.784969]  sysfs_kf_write+0x113/0x170
[  199.785576]  ? sysfs_file_ops+0x1c0/0x1c0
[  199.786205]  kernfs_fop_write+0x26a/0x490
[  199.786847]  ? kernfs_notify+0x1f0/0x1f0
[  199.787469]  vfs_write+0x29a/0xac0
[  199.788006]  ksys_write+0x12d/0x250
[  199.788569]  ? __ia32_sys_read+0xb0/0xb0
[  199.789197]  ? syscall_enter_from_user_mode+0x27/0x80
[  199.789977]  do_syscall_64+0x33/0x40
[  199.790576]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[  199.791398] RIP: 0033:0x7fae697f415d
[  199.791970] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[  199.794833] RSP: 002b:00007ffce65938a8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
[  199.795981] RAX: ffffffffffffffda RBX: 0000000000000001 RCX: 00007fae697f415d
[  199.797092] RDX: 0000000000000012 RSI: 0000000020000000 RDI: 0000000000000003
[  199.798225] RBP: 00007ffce6593950 R08: 0000000000000003 R09: 00007ffce6593950
[  199.799330] R10: 0000000000000078 R11: 0000000000000246 R12: 00007ffce65939c8
[  199.800466] R13: 00007ffce65939d8 R14: 00007fae69888d10 R15: 0000000000000001
[  199.801602] ================================================================================

VM DIAGNOSIS:
08:00:23  Registers:
info registers vcpu 0

CPU#0
RAX=ffffffff83eca430 RBX=ffffffff84e389c0 RCX=ffffffff83eb246c RDX=0000000000000000
RSI=0000000000000001 RDI=0000000000000000 RBP=0000000000000000 RSP=ffffffff84e07e40
R8 =0000000000000001 R9 =ffff88806ce3416b R10=ffffed100d9c682d R11=0000000000000001
R12=fffffbfff09c7138 R13=ffffffff85d66c08 R14=0000000000000000 R15=dffffc0000000000
RIP=ffffffff83eca43e RFL=00000206 [-----P-] CPL=0 II=0 A20=1 SMM=0 HLT=1
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f58d21bf950 CR3=000000000fa1a000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 b4438d3e1ce9acbc 02441e9c6641b085
YMM02=0000000000000000 0000000000000000 f3e88f777023e8a3 00000000000aea10
YMM03=0000000000000000 0000000000000000 ac8bc31478ec8511 00000000000aef78
YMM04=0000000000000000 0000000000000000 3322be32088c61de 0000000000128908
YMM05=0000000000000000 0000000000000000 d3fdd5f48436fbd7 00000000000aeab8
YMM06=0000000000000000 0000000000000000 65971d165c483ab5 00000000000ae970
YMM07=0000000000000000 0000000000000000 a1fcdcf819d7e1e5 00000000000ae728
YMM08=0000000000000000 0000000000000000 44495f474f4c5359 530069253d595449
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=000000000000003a RBX=0000000000000000 RCX=0000000000000000 RDX=00000000000003f8
RSI=ffffffff823c0a41 RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff888010f0f828
R8 =0000000000000001 R9 =0000000000000003 R10=000000000000001f R11=0000000000000001
R12=000000000000003a R13=0000000000000000 R14=ffffffff87a492a0 R15=dffffc0000000000
RIP=ffffffff823c0a6c RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000555555c96380 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007fae69838630 CR3=000000000ae7e000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 2525252525252525 2525252525252525
YMM01=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM02=0000000000000000 0000000000000000 0000000000000000 00000000000000ff
YMM03=0000000000000000 0000000000000000 0000000000000000 00000000000000ff
YMM04=0000000000000000 0000000000000000 00007fae6987c5a0 00007fae6988db60
YMM05=0000000000000000 0000000000000000 0000000000000001 0000000000000001
YMM06=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM07=0000000000000000 0000000000000000 2f2f2f2f2f2f2f2f 2f2f2f2f2f2f2f2f
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
