Warning: Permanently added '[localhost]:7148' (ED25519) to the list of known hosts.
syzkaller login: [   72.427026] audit: type=1400 audit(1730993012.821:6): avc:  denied  { execmem } for  pid=238 comm="syz-executor118" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
executing program
[   75.588523] FAULT_INJECTION: forcing a failure.
[   75.588523] name failslab, interval 1, probability 0, space 0, times 1
[   75.590380] CPU: 0 PID: 239 Comm: syz-executor118 Not tainted 5.10.0 #1
[   75.591537] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   75.593142] Call Trace:
[   75.593564]  dump_stack+0x107/0x163
[   75.594123]  should_fail.cold+0x5/0x1f
[   75.594730]  ? hashtab_init+0xe0/0x1c0
[   75.595349]  ? hashtab_init+0xe0/0x1c0
[   75.595977]  should_failslab+0x5/0x10
[   75.596573]  __kmalloc+0x72/0x2e0
[   75.597129]  hashtab_init+0xe0/0x1c0
[   75.597695]  ? memcpy+0x39/0x60
[   75.598193]  class_read+0x1d5/0x9b0
[   75.598789]  ? user_write+0x440/0x440
[   75.599395]  ? __kasan_kmalloc.constprop.0+0xc2/0xd0
[   75.600203]  policydb_read+0x8b7/0x6410
[   75.600851]  ? string_to_av_perm+0x1e0/0x1e0
[   75.601553]  ? find_held_lock+0x2c/0x110
[   75.602201]  ? fs_reclaim_release+0x90/0xd0
[   75.602883]  ? kasan_unpoison_shadow+0x33/0x40
[   75.603610]  ? __kasan_kmalloc.constprop.0+0xc2/0xd0
[   75.604420]  security_load_policy+0x1ab/0xfa0
[   75.605147]  ? security_get_bools+0x7c0/0x7c0
[   75.605901]  ? find_held_lock+0x2c/0x110
[   75.606588]  ? __might_fault+0xd3/0x180
[   75.607237]  ? lock_downgrade+0x6d0/0x6d0
[   75.607938]  sel_write_load+0x3a5/0x1e50
[   75.608610]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   75.609492]  ? sel_make_dir+0x2c0/0x2c0
[   75.610129]  ? lock_release+0x6f0/0x6f0
[   75.610769]  ? selinux_file_permission+0xcc/0x590
[   75.611550]  ? sel_make_dir+0x2c0/0x2c0
[   75.612169]  vfs_write+0x29a/0xac0
[   75.612732]  ksys_write+0x12d/0x250
[   75.613312]  ? __ia32_sys_read+0xb0/0xb0
[   75.613965]  ? syscall_enter_from_user_mode+0x27/0x80
[   75.614788]  do_syscall_64+0x33/0x40
[   75.615388]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   75.616219] RIP: 0033:0x7f1a397f2d2d
[   75.616799] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[   75.619814] RSP: 002b:00007ffdb829ef08 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
[   75.621046] RAX: ffffffffffffffda RBX: 0000000000000002 RCX: 00007f1a397f2d2d
[   75.622209] RDX: 000000000000005c RSI: 0000000020000000 RDI: 0000000000000003
[   75.623330] RBP: 0000000000000004 R08: 0000000000000000 R09: 0000000001bbbbbb
[   75.624463] R10: 0000000000000064 R11: 0000000000000246 R12: 00007ffdb829ef60
[   75.625585] R13: 00007ffdb829ef40 R14: 0000000000000003 R15: 0000000000000001
[   75.627098] general protection fault, probably for non-canonical address 0xdffffc0000000000: 0000 [#1] PREEMPT SMP KASAN NOPTI
[   75.629317] KASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007]
[   75.630870] CPU: 0 PID: 239 Comm: syz-executor118 Not tainted 5.10.0 #1
[   75.632512] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   75.635176] RIP: 0010:hashtab_map+0x9e/0x1b0
[   75.636450] Code: 89 44 24 08 e8 03 d7 5e ff 48 8b 44 24 08 80 38 00 0f 85 f5 00 00 00 49 8b 55 00 8b 44 24 04 4c 8d 34 c2 4c 89 f2 48 c1 ea 03 <80> 3c 1a 00 0f 85 e5 00 00 00 4d 8b 36 4d 85 f6 75 25 eb 7d e8 c9
[   75.639440] RSP: 0018:ffff88800ffa76b0 EFLAGS: 00010256
[   75.640259] RAX: 0000000000000000 RBX: dffffc0000000000 RCX: ffffffff81e7378e
[   75.641391] RDX: 0000000000000000 RSI: ffffffff81e737bd RDI: 0000000000000005
[   75.642539] RBP: ffffffff81e7d680 R08: 0000000000000dc0 R09: ffffffff852583b3
[   75.643669] R10: 0000000000000000 R11: 0000000000000001 R12: 0000000000000000
[   75.644864] R13: ffff888008f69898 R14: 0000000000000000 R15: 1ffff110011ed313
[   75.646066] FS:  00005555573f6380(0000) GS:ffff88806ce00000(0000) knlGS:0000000000000000
[   75.647348] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[   75.648266] CR2: 0000000020000040 CR3: 000000000aa52000 CR4: 0000000000350ef0
[   75.649385] Call Trace:
[   75.649796]  cls_destroy+0x48/0x3d0
[   75.650366]  class_read+0x1fa/0x9b0
[   75.650938]  ? user_write+0x440/0x440
[   75.651540]  ? __kasan_kmalloc.constprop.0+0xc2/0xd0
[   75.652326]  policydb_read+0x8b7/0x6410
[   75.652969]  ? string_to_av_perm+0x1e0/0x1e0
[   75.653673]  ? find_held_lock+0x2c/0x110
[   75.654307]  ? fs_reclaim_release+0x90/0xd0
[   75.654989]  ? kasan_unpoison_shadow+0x33/0x40
[   75.655720]  ? __kasan_kmalloc.constprop.0+0xc2/0xd0
[   75.656563]  security_load_policy+0x1ab/0xfa0
[   75.657283]  ? security_get_bools+0x7c0/0x7c0
[   75.657984]  ? find_held_lock+0x2c/0x110
[   75.658622]  ? __might_fault+0xd3/0x180
[   75.659236]  ? lock_downgrade+0x6d0/0x6d0
[   75.659882]  sel_write_load+0x3a5/0x1e50
[   75.660523]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   75.661351]  ? sel_make_dir+0x2c0/0x2c0
[   75.662000]  ? lock_release+0x6f0/0x6f0
[   75.662631]  ? selinux_file_permission+0xcc/0x590
[   75.663381]  ? sel_make_dir+0x2c0/0x2c0
[   75.664008]  vfs_write+0x29a/0xac0
[   75.664563]  ksys_write+0x12d/0x250
[   75.665117]  ? __ia32_sys_read+0xb0/0xb0
[   75.665766]  ? syscall_enter_from_user_mode+0x27/0x80
[   75.666594]  do_syscall_64+0x33/0x40
[   75.667185]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   75.667990] RIP: 0033:0x7f1a397f2d2d
[   75.668571] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[   75.671549] RSP: 002b:00007ffdb829ef08 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
[   75.672767] RAX: ffffffffffffffda RBX: 0000000000000002 RCX: 00007f1a397f2d2d
[   75.673873] RDX: 000000000000005c RSI: 0000000020000000 RDI: 0000000000000003
[   75.674986] RBP: 0000000000000004 R08: 0000000000000000 R09: 0000000001bbbbbb
[   75.676111] R10: 0000000000000064 R11: 0000000000000246 R12: 00007ffdb829ef60
[   75.677229] R13: 00007ffdb829ef40 R14: 0000000000000003 R15: 0000000000000001
[   75.678351] Modules linked in:
[   75.679675] ---[ end trace 22b515f862244605 ]---
[   75.680652] RIP: 0010:hashtab_map+0x9e/0x1b0
[   75.681558] Code: 89 44 24 08 e8 03 d7 5e ff 48 8b 44 24 08 80 38 00 0f 85 f5 00 00 00 49 8b 55 00 8b 44 24 04 4c 8d 34 c2 4c 89 f2 48 c1 ea 03 <80> 3c 1a 00 0f 85 e5 00 00 00 4d 8b 36 4d 85 f6 75 25 eb 7d e8 c9
[   75.685369] RSP: 0018:ffff88800ffa76b0 EFLAGS: 00010256
[   75.686470] RAX: 0000000000000000 RBX: dffffc0000000000 RCX: ffffffff81e7378e
[   75.687930] RDX: 0000000000000000 RSI: ffffffff81e737bd RDI: 0000000000000005
[   75.689336] RBP: ffffffff81e7d680 R08: 0000000000000dc0 R09: ffffffff852583b3
[   75.690637] R10: 0000000000000000 R11: 0000000000000001 R12: 0000000000000000
[   75.691938] R13: ffff888008f69898 R14: 0000000000000000 R15: 1ffff110011ed313
[   75.693170] FS:  00005555573f6380(0000) GS:ffff88806ce00000(0000) knlGS:0000000000000000
[   75.694657] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[   75.695662] CR2: 0000000020000040 CR3: 000000000aa52000 CR4: 0000000000350ef0

VM DIAGNOSIS:
23:23:36  Registers:
info registers vcpu 0

CPU#0
RAX=0000000000000034 RBX=0000000000000000 RCX=0000000000000000 RDX=00000000000003f8
RSI=ffffffff823c0a41 RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff88800ffa70b8
R8 =0000000000000000 R9 =ffffffff85d66c0f R10=000000000000001f R11=0000000000000001
R12=0000000000000034 R13=0000000000000000 R14=ffffffff87a492a0 R15=dffffc0000000000
RIP=ffffffff823c0a6c RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00005555573f6380 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=0000000020000040 CR3=000000000aa52000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 ffff000000ff0000 0000000000ff0000
YMM02=0000000000000000 0000000000000000 000000000000ff00 00000000000000ff
YMM03=0000000000000000 0000000000000000 000000000000ff00 00000000000000ff
YMM04=0000000000000000 0000000000000000 00007f1a3987a1c0 00007f1a3988cb80
YMM05=0000000000000000 0000000000000000 0000000000000001 0000000000000001
YMM06=0000000000000000 0000000000000000 00000000ff000000 00ff0000ff000000
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=0000000000000009 RBX=0000000093d6dc75 RCX=0000000000000800 RDX=00000000c01a7a91
RSI=ffffffff817b4cea RDI=00000000fc26336b RBP=ffff88800cb268f0 RSP=ffff88800b747418
R8 =00000000866bf929 R9 =ffffffff85d66c0f R10=0000000000000000 R11=0000000000000001
R12=ffff88800b747488 R13=000000000000000f R14=000000000000000f R15=000000000006dc75
RIP=ffffffff820ab671 RFL=00000006 [-----P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007f612b6f5900 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f612ab82a30 CR3=000000000bdc8000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM01=0000000000000000 0000000000000000 6434653961613931 3133393166663836
YMM02=0000000000000000 0000000000000000 6164346539616139 3131333931666638
YMM03=0000000000000000 0000000000000000 2f6c616e72756f6a 2f676f6c2f6e7572
YMM04=0000000000000000 0000000000000000 f0845583aa18d7b8 0000000000127560
YMM05=0000000000000000 0000000000000000 d3fdd5f48436fbd7 00000000000aeab8
YMM06=0000000000000000 0000000000000000 f6a07b962ada082f 00000000000ae970
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 44495f474f4c5359 530069253d595449
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
