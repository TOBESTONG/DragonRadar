Warning: Permanently added '[localhost]:31632' (ED25519) to the list of known hosts.
2024/11/06 23:07:17 ignoring optional flag "sandboxArg"="0"
2024/11/06 23:07:17 parsed 1 programs
syzkaller login: [  299.052017] cgroup: Unknown subsys name 'net'
[  299.054402] cgroup: Unknown subsys name 'net_prio'
[  299.055222] cgroup: Unknown subsys name 'devices'
[  299.056484] cgroup: Unknown subsys name 'blkio'
[  299.095477] cgroup: Unknown subsys name 'hugetlb'
[  299.096305] cgroup: Unknown subsys name 'rlimit'
[  299.203161] Adding 124996k swap on ./swap-file.  Priority:0 extents:1 across:124996k 
[  299.573077] audit: type=1400 audit(1730934438.620:6): avc:  denied  { execmem } for  pid=250 comm="syz-executor" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
[  300.172382] audit: type=1401 audit(1730934439.219:7): op=setxattr invalid_context="u:object_r:app_data_file:s0:c512,c768"
[  303.858358] syz-executor (330) used greatest stack depth: 24192 bytes left
2024/11/06 23:07:23 executed programs: 0
[  307.476468] audit: type=1400 audit(1730934446.524:8): avc:  denied  { open } for  pid=1270 comm="syz.0.15" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=perf_event permissive=1
[  307.488998] hrtimer: interrupt took 19911 ns
[  307.810921] EXT4-fs (loop0): mounted filesystem without journal. Opts: ,errors=continue
[  307.894750] EXT4-fs error (device loop0) in ext4_reserve_inode_write:5740: Out of memory
[  307.898065] EXT4-fs error (device loop0): ext4_dirty_inode:5942: inode #18: comm syz.0.15: mark_inode_dirty error
[  307.902503] EXT4-fs error (device loop0): ext4_map_blocks:584: inode #18: block 304: comm syz.0.15: lblock 192 mapped to illegal pblock 304 (length 32)
[  307.906736] ------------[ cut here ]------------
[  307.907833] WARNING: CPU: 1 PID: 1271 at fs/ext4/inode.c:3493 ext4_iomap_overwrite_begin+0x8b/0xa0
[  307.909794] Modules linked in:
[  307.910548] CPU: 1 PID: 1271 Comm: syz.0.15 Not tainted 5.10.0 #1
[  307.911790] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[  307.915048] RIP: 0010:ext4_iomap_overwrite_begin+0x8b/0xa0
[  307.916182] Code: bf 02 00 00 00 89 de e8 f3 77 a0 ff 66 83 fb 02 75 13 e8 48 80 a0 ff 44 89 e0 5b 5d 41 5c 41 5d 41 5e 41 5f c3 e8 35 80 a0 ff <0f> 0b eb e4 e8 5c b0 cd ff eb c7 66 2e 0f 1f 84 00 00 00 00 00 41
[  307.919380] RSP: 0018:ffff888017b57330 EFLAGS: 00010293
[  307.920655] RAX: 0000000000000000 RBX: 0000000000000000 RCX: ffffffff81a58e6d
[  307.922302] RDX: ffff88800a083400 RSI: ffffffff81a58e8b RDI: 0000000000000003
[  307.924478] RBP: 0000000000000011 R08: 0000000000000000 R09: ffff8880139c0747
[  307.967207] R10: 0000000000000002 R11: 0000000000000001 R12: 00000000ffffff8b
[  307.969069] R13: 0000000000060000 R14: 0000000000010000 R15: ffff888017b57420
[  307.970792] FS:  00007faefc5886c0(0000) GS:ffff88806ce00000(0000) knlGS:0000000000000000
[  307.972706] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  307.974374] CR2: 00000000200690ff CR3: 000000000c1c2000 CR4: 0000000000350ef0
[  307.976463] Call Trace:
[  307.977659]  iomap_apply+0x164/0xb10
[  307.978970]  ? iomap_dio_rw+0x90/0x90
[  307.981101]  ? trace_event_raw_event_iomap_apply+0x430/0x430
[  307.984374]  ? asm_sysvec_apic_timer_interrupt+0x12/0x20
[  307.986801]  ? lockdep_hardirqs_on+0x79/0x100
[  307.990495]  ? invalidate_inode_pages2_range+0x108/0xc50
[  307.992158]  ? invalidate_inode_pages2_range+0x9f9/0xc50
[  307.993874]  __iomap_dio_rw+0x6cd/0x1200
[  307.996565]  ? iomap_dio_rw+0x90/0x90
[  307.998661]  ? iomap_dio_bio_actor+0xfc0/0xfc0
[  308.000079]  ? asm_sysvec_apic_timer_interrupt+0x12/0x20
[  308.003473]  ? asm_sysvec_apic_timer_interrupt+0x12/0x20
[  308.005799]  iomap_dio_rw+0x31/0x90
[  308.007174]  ext4_file_write_iter+0xc55/0x1b20
[  308.009903]  ? ext4_file_read_iter+0x4c0/0x4c0
[  308.011303]  ? do_iter_readv_writev+0x237/0x760
[  308.012422]  ? do_iter_readv_writev+0x245/0x760
[  308.013750]  do_iter_readv_writev+0x476/0x760
[  308.015159]  ? new_sync_write+0x670/0x670
[  308.015902]  ? selinux_file_permission+0xcc/0x590
[  308.018719]  do_iter_write+0x18d/0x670
[  308.020550]  vfs_iter_write+0x70/0xa0
[  308.021250]  iter_file_splice_write+0x73a/0xc00
[  308.022259]  ? __ia32_sys_vmsplice+0xf0/0xf0
[  308.023200]  ? security_file_permission+0xa6/0x580
[  308.024279]  ? __ia32_sys_vmsplice+0xf0/0xf0
[  308.025041]  direct_splice_actor+0x10f/0x170
[  308.025819]  splice_direct_to_actor+0x387/0x980
[  308.026719]  ? pipe_to_sendpage+0x380/0x380
[  308.027540]  ? do_splice_to+0x160/0x160
[  308.028319]  ? do_splice_direct+0x1a6/0x290
[  308.029040]  ? pipe_to_sendpage+0x380/0x380
[  308.029821]  do_splice_direct+0x1c4/0x290
[  308.030579]  ? splice_direct_to_actor+0x980/0x980
[  308.031411]  ? asm_sysvec_apic_timer_interrupt+0x12/0x20
[  308.032549]  do_sendfile+0x54f/0x10e0
[  308.033380]  ? __x64_sys_pwritev+0x310/0x310
[  308.034099]  ? irqentry_enter+0x2b/0x60
[  308.034830]  ? asm_sysvec_apic_timer_interrupt+0x12/0x20
[  308.036034]  __x64_sys_sendfile64+0x1cd/0x210
[  308.036801]  ? __ia32_compat_sys_sendfile64+0x210/0x210
[  308.037891]  do_syscall_64+0x33/0x40
[  308.038562]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[  308.039411] RIP: 0033:0x7faefcb06ef9
[  308.040091] Code: ff ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 a8 ff ff ff f7 d8 64 89 01 48
[  308.042920] RSP: 002b:00007faefc588038 EFLAGS: 00000246 ORIG_RAX: 0000000000000028
[  308.044281] RAX: ffffffffffffffda RBX: 00007faefccbef80 RCX: 00007faefcb06ef9
[  308.045439] RDX: 0000000000000000 RSI: 0000000000000006 RDI: 0000000000000006
[  308.046570] RBP: 00007faefcb79b76 R08: 0000000000000000 R09: 0000000000000000
[  308.047719] R10: 0000000008801400 R11: 0000000000000246 R12: 0000000000000000
[  308.048860] R13: 0000000000000000 R14: 00007faefccbef80 R15: 00007ffd3eb7af78
[  308.050428] irq event stamp: 80579
[  308.051057] hardirqs last  enabled at (80609): [<ffffffff84000c42>] asm_sysvec_apic_timer_interrupt+0x12/0x20
[  308.052626] hardirqs last disabled at (80642): [<ffffffff83eb135c>] sysvec_apic_timer_interrupt+0xc/0xf0
[  308.054124] softirqs last  enabled at (80636): [<ffffffff84000f92>] asm_call_irq_on_stack+0x12/0x20
[  308.055585] softirqs last disabled at (80623): [<ffffffff84000f92>] asm_call_irq_on_stack+0x12/0x20
[  308.057029] ---[ end trace 67309f8adc0eb084 ]---
[  308.061652] EXT4-fs error (device loop0): ext4_map_blocks:584: inode #2: block 16: comm syz-executor: lblock 0 mapped to illegal pblock 16 (length 1)
[  308.064746] EXT4-fs error (device loop0) in ext4_reserve_inode_write:5740: Corrupt filesystem
[  308.067891] EXT4-fs error (device loop0): ext4_dirty_inode:5942: inode #2: comm syz-executor: mark_inode_dirty error
[  308.069787] syz.0.15 (1271) used greatest stack depth: 23320 bytes left
2024/11/06 23:07:30 executed programs: 5
[  311.817890] EXT4-fs (loop0): mounted filesystem without journal. Opts: ,errors=continue
[  311.897476] EXT4-fs error (device loop0): ext4_map_blocks:584: inode #18: block 416: comm syz.0.19: lblock 288 mapped to illegal pblock 416 (length 32)
[  311.942255] EXT4-fs error (device loop0): ext4_map_blocks:584: inode #2: block 16: comm syz-executor: lblock 0 mapped to illegal pblock 16 (length 1)
[  311.947653] EXT4-fs error (device loop0) in ext4_reserve_inode_write:5740: Corrupt filesystem
[  311.950607] EXT4-fs error (device loop0): ext4_dirty_inode:5942: inode #2: comm syz-executor: mark_inode_dirty error
[  315.718530] EXT4-fs (loop0): mounted filesystem without journal. Opts: ,errors=continue
[  315.814097] EXT4-fs error (device loop0): ext4_map_blocks:584: inode #2: block 16: comm syz-executor: lblock 0 mapped to illegal pblock 16 (length 1)
[  315.816325] EXT4-fs error (device loop0) in ext4_reserve_inode_write:5740: Corrupt filesystem
[  315.818665] EXT4-fs error (device loop0): ext4_dirty_inode:5942: inode #2: comm syz-executor: mark_inode_dirty error

VM DIAGNOSIS:
07:07:27  Registers:
info registers vcpu 0

CPU#0
RAX=0000000080010050 RBX=ffffffff85876520 RCX=ffffffff8200b154 RDX=00000000000003f6
RSI=ffffffff8200b162 RDI=0000000000000007 RBP=00000000000103f6 RSP=ffff88806ce09d48
R8 =0000000000000001 R9 =0000000000000003 R10=0000000000010000 R11=0000000000000001
R12=ffff88800bc18008 R13=ffff88800bc18180 R14=0000000000000001 R15=ffff88800bc1c238
RIP=ffffffff8200b166 RFL=00000046 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f7000f1f088 CR3=000000000bd16000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 2036323a37303a33 3220362020766f4e
YMM01=0000000000000000 0000000000000000 5d3439373930392e 37303320205b203a
YMM02=0000000000000000 0000000000000000 646f4d205d343937 3930392e37303320
YMM03=0000000000000000 0000000000000000 6b7a79732036323a 37303a3332203620
YMM04=0000000000000000 0000000000000000 5f65746972777265 766f5f70616d6f69
YMM05=0000000000000000 0000000000000000 6e692f347478652f 7366207461203137
YMM06=0000000000000000 0000000000000000 474e494e52415720 5d3333383730392e
YMM07=0000000000000000 0000000000000000 656c6c616b7a7973 2036323a37303a33
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=dffffc0000000060 RBX=0000000000000005 RCX=0000000000000000 RDX=00000000000003fd
RSI=ffffffff823c0aec RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff888017b56d08
R8 =0000000000000001 R9 =0000000000000003 R10=000000000000001f R11=0000000000000001
R12=0000000000000000 R13=fffffbfff0f492a7 R14=fffffbfff0f4925e R15=dffffc0000000000
RIP=ffffffff823c0b14 RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007faefc5886c0 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=000055d9a8bae990 CR3=000000000c1c2000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 0000000000000000 00000000000000ff
YMM02=0000000000000000 0000000000000000 0000000000000000 00000000000000ff
YMM03=0000000000000000 0000000000000000 203a555043205d38 34353031392e3730
YMM04=0000000000000000 0000000000000000 6b636f6c6270206c 6167656c6c69206f
YMM05=0000000000000000 0000000000000000 6c626c203a35312e 302e7a7973206d6d
YMM06=0000000000000000 0000000000000000 31232065646f6e69 203a3438353a736b
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 31203a555043203a 474e494e52415700
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
