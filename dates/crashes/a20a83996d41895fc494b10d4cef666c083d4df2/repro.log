Warning: Permanently added '[localhost]:41879' (ED25519) to the list of known hosts.
syzkaller login: [  124.402845] audit: type=1400 audit(1730929042.603:6): avc:  denied  { execmem } for  pid=236 comm="syz-executor302" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
executing program
[  124.439104] EXT4-fs (loop0): 1 truncate cleaned up
[  124.440928] EXT4-fs (loop0): mounting with "discard" option, but the device does not support discard
[  124.446324] EXT4-fs (loop0): mounted filesystem without journal. Opts: ,errors=continue
[  124.609230] EXT4-fs error (device loop0): ext4_readdir:243: inode #2: block 36: comm syz-executor302: path /syzkaller.c7OMu5/0/file0: bad entry in directory: rec_len is smaller than minimal - offset=0, inode=0, rec_len=0, name_len=0, size=1024
[  124.613050] ------------[ cut here ]------------
[  124.613930] kernel BUG at fs/ext4/inode.c:5121!
[  124.614659] invalid opcode: 0000 [#1] PREEMPT SMP KASAN NOPTI
[  124.615493] CPU: 1 PID: 236 Comm: syz-executor302 Not tainted 5.10.0 #1
[  124.616480] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[  124.619082] RIP: 0010:ext4_mark_iloc_dirty+0x276e/0x3710
[  124.620177] Code: fd ff ff e9 49 e8 ff ff e8 4f da 9f ff 44 8b 74 24 48 31 ff 44 89 f6 e8 00 d2 9f ff 45 85 f6 0f 84 04 f1 ff ff e8 32 da 9f ff <0f> 0b 48 c7 c7 60 de 2f 85 e8 33 57 3a 02 e8 1f da 9f ff 48 8d 85
[  124.622884] RSP: 0018:ffff8880107cfae0 EFLAGS: 00010293
[  124.623655] RAX: 0000000000000000 RBX: ffff888013ed65a8 RCX: ffffffff81a63480
[  124.624694] RDX: ffff88800fdd9a00 RSI: ffffffff81a6348e RDI: 0000000000000005
[  124.625742] RBP: ffff88801133b100 R08: 0000000000000000 R09: ffff888013ed6797
[  124.626767] R10: 0000000000000000 R11: 0000000000000001 R12: ffff88800af16000
[  124.627751] R13: 0000000000000000 R14: 00000000ffffffff R15: ffff8880107cfc10
[  124.628792] FS:  0000555556bd1380(0000) GS:ffff88806cf00000(0000) knlGS:0000000000000000
[  124.629946] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  124.630793] CR2: 0000555556be2758 CR3: 000000000f9de000 CR4: 0000000000350ee0
[  124.631819] Call Trace:
[  124.632182]  ? ext4_reserve_inode_write+0x114/0x230
[  124.632876]  __ext4_mark_inode_dirty+0x201/0x860
[  124.633554]  ? ext4_expand_extra_isize+0x5a0/0x5a0
[  124.634251]  ? ext4_journal_check_start+0x1ae/0x290
[  124.634965]  ? __ext4_journal_start_sb+0x1db/0x490
[  124.635680]  ext4_dirty_inode+0xf3/0x130
[  124.636247]  ? ext4_setattr+0x20c0/0x20c0
[  124.636848]  __mark_inode_dirty+0x893/0x11a0
[  124.637462]  ? __mnt_want_write+0x1bc/0x2a0
[  124.638085]  touch_atime+0x63f/0x740
[  124.638624]  ? atime_needs_update+0x5f0/0x5f0
[  124.639264]  ? security_file_permission+0x34c/0x580
[  124.639987]  iterate_dir+0x3e3/0x670
[  124.640527]  __x64_sys_getdents64+0x13a/0x2c0
[  124.641162]  ? __ia32_sys_getdents+0x2b0/0x2b0
[  124.641827]  ? __ia32_compat_sys_getdents+0x2c0/0x2c0
[  124.642568]  ? syscall_enter_from_user_mode+0x27/0x80
[  124.643310]  do_syscall_64+0x33/0x40
[  124.643856]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[  124.644607] RIP: 0033:0x7fc475371ef7
[  124.645136] Code: 35 7d 4d 04 00 48 8d 3d 3f 89 04 00 e8 e2 5e fc ff 66 90 f3 0f 1e fa b8 ff ff ff 7f 48 39 c2 48 0f 47 d0 b8 d9 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 01 c3 48 c7 c2 c0 ff ff ff f7 d8 64 89 02 48
[  124.647820] RSP: 002b:00007fff9619e618 EFLAGS: 00000293 ORIG_RAX: 00000000000000d9
[  124.648916] RAX: ffffffffffffffda RBX: 0000555556bda720 RCX: 00007fc475371ef7
[  124.649929] RDX: 0000000000008000 RSI: 0000555556bda750 RDI: 0000000000000004
[  124.650952] RBP: 00007fff9619e650 R08: 00007fc4753e5180 R09: 0000000000000000
[  124.651987] R10: 0000000000000001 R11: 0000000000000293 R12: 0000555556bda724
[  124.653019] R13: 0000555556bda750 R14: ffffffffffffffc0 R15: 0000000000000010
[  124.654131] Modules linked in:
[  124.655014] ---[ end trace 01d38b8f974b1d89 ]---
[  124.655960] RIP: 0010:ext4_mark_iloc_dirty+0x276e/0x3710
[  124.656891] Code: fd ff ff e9 49 e8 ff ff e8 4f da 9f ff 44 8b 74 24 48 31 ff 44 89 f6 e8 00 d2 9f ff 45 85 f6 0f 84 04 f1 ff ff e8 32 da 9f ff <0f> 0b 48 c7 c7 60 de 2f 85 e8 33 57 3a 02 e8 1f da 9f ff 48 8d 85
[  124.659668] RSP: 0018:ffff8880107cfae0 EFLAGS: 00010293
[  124.660444] RAX: 0000000000000000 RBX: ffff888013ed65a8 RCX: ffffffff81a63480
[  124.661561] RDX: ffff88800fdd9a00 RSI: ffffffff81a6348e RDI: 0000000000000005
[  124.662651] RBP: ffff88801133b100 R08: 0000000000000000 R09: ffff888013ed6797
[  124.663739] R10: 0000000000000000 R11: 0000000000000001 R12: ffff88800af16000
[  124.664824] R13: 0000000000000000 R14: 00000000ffffffff R15: ffff8880107cfc10
[  124.665904] FS:  0000555556bd1380(0000) GS:ffff88806cf00000(0000) knlGS:0000000000000000
[  124.667107] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  124.667992] CR2: 0000555556be2758 CR3: 000000000f9de000 CR4: 0000000000350ee0
[  124.669076] note: syz-executor302[236] exited with preempt_count 1

VM DIAGNOSIS:
05:37:22  Registers:
info registers vcpu 0

CPU#0
RAX=ffffffff8152fff0 RBX=ffff88800a9a5000 RCX=1ffffffff0e3d934 RDX=ffff88800cca3400
RSI=ffffc900006be038 RDI=ffff888008fcfe38 RBP=dffffc0000000000 RSP=ffff888008fcfd80
R8 =0000000000000000 R9 =0000000000000000 R10=000000007fff0000 R11=0000000000000001
R12=000000007fff0000 R13=000000007fff0000 R14=ffffc900006be000 R15=ffff888008fcfe38
RIP=ffffffff8152fff0 RFL=00000246 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007fa0cc87a8c0 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=0000559002a21b70 CR3=000000000ac0e000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 ffffffffffffffff ff00000000000000
YMM02=0000000000000000 0000000000000000 ffffffffffffffff ff00000000000000
YMM03=0000000000000000 0000000000000000 0000559002a0ca00 00005590029fc6d0
YMM04=0000000000000000 0000000000000000 0000000100000000 0000559002a0ca00
YMM05=0000000000000000 0000000000000000 00005590029fb6e0 00005590029fb6c0
YMM06=0000000000000000 0000000000000000 0000000000000000 0000000300000004
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 0000000000000000 00646d6574737973
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=0000000000000020 RBX=0000000000000000 RCX=0000000000000000 RDX=00000000000003f8
RSI=ffffffff823c0a41 RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff8880107cf478
R8 =0000000000000000 R9 =ffffffff85d66c0f R10=000000000000001f R11=0000000000000001
R12=0000000000000020 R13=0000000000000000 R14=ffffffff87a492a0 R15=dffffc0000000000
RIP=ffffffff823c0a6c RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000555556bd1380 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=0000555556be2758 CR3=000000000f9de000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 2525252525252525 2525252525252525
YMM01=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM02=0000000000000000 0000000000000000 0000000000000000 0000ff00000000ff
YMM03=0000000000000000 0000000000000000 0000000000000000 0000ff00000000ff
YMM04=0000000000000000 0000000000000000 00007fc4753d2ea0 00007fc4753e5b60
YMM05=0000000000000000 0000000000000000 0000000000000001 0000000000000001
YMM06=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM07=0000000000000000 0000000000000000 2f2f2f2f2f2f2f2f 2f2f2f2f2f2f2f2f
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
