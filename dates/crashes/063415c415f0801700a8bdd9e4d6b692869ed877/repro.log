Warning: Permanently added '[localhost]:32217' (ED25519) to the list of known hosts.
syzkaller login: [  181.631931] audit: type=1400 audit(1731257424.490:6): avc:  denied  { execmem } for  pid=237 comm="syz-executor921" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
executing program
[  181.662211] EXT4-fs (loop0): Ignoring removed mblk_io_submit option
[  181.670192] EXT4-fs (loop0): Warning: mounting with an experimental mount option 'dioread_nolock' for blocksize < PAGE_SIZE
[  181.684985] EXT4-fs error (device loop0): ext4_xattr_inode_iget:389: comm syz-executor921: inode #1: comm syz-executor921: iget: illegal inode #
[  181.688714] EXT4-fs error (device loop0): ext4_xattr_inode_iget:392: comm syz-executor921: error while reading EA inode 1 err=-117
[  181.691452] EXT4-fs warning (device loop0): ext4_expand_extra_isize_ea:2782: Unable to expand inode 15. Delete some EAs or run e2fsck.
[  181.694207] EXT4-fs error (device loop0): ext4_xattr_inode_iget:389: comm syz-executor921: inode #1: comm syz-executor921: iget: illegal inode #
[  181.698459] EXT4-fs error (device loop0): ext4_xattr_inode_iget:392: comm syz-executor921: error while reading EA inode 1 err=-117
[  181.711049] EXT4-fs (loop0): 1 orphan inode deleted
[  181.714386] EXT4-fs (loop0): mounted filesystem without journal. Opts: dioread_nolock,grpquota,debug_want_extra_isize=0x000000000000005c,noauto_da_alloc,mblk_io_submit,errors=continue,usrjquota=,,errors=continue
[  427.285258] INFO: task syz-executor921:238 blocked for more than 143 seconds.
[  427.287128]       Not tainted 5.10.0 #1
[  427.287873] "echo 0 > /proc/sys/kernel/hung_task_timeout_secs" disables this message.
[  427.289797] task:syz-executor921 state:D stack:25624 pid:  238 ppid:   237 flags:0x00004006
[  427.293022] Call Trace:
[  427.295117]  __schedule+0x880/0x2030
[  427.295828]  ? io_schedule_timeout+0x140/0x140
[  427.297282]  ? _raw_spin_unlock_irqrestore+0x42/0x50
[  427.298348]  ? lockdep_hardirqs_on+0x79/0x100
[  427.299268]  ? _raw_spin_unlock_irqrestore+0x2f/0x50
[  427.300278]  schedule+0xcf/0x270
[  427.301023]  io_schedule+0xb6/0x130
[  427.301680]  bit_wait_io+0x12/0xa0
[  427.302389]  __wait_on_bit_lock+0x131/0x1c0
[  427.303223]  ? bit_wait+0xa0/0xa0
[  427.303883]  out_of_line_wait_on_bit_lock+0xd5/0x110
[  427.304866]  ? __wait_on_bit_lock+0x1c0/0x1c0
[  427.305782]  ? var_wake_function+0x130/0x130
[  427.306663]  __sync_dirty_buffer+0x34f/0x3e0
[  427.307545]  __ext4_handle_dirty_metadata+0x28b/0x9b0
[  427.308572]  ext4_convert_inline_data_nolock+0x9b5/0xd60
[  427.309679]  ? ext4_destroy_inline_data_nolock+0x530/0x530
[  427.310770]  ? down_write_killable_nested+0x180/0x180
[  427.311791]  ? get_max_inline_xattr_value_size+0x3db/0x510
[  427.312970]  ext4_try_add_inline_entry+0x38f/0x650
[  427.313940]  ? ext4_da_write_inline_data_end+0x310/0x310
[  427.315063]  ext4_add_entry+0x34e/0xc60
[  427.315781]  ? ext4_mark_inode_used+0x14e0/0x14e0
[  427.316737]  ? make_indexed_dir+0xdb0/0xdb0
[  427.317605]  ? dquot_set_dqblk+0x1240/0x1240
[  427.318540]  ? do_raw_spin_unlock+0x4f/0x210
[  427.319462]  ext4_add_nondir+0x90/0x290
[  427.320292]  ? __sanitizer_cov_trace_switch+0x45/0x70
[  427.321341]  ext4_create+0x374/0x4d0
[  427.322141]  ? ext4_mknod+0x4e0/0x4e0
[  427.322918]  ? ext4_mknod+0x4e0/0x4e0
[  427.323630]  lookup_open+0xf52/0x1330
[  427.324378]  ? done_path_create+0x110/0x110
[  427.325279]  path_openat+0x93f/0x26f0
[  427.326118]  ? path_lookupat+0x6c0/0x6c0
[  427.326824]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[  427.327911]  do_filp_open+0x17e/0x3c0
[  427.328665]  ? may_open_dev+0xf0/0xf0
[  427.329445]  ? do_raw_spin_lock+0x121/0x260
[  427.330332]  ? rwlock_bug.part.0+0x90/0x90
[  427.331201]  ? _raw_spin_unlock+0x24/0x40
[  427.332042]  ? __alloc_fd+0x2af/0x620
[  427.332777]  do_sys_openat2+0x16d/0x420
[  427.333635]  ? build_open_flags+0x660/0x660
[  427.334543]  __x64_sys_openat+0x13f/0x1f0
[  427.335374]  ? __x64_sys_open+0x1c0/0x1c0
[  427.336228]  ? syscall_enter_from_user_mode+0x27/0x80
[  427.337254]  do_syscall_64+0x33/0x40
[  427.337993]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[  427.338905] RIP: 0033:0x7f8dbb9e024d
[  427.339643] RSP: 002b:00007ffd28f3d918 EFLAGS: 00000246 ORIG_RAX: 0000000000000101
[  427.341086] RAX: ffffffffffffffda RBX: 0030656c69662f2e RCX: 00007f8dbb9e024d
[  427.342463] RDX: 000000000000275a RSI: 0000000020000040 RDI: 00000000ffffff9c
[  427.343870] RBP: 0000000020000040 R08: 000055555643afc0 R09: 000055555643afc0
[  427.345254] R10: 0000000000000000 R11: 0000000000000246 R12: 00007ffd28f3dad8
[  427.346617] R13: 431bde82d7b634db R14: 00007ffd28f3d950 R15: 0000000000000001
[  427.348093] 
[  427.348093] Showing all locks held in the system:
[  427.349280] 1 lock held by khungtaskd/23:
[  427.350131]  #0: ffffffff850e7f00 (rcu_read_lock){....}-{1:2}, at: debug_show_all_locks+0x53/0x28c
[  427.351986] 1 lock held by in:imklog/154:
[  427.352737]  #0: ffff88800d1bc5f0 (&f->f_pos_lock){+.+.}-{3:3}, at: __fdget_pos+0xe9/0x100
[  427.354410] 3 locks held by syz-executor921/238:
[  427.355338]  #0: ffff88800a960438 (sb_writers#3){.+.+}-{0:0}, at: path_openat+0x24cc/0x26f0
[  427.357026]  #1: ffff888010ad0e60 (&type->i_mutex_dir_key#3){++++}-{3:3}, at: path_openat+0x925/0x26f0
[  427.358884]  #2: ffff888010ad0aa0 (&ei->xattr_sem){++++}-{3:3}, at: ext4_try_add_inline_entry+0x108/0x650
[  427.360877] 
[  427.361204] =============================================
[  427.361204] 

VM DIAGNOSIS:
00:54:30  Registers:
info registers vcpu 0

CPU#0
RAX=0000000000000020 RBX=0000000000000000 RCX=0000000000000000 RDX=00000000000003f8
RSI=ffffffff823c0a41 RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff888008c179e0
R8 =0000000000000001 R9 =0000000000000003 R10=000000000000001f R11=0000000000000001
R12=0000000000000020 R13=0000000000000000 R14=ffffffff87a492a0 R15=dffffc0000000000
RIP=ffffffff823c0a6c RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=0000562e225b7010 CR3=000000000cf42000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 7465677261742e79 636e656772656d65
YMM02=0000000000000000 0000000000000000 ffffff0f0e0d0c0b 0a09080706050403
YMM03=0000000000000000 0000000000000000 0000000000000021 0000656300656369
YMM04=0000000000000000 0000000000000000 2e2e2e2e2e2e2e2e 2e2e2e2e2e2e2e2e
YMM05=0000000000000000 0000000000000000 000000090000000b 00005599e36267e0
YMM06=0000000000000000 0000000000000000 0000000000000021 0000000000000000
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 0000000000000051 0000000000000060
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=dffffc0000000005 RBX=0000000000000001 RCX=0000000000000000 RDX=00000000000003f9
RSI=ffffffff823c0aec RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff888008c17948
R8 =0000000000000001 R9 =0000000000000003 R10=000000000000001f R11=0000000000000001
R12=0000000000000000 R13=0000000000000000 R14=0000000000000001 R15=ffffffff87a492f0
RIP=ffffffff823c0b14 RFL=00000006 [-----P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007febb006a9d8 CR3=000000000a9a6000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 ca48aa9bc59c1297 d742c3fd3c09c09e
YMM02=0000000000000000 0000000000000000 f3e88f777023e8a3 00000000000aea10
YMM03=0000000000000000 0000000000000000 80f09f19808d26a3 00000000000aec50
YMM04=0000000000000000 0000000000000000 5066475368e84c67 0000000000128b40
YMM05=0000000000000000 0000000000000000 d3fdd5f48436fbd7 00000000000aeab8
YMM06=0000000000000000 0000000000000000 faf38ea2bd1dd8e2 00000000000ae970
YMM07=0000000000000000 0000000000000000 a1fcdcf819d7e1e5 00000000000ae728
YMM08=0000000000000000 0000000000000000 44495f474f4c5359 530069253d595449
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 2020000000002020 2020202020200000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
