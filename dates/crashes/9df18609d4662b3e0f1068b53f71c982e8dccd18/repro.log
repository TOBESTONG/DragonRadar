Warning: Permanently added '[localhost]:51129' (ED25519) to the list of known hosts.
executing program
syzkaller login: [   29.359330] audit: type=1400 audit(1730890275.855:6): avc:  denied  { execmem } for  pid=238 comm="syz-executor155" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
[   29.423280] general protection fault, probably for non-canonical address 0xdffffc0000000000: 0000 [#1] PREEMPT SMP KASAN NOPTI
[   29.425545] KASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007]
[   29.427156] CPU: 0 PID: 239 Comm: syz-executor155 Not tainted 5.10.0 #1
[   29.428987] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   29.432344] RIP: 0010:scsi_queue_rq+0x1ec4/0x2bf0
[   29.433267] Code: 00 fc ff df 48 c1 ea 03 80 3c 02 00 0f 85 9e 0b 00 00 48 8b 8b 40 02 00 00 48 b8 00 00 00 00 00 fc ff df 48 89 ca 48 c1 ea 03 <0f> b6 04 02 48 89 ca 83 e2 07 38 d0 7f 08 84 c0 0f 85 60 0c 00 00
[   29.436792] RSP: 0018:ffff88800ab575b0 EFLAGS: 00010256
[   29.437794] RAX: dffffc0000000000 RBX: ffff88800be5a000 RCX: 0000000000000000
[   29.439164] RDX: 0000000000000000 RSI: ffffffff82b05311 RDI: 0000000000000003
[   29.440513] RBP: 0000000000000000 R08: 0000000000000001 R09: ffff88800be5a248
[   29.441848] R10: 0000000000000000 R11: 0000000000000001 R12: ffff88800be5a240
[   29.443204] R13: ffff88800bc7c000 R14: 0000000000000000 R15: ffff88800be38000
[   29.444534] FS:  00007fcd0dad46c0(0000) GS:ffff88806ce00000(0000) knlGS:0000000000000000
[   29.446035] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[   29.447118] CR2: 00007fcd0dab2b30 CR3: 000000000c9d8000 CR4: 0000000000350ef0
[   29.448444] Call Trace:
[   29.448938]  blk_mq_dispatch_rq_list+0x36e/0x1ca0
[   29.449823]  ? target_unblock+0x41/0x60
[   29.450575]  ? __blk_mq_sched_dispatch_requests+0x233/0x490
[   29.451641]  ? blk_mq_dequeue_from_ctx+0x9c0/0x9c0
[   29.452562]  ? do_raw_spin_lock+0x121/0x260
[   29.453374]  ? rwlock_bug.part.0+0x90/0x90
[   29.454169]  __blk_mq_sched_dispatch_requests+0x260/0x490
[   29.455225]  ? blk_mq_sched_mark_restart_hctx+0x80/0x80
[   29.456259]  blk_mq_sched_dispatch_requests+0xfb/0x180
[   29.457261]  __blk_mq_run_hw_queue+0x12c/0x290
[   29.458120]  ? trace_block_plug+0x250/0x250
[   29.458928]  __blk_mq_delay_run_hw_queue+0x4e7/0x5a0
[   29.459913]  blk_mq_run_hw_queue+0x16c/0x2f0
[   29.460753]  ? blk_mq_delay_run_hw_queues+0x1a0/0x1a0
[   29.461721]  ? do_raw_spin_unlock+0x4f/0x210
[   29.462555]  ? _raw_spin_unlock+0x24/0x40
[   29.463311]  blk_mq_sched_insert_request+0x380/0x440
[   29.464233]  ? __blk_mq_sched_bio_merge+0x490/0x490
[   29.465159]  ? blk_execute_rq_nowait+0x130/0x130
[   29.466046]  ? blk_account_io_start+0x15b/0x1e0
[   29.466937]  ? __raw_spin_lock_init+0x34/0x100
[   29.467810]  blk_execute_rq+0xd4/0x1b0
[   29.468515]  ? blk_end_sync_rq+0x50/0x50
[   29.469213]  ? security_capable+0x95/0xc0
[   29.469821]  sg_io+0x630/0xf90
[   29.470656]  ? blk_verify_command+0x50/0x50
[   29.471474]  ? scsi_verify_blk_ioctl+0x90/0x90
[   29.472169]  ? __lock_acquire+0xc2d/0x5ca0
[   29.472801]  scsi_cmd_ioctl+0x51a/0x580
[   29.473420]  ? sg_scsi_ioctl+0x7f0/0x7f0
[   29.474034]  ? blkdev_common_ioctl+0xfa/0x17a0
[   29.474758]  ? blk_ioctl_discard+0x2e0/0x2e0
[   29.475409]  scsi_cmd_blk_ioctl+0xe1/0x130
[   29.476038]  sd_ioctl_common+0x11d/0x170
[   29.476666]  ? sd_compat_ioctl+0xf0/0xf0
[   29.477292]  sd_ioctl+0x26/0xf0
[   29.477769]  blkdev_ioctl+0x2a8/0x720
[   29.478356]  ? blkdev_common_ioctl+0x17a0/0x17a0
[   29.479085]  ? __fget_files+0x2ee/0x460
[   29.479748]  block_ioctl+0xf9/0x140
[   29.480328]  ? blkdev_read_iter+0x180/0x180
[   29.480984]  __x64_sys_ioctl+0x196/0x210
[   29.481657]  do_syscall_64+0x33/0x40
[   29.482235]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   29.483032] RIP: 0033:0x7fcd0daf36ad
[   29.483656] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48
[   29.486563] RSP: 002b:00007fcd0dad4208 EFLAGS: 00000246 ORIG_RAX: 0000000000000010
[   29.487761] RAX: ffffffffffffffda RBX: 00007fcd0dba9a60 RCX: 00007fcd0daf36ad
[   29.488891] RDX: 0000000020002300 RSI: 0000000000002285 RDI: 0000000000000004
[   29.490023] RBP: 00007fcd0db7940c R08: 0000000000000000 R09: 0000000000000000
[   29.491111] R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000003
[   29.492231] R13: 00007fcd0db7942c R14: 2f30656c69662f2e R15: 00007fcd0dba9a68
[   29.493358] Modules linked in:
[   29.494015] ---[ end trace 0d68b2d100194a76 ]---
[   29.494787] RIP: 0010:scsi_queue_rq+0x1ec4/0x2bf0
[   29.495535] Code: 00 fc ff df 48 c1 ea 03 80 3c 02 00 0f 85 9e 0b 00 00 48 8b 8b 40 02 00 00 48 b8 00 00 00 00 00 fc ff df 48 89 ca 48 c1 ea 03 <0f> b6 04 02 48 89 ca 83 e2 07 38 d0 7f 08 84 c0 0f 85 60 0c 00 00
[   29.498441] RSP: 0018:ffff88800ab575b0 EFLAGS: 00010256
[   29.499310] RAX: dffffc0000000000 RBX: ffff88800be5a000 RCX: 0000000000000000
[   29.500433] RDX: 0000000000000000 RSI: ffffffff82b05311 RDI: 0000000000000003
[   29.501557] RBP: 0000000000000000 R08: 0000000000000001 R09: ffff88800be5a248
[   29.502674] R10: 0000000000000000 R11: 0000000000000001 R12: ffff88800be5a240
[   29.503806] R13: ffff88800bc7c000 R14: 0000000000000000 R15: ffff88800be38000
[   29.504948] FS:  00007fcd0dad46c0(0000) GS:ffff88806ce00000(0000) knlGS:0000000000000000
[   29.506278] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[   29.507234] CR2: 00007fcd0dab2b30 CR3: 000000000c9d8000 CR4: 0000000000350ef0
[   29.508376] note: syz-executor155[239] exited with preempt_count 1
[   29.509390] BUG: sleeping function called from invalid context at include/linux/percpu-rwsem.h:49
[   29.510864] in_atomic(): 0, irqs_disabled(): 0, non_block: 0, pid: 239, name: syz-executor155
[   29.512234] INFO: lockdep is turned off.
[   29.512878] Preemption disabled at:
[   29.512897] [<ffffffff81f74ff6>] __blk_mq_delay_run_hw_queue+0x346/0x5a0
[   29.514559] CPU: 0 PID: 239 Comm: syz-executor155 Tainted: G      D           5.10.0 #1
[   29.515783] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   29.517350] Call Trace:
[   29.517754]  dump_stack+0x107/0x163
[   29.518361]  ? __blk_mq_delay_run_hw_queue+0x346/0x5a0
[   29.519280]  ___might_sleep.cold+0x65/0x79
[   29.519952]  exit_signals+0x74/0x9e0
[   29.520552]  ? do_signal_stop+0x840/0x840
[   29.521203]  ? blocking_notifier_call_chain+0x13a/0x180
[   29.522004]  do_exit+0x237/0x28e0
[   29.522580]  ? blkdev_ioctl+0x2a8/0x720
[   29.523194]  ? blkdev_common_ioctl+0x17a0/0x17a0
[   29.523920]  ? __fget_files+0x2ee/0x460
[   29.524560]  ? mm_update_next_owner+0x7e0/0x7e0
[   29.525284]  ? block_ioctl+0xf9/0x140
[   29.525864]  ? blkdev_read_iter+0x180/0x180
[   29.526533]  ? __x64_sys_ioctl+0x196/0x210
[   29.527227]  rewind_stack_do_exit+0x17/0x17
[   29.527902] RIP: 0033:0x7fcd0daf36ad
[   29.528473] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48
[   29.531407] RSP: 002b:00007fcd0dad4208 EFLAGS: 00000246 ORIG_RAX: 0000000000000010
[   29.532568] RAX: ffffffffffffffda RBX: 00007fcd0dba9a60 RCX: 00007fcd0daf36ad
[   29.533648] RDX: 0000000020002300 RSI: 0000000000002285 RDI: 0000000000000004
[   29.534769] RBP: 00007fcd0db7940c R08: 0000000000000000 R09: 0000000000000000
[   29.535890] R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000003
[   29.536993] R13: 00007fcd0db7942c R14: 2f30656c69662f2e R15: 00007fcd0dba9a68

VM DIAGNOSIS:
18:51:16  Registers:
info registers vcpu 0

CPU#0
RAX=0000000000000020 RBX=0000000000000000 RCX=0000000000000000 RDX=00000000000003f8
RSI=ffffffff823c0a41 RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff88800ab56fb8
R8 =0000000000000000 R9 =ffffffff85d66c0f R10=000000000000001f R11=0000000000000001
R12=0000000000000020 R13=0000000000000000 R14=ffffffff87a492a0 R15=dffffc0000000000
RIP=ffffffff823c0a6c RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007fcd0dad46c0 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007fcd0dab2b30 CR3=000000000c9d8000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM02=0000000000000000 0000000000000000 0000000000000000 00000000000000ff
YMM03=0000000000000000 0000000000000000 0000000000000000 00000000000000ff
YMM04=0000000000000000 0000000000000000 0000000000000340 00007fcd0db75a30
YMM05=0000000000000000 0000000000000000 0000034000000340 0000000000000000
YMM06=0000000000000000 0000000000000000 0000555556e5a3d0 00007fcd0dba35e0
YMM07=0000000000000000 0000000000000000 0000000068308f53 00007fcd0db75a30
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=ffffffff83eca430 RBX=ffff888008250000 RCX=ffffffff83eb246c RDX=0000000000000000
RSI=0000000000000001 RDI=0000000000000000 RBP=0000000000000001 RSP=ffff88800825fe78
R8 =0000000000000001 R9 =ffff88806cf3416b R10=ffffed100d9e682d R11=0000000000000001
R12=ffffed100104a000 R13=ffffffff85d66c08 R14=0000000000000000 R15=dffffc0000000000
RIP=ffffffff83eca43e RFL=00000202 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=1
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007fcd0dab3d58 CR3=000000000c9d8000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM02=0000000000000000 0000000000000000 008003f701a0c23d 0000000000000013
YMM03=0000000000000000 0000000000000000 0000000068308f53 00007fff510e1e90
YMM04=0000000000000000 0000000000000000 0000000000000340 00007fcd0db75a30
YMM05=0000000000000000 0000000000000000 0000034000000340 0000000000000000
YMM06=0000000000000000 0000000000000000 0000555556e5a3d0 00007fcd0dba35e0
YMM07=0000000000000000 0000000000000000 0000000068308f53 00007fcd0db75a30
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
