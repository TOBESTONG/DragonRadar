last executing test programs:

1.076470913s ago: executing program 0 (id=1):
perf_event_open$cgroup(0x0, 0xffffffffffffffff, 0x0, 0xffffffffffffffff, 0x0)
pipe2(&(0x7f0000000000)={<r0=>0xffffffffffffffff, <r1=>0xffffffffffffffff}, 0x80)
r2 = ioctl$LOOP_CTL_GET_FREE(r0, 0x4c82)
r3 = openat$ptmx(0xffffffffffffff9c, &(0x7f0000000040), 0x41, 0x0)
write$binfmt_aout(r3, &(0x7f00000021c0)=ANY=[], 0xff2e)
ioctl$TCSETS(r3, 0x40045431, &(0x7f0000000000)={0x0, 0x0, 0x0, 0x0, 0x0, "df3f0400000000000000000000000609000040"})
r4 = syz_open_pts(r3, 0x2a800)
r5 = dup3(r4, r3, 0x0)
ioctl$TCSETAW(r5, 0x5407, &(0x7f0000000100)={0x4, 0x0, 0x101, 0xee0e, 0x12, "8cafce1f9f87e622"})
ioctl$TIOCSTI(r5, 0x5412, &(0x7f0000000080)=0x17)
r6 = openat$loop_ctrl(0xffffffffffffff9c, &(0x7f0000000500), 0x0, 0x0)
ioctl$LOOP_CTL_REMOVE(r6, 0x4c81, 0x0)
r7 = ioctl$LOOP_CTL_ADD(r6, 0x4c80, r2)
ioctl$LOOP_CTL_REMOVE(r0, 0x4c81, r7)
r8 = syz_genetlink_get_family_id$batadv(&(0x7f0000000100), r0)
sendmsg$BATADV_CMD_SET_HARDIF(r1, &(0x7f0000000200)={&(0x7f00000000c0)={0x10, 0x0, 0x0, 0x1}, 0xc, &(0x7f00000001c0)={&(0x7f0000000180)={0x24, r8, 0x10, 0x70bd2a, 0x25dfdbfd, {}, [@BATADV_ATTR_MULTICAST_FORCEFLOOD_ENABLED={0x5}, @BATADV_ATTR_MESH_IFINDEX={0x8}]}, 0x24}, 0x1, 0x0, 0x0, 0x40000}, 0x20004000)
pipe2(&(0x7f0000000000)={<r9=>0xffffffffffffffff, <r10=>0xffffffffffffffff}, 0x80)
sendmsg$NL802154_CMD_NEW_SEC_KEY(0xffffffffffffffff, &(0x7f0000000340)={&(0x7f0000000080)={0x10, 0x0, 0x0, 0x10000000}, 0xc, &(0x7f0000000300)={&(0x7f0000000540)={0x2d4, 0x0, 0x4, 0x70bd25, 0x25dfdbff, {}, [@NL802154_ATTR_SEC_KEY={0x6c, 0x30, 0x0, 0x1, [@NL802154_KEY_ATTR_USAGE_CMDS={0x24, 0x3, "e787316840af60c764d56ac1b0dbacde98079b8bf7ebe099a0a93e0457e23505"}, @NL802154_KEY_ATTR_BYTES={0x14, 0x4, "6db79bbb4e17580f55ebace831cdc51a"}, @NL802154_KEY_ATTR_ID={0x1c, 0x1, 0x0, 0x1, [@NL802154_KEY_ID_ATTR_INDEX={0x5, 0x2, 0x2}, @NL802154_KEY_ID_ATTR_INDEX={0x5, 0x2, 0x2}, @NL802154_KEY_ID_ATTR_INDEX={0x5, 0x2, 0x1}]}, @NL802154_KEY_ATTR_BYTES={0x14, 0x4, "f58460ba083ff79e082db7d7509058eb"}]}, @NL802154_ATTR_WPAN_DEV={0xc}, @NL802154_ATTR_IFINDEX={0x8}, @NL802154_ATTR_SEC_KEY={0x23c, 0x30, 0x0, 0x1, [@NL802154_KEY_ATTR_BYTES={0x14, 0x4, "c928dbf7ebb3dd9df40fcc4865761899"}, @NL802154_KEY_ATTR_USAGE_CMDS={0x24, 0x3, "140aa65db6429cddaa7e955ee823530800ad70dba07af522608b23bdc84c1b42"}, @NL802154_KEY_ATTR_USAGE_CMDS={0x24, 0x3, "747f3e5c28e3f35974f43a972547196c00dbd1a0fff7db20cdfb6fab2e9c4e42"}, @NL802154_KEY_ATTR_USAGE_CMDS={0x24, 0x3, "5d3fc0916adf3454c00df11b11af975d09e1f522d2c9ca9df81f94155b69d1c4"}, @NL802154_KEY_ATTR_USAGE_CMDS={0x24, 0x3, "8e173baf16ac3198d04db4dd91eef020436277dbf8c9936b5ea513a5c86fc330"}, @NL802154_KEY_ATTR_ID={0xcc, 0x1, 0x0, 0x1, [@NL802154_KEY_ID_ATTR_MODE={0x8, 0x1, 0x3}, @NL802154_KEY_ID_ATTR_SOURCE_EXTENDED={0xc, 0x5, 0xfffffffffffffffe}, @NL802154_KEY_ID_ATTR_MODE={0x8, 0x1, 0x3}, @NL802154_KEY_ID_ATTR_MODE={0x8, 0x1, 0x3}, @NL802154_KEY_ID_ATTR_IMPLICIT={0x24, 0x3, 0x0, 0x1, [@NL802154_DEV_ADDR_ATTR_PAN_ID={0x6, 0x1, 0xffff}, @NL802154_DEV_ADDR_ATTR_PAN_ID={0x6, 0x1, 0xffff}, @NL802154_DEV_ADDR_ATTR_SHORT={0x6, 0x3, 0xfffe}, @NL802154_DEV_ADDR_ATTR_SHORT={0x6}]}, @NL802154_KEY_ID_ATTR_SOURCE_SHORT={0x8, 0x4, 0x6}, @NL802154_KEY_ID_ATTR_IMPLICIT={0x24, 0x3, 0x0, 0x1, [@NL802154_DEV_ADDR_ATTR_PAN_ID={0x6}, @NL802154_DEV_ADDR_ATTR_SHORT={0x6, 0x3, 0xf97cfe3fbcfa8ee7}, @NL802154_DEV_ADDR_ATTR_SHORT={0x6}, @NL802154_DEV_ADDR_ATTR_SHORT={0x6}]}, @NL802154_KEY_ID_ATTR_IMPLICIT={0x48, 0x3, 0x0, 0x1, [@NL802154_DEV_ADDR_ATTR_MODE={0x8, 0x2, 0x3}, @NL802154_DEV_ADDR_ATTR_PAN_ID={0x6, 0x1, 0x2}, @NL802154_DEV_ADDR_ATTR_SHORT={0x6, 0x3, 0xfffe}, @NL802154_DEV_ADDR_ATTR_SHORT={0x6, 0x3, 0xaaa2}, @NL802154_DEV_ADDR_ATTR_SHORT={0x6}, @NL802154_DEV_ADDR_ATTR_PAN_ID={0x6, 0x1, 0x1}, @NL802154_DEV_ADDR_ATTR_EXTENDED={0xc, 0x4, {0xaaaaaaaaaaaa0102}}, @NL802154_DEV_ADDR_ATTR_MODE={0x8, 0x2, 0x1}]}, @NL802154_KEY_ID_ATTR_SOURCE_EXTENDED={0xc, 0x5, 0x6}]}, @NL802154_KEY_ATTR_ID={0xb4, 0x1, 0x0, 0x1, [@NL802154_KEY_ID_ATTR_SOURCE_SHORT={0x8, 0x4, 0x46d}, @NL802154_KEY_ID_ATTR_IMPLICIT={0x10, 0x3, 0x0, 0x1, [@NL802154_DEV_ADDR_ATTR_EXTENDED={0xc}]}, @NL802154_KEY_ID_ATTR_MODE={0x8, 0x1, 0x2}, @NL802154_KEY_ID_ATTR_IMPLICIT={0x30, 0x3, 0x0, 0x1, [@NL802154_DEV_ADDR_ATTR_SHORT={0x6, 0x3, 0xaaa0}, @NL802154_DEV_ADDR_ATTR_EXTENDED={0xc}, @NL802154_DEV_ADDR_ATTR_PAN_ID={0x6, 0x1, 0x1}, @NL802154_DEV_ADDR_ATTR_PAN_ID={0x6, 0x1, 0x2}, @NL802154_DEV_ADDR_ATTR_PAN_ID={0x6}]}, @NL802154_KEY_ID_ATTR_IMPLICIT={0x58, 0x3, 0x0, 0x1, [@NL802154_DEV_ADDR_ATTR_SHORT={0x6, 0x3, 0xffff}, @NL802154_DEV_ADDR_ATTR_PAN_ID={0x6}, @NL802154_DEV_ADDR_ATTR_PAN_ID={0x6}, @NL802154_DEV_ADDR_ATTR_EXTENDED={0xc, 0x4, {0xaaaaaaaaaaaa0002}}, @NL802154_DEV_ADDR_ATTR_PAN_ID={0x6, 0x1, 0x2}, @NL802154_DEV_ADDR_ATTR_SHORT={0x6, 0x3, 0xffff}, @NL802154_DEV_ADDR_ATTR_EXTENDED={0xc, 0x4, {0xaaaaaaaaaaaa0002}}, @NL802154_DEV_ADDR_ATTR_EXTENDED={0xc, 0x4, {0xaaaaaaaaaaaa0302}}, @NL802154_DEV_ADDR_ATTR_PAN_ID={0x6, 0x1, 0x3}]}, @NL802154_KEY_ID_ATTR_INDEX={0x5, 0x2, 0x1}]}, @NL802154_KEY_ATTR_BYTES={0x14, 0x4, "7a083a02b650e673664a417523b0cedb"}]}, @NL802154_ATTR_SEC_KEY={0x4}]}, 0x2d4}}, 0x4034)
ioctl$LOOP_CTL_GET_FREE(r9, 0x4c82)
r11 = openat$loop_ctrl(0xffffffffffffff9c, &(0x7f0000000500), 0x0, 0x0)
ioctl$LOOP_CTL_REMOVE(r11, 0x4c81, 0x0)
ioctl$LOOP_CTL_REMOVE(r9, 0x4c81, 0x0)
syz_genetlink_get_family_id$batadv(&(0x7f0000000100), r9)
ioctl$MON_IOCX_GETX(r10, 0x4018920a, 0x0)
ioctl$ifreq_SIOCGIFINDEX_batadv_hard(0xffffffffffffffff, 0x8933, &(0x7f0000000040)={'batadv_slave_0\x00', <r12=>0x0})
sendmsg$BATADV_CMD_GET_HARDIF(0xffffffffffffffff, &(0x7f00000001c0)={&(0x7f0000000000)={0x10, 0x0, 0x0, 0x1000}, 0xc, &(0x7f0000000180)={&(0x7f0000000240)=ANY=[@ANYBLOB="48000010", @ANYRES16=r8, @ANYBLOB, @ANYBLOB="0800db834b34da5b1aaad951c1d48600089833f7a007d3ab1778e7cce40bfc8c7ccfeb99d9cf3dce902a9435d2c51014c106a4bef9be3e40fdc310857d36727a0c44f5c0c65a506eaa75049507325fcbbcf83cce85a7d3a8d6f41f5ae35a6d2a9c041b579afb", @ANYRES32=r12, @ANYBLOB="08003400ac00000008002b00ff0f000005002e00010000000a000900aaaaaaaaaa1d0000"], 0x48}, 0x1, 0x0, 0x0, 0x40}, 0x40)
setsockopt$SO_ATTACH_FILTER(r1, 0x1, 0x1a, &(0x7f0000000380)={0x1, &(0x7f0000000140)=[{0xa, 0x7, 0x9, 0x8000}]}, 0x10)

852.006406ms ago: executing program 2 (id=3):
syz_mount_image$ext4(&(0x7f0000000200)='ext4\x00', &(0x7f0000000480)='./file0\x00', 0x0, &(0x7f00000000c0)={[{@grpquota}, {@noinit_itable}, {@nouid32}, {@grpjquota}, {@jqfmt_vfsv0}, {@usrjquota, 0x30}]}, 0x84, 0x484, &(0x7f0000000940)="$eJzs3E1vG0UfAPD/rpMmfckTt0+BvgGGgihvSZMW6IFLEUi9ICHBoRxDmlalaYOaINGqogGhckT9BMARiU/AqVwQ9AKIK9wRUoVyoXBARmuvHTdxUpvEcYN/P8nNzO5s5j+7O/Z4ZtMAelYp+yeJ2BERP0fEcESkSwuUqj9uL1yZ/HPhymQS5fLrvyfZYfHHwpXJWtEk/7m9nilG+lES+5vUO3vp8rmJ6empi3l+dO78O6Ozly4/e/b8xJmpM1MXxo8dO3pk7IXnx59bl3YOZbHue3/mwN4Tb15/dfLk9be++zILcUe+v7EdVcU111mKUv2cLPV4PLzm338vublzMZ30NS1yI924cGhRISKyy9Vf6f/DUYjFizccr3zY1eCATksHlm0q1BLzZeA/LBvNA72o9kGfff+tvTZw7NF1t45HfR7jdv6q7umrzIOUitXvRkMdqr8UESfn//o0e0XTeYiI2NqhygGAnnTjeEQ802z8l8b9DeX+l68NFSNiZ0Tsioj/R8TuiLgvolL2gYjY02b9pSX55eOfHzs6+snGfy/ma1t3jv/qqxXFQp4bqrS/Pzl9dnrqcH5ODkX/QJYfW6WOr1/+6ZOV9jWO/7JXVn9tLJjH8Vvfkgm6UxNzE2tpc6NbH0TEYLP2J/WVgGx8vDci9v2L35+ds7NPfXFgpf13b/8qmq8ztaX8ecQT1es/HwuNa3LJHalV1idHB2N66vBo7a5Y7uYP115rXvvA2tq/DrLrv63p/V9vfzFpXK+dbb+Oa798vOJ3ykr7n8wzbdz/W5I3Kukt+bb3JubmLo5FbEnml28fXzy2mu+vl8/af+hg8/6/K+Lvz/Lj9kdEdhM/GBEPRVRWb7PYH4mIRyPi4Crt//alx95etrFhMbTb1/9UW9e//UTh3DdfrVR/a+9/RyupQ/mWVt7/Wg1wLecOAAAANou08gx8ko7U02k6MlJ9hn93bEunZ2bnnj498+6FU9Vn5YvRn9ZmuoYb5kPH8rnhWn58Sf5IZd64XC6Xt1byI5Mz051aUwdas32F/p/5tdDt6ICOa2kdrbYIs9JftAGb0t37/+CGxAFsvHV4jgbYpPR/6F36P/SuZv3/asTtLoQCbKA+n//Q0/R/6F3t9//G/zoI2Mx8/kNPWsvf9a+W+P5Ea4VrcXQojE2QKNwbYbSdiLSdo/YMRXQ/5noibbZrsEv34UBEtFr46oZF2N33JQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgPXyTwAAAP//j+7chw==")
r0 = syz_open_procfs(0x0, &(0x7f0000000180)='mountinfo\x00')
r1 = openat$procfs(0xffffffffffffff9c, &(0x7f0000001080)='/proc/mdstat\x00', 0x0, 0x0)
mount$9p_fd(0x0, &(0x7f0000000140)='./file0\x00', &(0x7f0000000240), 0x0, &(0x7f00000005c0)={'trans=fd,', {'rfdno', 0x3d, r1}, 0x2c, {'wfdno', 0x3d, r0}, 0x2c, {[{@debug={'debug', 0x3d, 0x1ff}}, {@version_9p2000}]}})
ioctl$AUTOFS_DEV_IOCTL_PROTOVER(r0, 0xc0189372, &(0x7f0000000000)={{0x1, 0x1, 0x18, <r2=>r1, {0x7}}, './file0\x00'})
ioctl$BTRFS_IOC_LOGICAL_INO_V2(r2, 0xc038943b, &(0x7f0000000080)={0xe, 0x20, '\x00', 0x0, &(0x7f0000000040)=[0x0, 0x0, 0x0, 0x0]})
r3 = socket(0x10, 0x803, 0x0)
write(r3, &(0x7f0000000300)="fc0000004a000700ab092500090007000aab80ff020000000000369321000100fc0000000000000000ff000000000000008656aaa79bb94b46fe00000007ec020800008c0100036c6c256f1a272f2e117c22ebc205214000000080008934d07326ade01720e6cd5ed6e4e9bfcd772c74fb32c56ce1f0f156272f5b00000005defd5a32e3082038f4f8b29d3e2a73325c6d167c7594978f7bc711fdf3d92c8334b2ccd243f295ed94e0ad91bd073457d43d3f0000000000000000000000000073bfe35951f2d728a1e09c8dcd13323236b0fbe7c61b1bf53cdec0961355f00ca63ff6c90da1dc9f8f594d033472cb97e3b5f3395aa0a4a82775cf8def", 0xfc)
fcntl$setsig(r3, 0xa, 0x9)

729.931125ms ago: executing program 1 (id=2):
r0 = socket$inet6_tcp(0xa, 0x1, 0x0)
setsockopt$inet6_IPV6_DSTOPTS(r0, 0x29, 0x3b, &(0x7f0000000280)=ANY=[@ANYBLOB="000d000000000044f893099cdd5100050200702bb4b902000000000000000000000000000007100000000002000000000000000000000005020000c9102001000000000000000000000000000001030000000023b52380ac7cdc69d7789833f5a28094de47b380b921e7a578795cc2dd36cf3a5d1eb62c503d684201dbd9ee773dc3cfe77cd9eb5fdda8043a0b2b71288404b5d28c5e23f9ac219e8f"], 0x70)
r1 = openat$hwrng(0xffffffffffffff9c, &(0x7f0000000000), 0x10200, 0x0)
getsockopt$IP6T_SO_GET_INFO(r1, 0x29, 0x40, 0x0, 0x0)
perf_event_open(&(0x7f0000000200)={0x2, 0x80, 0x6f, 0x0, 0x0, 0x0, 0x0, 0x5, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2, @perf_bp={0x0}, 0x400, 0x0, 0x6, 0x8}, 0x0, 0x0, 0xffffffffffffffff, 0x0)
socket$nl_xfrm(0x10, 0x3, 0x6)
syz_mount_image$ext4(&(0x7f0000000780)='ext4\x00', &(0x7f0000000240)='./file0\x00', 0x0, &(0x7f0000000000), 0x1, 0x77f, &(0x7f0000000f40)="$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")
r2 = openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000000080)='memory.current\x00', 0x275a, 0x0)
write$binfmt_script(r2, &(0x7f0000003a80), 0x208e24b)
r3 = syz_io_uring_setup(0x4333, 0x0, &(0x7f0000ff5000), &(0x7f0000ff4000))
io_uring_register$IORING_UNREGISTER_BUFFERS(r3, 0x1, 0x0, 0x0)
perf_event_open(&(0x7f000001d000)={0x1, 0x80, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_bp={0x0}, 0x0, 0x0, 0x0, 0x0, 0x0, 0x5}, 0x0, 0xffffffefffffffff, 0xffffffffffffffff, 0x0)
syz_mount_image$ext4(&(0x7f0000000040)='ext4\x00', &(0x7f0000000000)='./bus\x00', 0xe, &(0x7f0000000140)={[{@noload}, {@resuid={'resuid', 0x3d, 0xee01}}, {@debug_want_extra_isize={'debug_want_extra_isize', 0x3d, 0x2e}}, {@lazytime}, {@i_version}, {@quota}]}, 0x3, 0x431, &(0x7f0000000500)="$eJzs289PHFUcAPDvzAKV/hCs9UdpVbQaiT+g0Ko9eNFo4kETEz3UIwJtsNtiCia2IYrG1KNp4t14NPEv8KQXo55MvOrdNGkMl1ZPa2Z3BpZllwJdWO1+Psm07828zXvfffN235vHBtC1hrN/koj9EfF7RAzUsmsLDNf+u7m8OPX38uJUEpXKW38l1XI3lheniqLF6/blmZE0Iv0siSNN6p2/dPncZLk8czHPjy2cf39s/tLlZ2fPT56dOTtzYeLUqZMnxl94fuK5tsSZxXVj6KO5o4dfe+fqG1Onr77787dJEX9DHG0yvNHFJyqVNlfXWQfq0klPBxvClpQiIuuu3ur4H4hSrHbeQLz6aUcbB+yoSq7F5aUKcAdLotMtADqj+KLP1r/FsXuzj867/lJtAZTFfTM/ald6Is3L9Dasb9tpOCJOL/3zVXbEzjyHAABY4/ts/vNMs/lfGvfXlbs730MZjIh7IuJgRNwbEYci4r6IatkHIuLBLdbfuEmyfv6TXttWYJuUzf9ezPe21s7/itlfDJby3IFq/L3JmdnyzPH8PRmJ3j1ZfnyDOn545bcvWl2rn/9lR1Z/MRfM23GtZ8/a10xPLkzeTsz1rn8SMdTTLP5kZScgiYjDETG0zTpmn/rmaKtrt45/A23YZ6p8HfFkrf+XoiH+QrLx/uTYXVGeOT5W3BXr/fLrlTdb1X9b8bdB1v97m97/K/EPJvX7tfNbr+PKH5+3XNNs9/7vS96upvvycx9OLixcHI/oS16vNbr+/MTqa4t8UT6Lf+RY8/F/MFbfiSMRkd3ED0XEwxHxSN72RyPisYg4tkH8P738+Hvbj39nZfFPb6n/VxN90XimeaJ07sfv1lQ6uJX4s/4/WU2N5Gc28/m3mXZt724GAACA/580IvZHko6upNN0dLT2N/yHYm9anptfePrM3AcXpmu/ERiM3rR40jVQ9zx0PF/WF/mJhvyJ/Lnxl6X+an50aq483engocvtazH+M3+WOt06YMf5vRZ0L+MfupfxD93L+Ifu1WT893eiHcDua/b9/3EH2gHsvobxb9sPuoj1P3Qv4x+6l/EPXWm+P279I3kJiXWJSP8TzZDYoUSnP5kAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADa498AAAD//wgz6sQ=")
fcntl$setstatus(0xffffffffffffffff, 0x4, 0x42c00)
setxattr$incfs_size(&(0x7f0000000080)='./file1\x00', &(0x7f00000000c0), 0x0, 0x0, 0x0)
syz_genetlink_get_family_id$netlbl_unlabel(&(0x7f0000000040), 0xffffffffffffffff)
sendmsg$NLBL_UNLABEL_C_STATICREMOVE(0xffffffffffffffff, &(0x7f0000000180)={0x0, 0x0, 0x0}, 0x0)
setsockopt$inet6_tcp_int(r0, 0x6, 0x2000000000000022, &(0x7f0000000200)=0x1, 0x4)
socket(0x27, 0x8000f, 0x4)
r4 = semget$private(0x0, 0x3, 0x2a4)
semctl$SEM_STAT(r4, 0x3, 0x12, &(0x7f0000000000)=""/89)
sendto$inet6(r0, &(0x7f0000000240)="c4", 0x1, 0x20000845, &(0x7f0000b63fe4), 0x1c)

585.898049ms ago: executing program 3 (id=4):
syz_mount_image$ext4(&(0x7f0000000200)='ext3\x00', &(0x7f0000000480)='./file0\x00', 0x2010000, &(0x7f0000000000)={[{@noblock_validity}, {@errors_continue}, {@errors_remount}, {@usrjquota_path={'usrjquota', 0x3d, './file0'}}, {@jqfmt_vfsv0}, {@usrjquota, 0x2e}], [], 0x2e}, 0x84, 0x466, &(0x7f0000002b80)="$eJzs3MuPU9UfAPDvvZ3hzW8KP3zwUKtoJD5mmAGVhRuMJmxMTHSBy3EYCFIYwoyJECKjMbg0/AXq0sS/wBVujLLSuNW9MSGGjejC1Nz23qHMtGPbeRTs55NcOOfe057z7b2nPfecdgIYWJXsnyRiW0T8HBEjjezdBSqN/27fujz1563LU0nUam/+ntTL/XHr8lRRtHjc1jxzPolIP05ib4t6Zy9eOjNZrU5fyPNjc2fPj81evPT86bOTp6ZPTZ+bOHLk8KHxl16ceGFV4tyetXXPBzP7dh97+9rrU8evvfP9V1l7t+XHm+NoKK+4zkpU7n4tmzy14me/t9zYcSedDLUscn39WkOnShGRna7hev8fiVLcOXkj8dpHfW0csNbSjUt2lYrEfA34D8tG88AgKj7os/vfYlvHsUff3TwaC/MYt/OtcWQo0uwevty4N9q+RvVXIuL4/F+fZVu0nIcAAFhd149GxHPzEbF4/JfGg03l/pevDZUjYkdE7IyI/0fEroh4IKJe9qGIeLjL+iuL8kvHPz9u7imwDmXjv5fzta27x39pUaRcynPb6/EPJydPV6cP5q/JgRjemOXHl6njm1d/+rTdsebxX7Zl9Rdjwbwdvw0tmqA7MTk3uZKYm938MGLPUKv4k4WVgGx8vDsi9vTw/NnJO/3Ml/vaHf/3+JfRep2pK7UvIp5unP/5WBR/IVl+fXJsU1SnD44VV8VSN364+ka7+ruNv916Yq+y87+l5fW/UFM5aV6vne2+jqu/fNL2nqbX639D8lY9vSHf9/7k3NyF8YgNyfzS/RN3Hlvki/JZ/Af2t+7/OyP+/jx/3N6IyC7iRyLi0Yh4LG/74xHxRETsXyb+71558t3e419bWfwnujr/3SdKZ779ul39nZ3/w/XUgXxPJ+9/nTZwJa8dAAAA3C/S+nfgk3R0IZ2mo6ON7/Dvii1pdWZ27tmTM++dO9H4rnw5htNipmukaT50PJ8bLvITi/KH6vPGtVqttrmeH52aqa7VmjrQma1t+n/m11K/WwesuY7W0YpFmNVegQL6ahXW0YH7lP4Pg0v/h8Gl/8PgatX/r0Tc7kNTgHXm8x8Gl/4Pg0v/h8Gl/8NAavPb+OH8cK8/+a/uPLaSvxgwSInSvdGMrhOR3hPN6C2Rtjq0KSL60Z6NXXS0K+vWwj6/MQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKySfwIAAP//Gh7gWg==")
openat(0xffffffffffffffff, &(0x7f0000000080)='./file0\x00', 0x80000, 0x120)
read$FUSE(0xffffffffffffffff, &(0x7f00000006c0)={0x2020, 0x0, 0x0, 0x0, 0x0, <r0=>0x0}, 0x2020)
syz_open_procfs$userns(r0, 0x0)

488.183559ms ago: executing program 3 (id=5):
perf_event_open(&(0x7f000001d000)={0x1, 0x80, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffff, 0x0, @perf_bp={0x0}, 0x0, 0x0, 0x800000, 0x0, 0x0, 0x10000}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
sendfile(0xffffffffffffffff, 0xffffffffffffffff, 0x0, 0x3)
r0 = socket$igmp(0x2, 0x3, 0x2)
setsockopt$MRT_ADD_VIF(r0, 0x0, 0xca, 0x0, 0x0)
r1 = socket$inet6_udplite(0xa, 0x2, 0x88)
r2 = socket$inet(0x2, 0x3, 0x5)
setsockopt$inet_msfilter(r2, 0x0, 0x8, 0x0, 0x1)
ioctl$sock_inet6_SIOCSIFADDR(r1, 0x8916, 0x0)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f00000001c0)={<r3=>0xffffffffffffffff, <r4=>0xffffffffffffffff})
setsockopt$SO_ATTACH_FILTER(r4, 0x1, 0x1a, &(0x7f0000000000)={0x3, &(0x7f0000000040)=[{0x20, 0x0, 0x0, 0xfffff010}, {0x20, 0x0, 0x0, 0xfffff038}, {0x6}]}, 0x10)
r5 = fcntl$dupfd(r3, 0x0, r4)
socket$nl_generic(0x10, 0x3, 0x10)
sendmsg$IPVS_CMD_SET_SERVICE(r5, &(0x7f0000000100)={0x0, 0x0, &(0x7f00000000c0)={0x0}}, 0x0)
rt_sigtimedwait(0x0, &(0x7f0000000140), &(0x7f0000000200), 0x0)
futex(&(0x7f0000000000)=0x1, 0x6, 0x0, 0x0, 0x0, 0x0)

486.232868ms ago: executing program 0 (id=6):
r0 = perf_event_open(&(0x7f000001d000)={0x1, 0xfffffffffffffe2b, 0x0, 0x0, 0x0, 0x0, 0x0, 0x20, 0x22018, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_bp={0x0}, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffffffffffd}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
fstat(r0, &(0x7f0000000240)={0x0, 0x0, 0x0, 0x0, <r1=>0x0})
syz_clone3(0x0, 0x0)
setsockopt$inet6_int(0xffffffffffffffff, 0x29, 0x48, 0x0, 0x0)
socketpair(0x1, 0x80000, 0x0, &(0x7f0000000000))
socket$inet_udplite(0x2, 0x2, 0x88)
socket(0x10, 0x803, 0x0)
perf_event_open(&(0x7f000001d000)={0x1, 0x80, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7f, 0x8088, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_bp={0x0}}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
socket$nl_generic(0x10, 0x3, 0x10)
r2 = socket$nl_generic(0x10, 0x3, 0x10)
open(&(0x7f0000000300)='./file0\x00', 0x82, 0x4)
r3 = syz_genetlink_get_family_id$ethtool(&(0x7f0000000c80), 0xffffffffffffffff)
perf_event_open(&(0x7f000001d000)={0x1, 0x80, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_bp={0x0}}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
mmap(&(0x7f0000000000/0xff5000)=nil, 0xff5000, 0x0, 0x5c832, 0xffffffffffffffff, 0x0)
mbind(&(0x7f0000001000/0x800000)=nil, 0x800000, 0x0, 0x0, 0x0, 0x2)
sendmsg$ETHTOOL_MSG_TSINFO_GET(r2, &(0x7f00000002c0)={0x0, 0x0, &(0x7f0000000280)={&(0x7f0000000440)=ANY=[@ANYBLOB=' \x00\x00\x00', @ANYRES16=r3, @ANYBLOB="01000000000000000000190000000c00018008000100972ad7c07d3dc7d7b9f9cbebd43e311612fb49158dc70ed97b5b773c", @ANYRES32, @ANYBLOB], 0x20}}, 0x0)
syz_mount_image$ext4(&(0x7f00000004c0)='ext4\x00', &(0x7f0000000040)='./file0\x00', 0x90080, &(0x7f0000000340)={[{@quota}, {@nodiscard}, {@nobarrier}], [{@uid_gt={'uid>', r1}}, {@context={'context', 0x3d, 'unconfined_u'}}, {@uid_eq={'uid', 0x3d, r1}}, {@flag='mand'}]}, 0x1, 0x4b9, &(0x7f0000000500)="$eJzs3cFvVFsZAPDv3ra0lEJLZKFGBRFFQ5hpB2gIK9xoDCExElcuoLZD03Sm03SmSCuL8j+YSOJK/wQXJi5MWLl3pzs3uDBBH3kv9CVvMS/3zrS0ZYaWB+0knd8vObn33DMz3zlM7jnDNzAngL51ISI2IuJERDyIiPH29aRd4narZI97/erJ7OarJ7NJNJv3/p/k7dm12PGczKn2a45ExC9+GvHr5O249bX1xZlKpbzSrhcb1eVifW396kJ1Zr48X14qlaanpidvXrtR+mhjPV/988ufLNz55d/++u0X/9j40W+zbo2123aO42NqDX1oO05mMCLuHEawHhhoj+dErzvCV5JGRCEiLub3/3gM5O8mAHCcNZvj0RzfWQcAjrs0z4ElaaGdCxiLNC0UWjm8czGaVmr1xpWHtdWluVaubCKG0ocLlfJkO1c4EUNJVp/Kz9/US3vq1yLibET8bvhkXi/M1ipzvfzgAwB97NSe9f+z4db6DwAccyO97gAAcOSs/wDQf6z/ANB/rP8A0H+s/wDQf6z/ANB/rP8A0Fd+fvduVpqb7d+/nnu0trpYe3R1rlxfLFRXZwuztZXlwnytNp//Zk91v9er1GrLU9dj9XGxUa43ivW19fvV2upS437+u973y0NHMioA4F3Onn/+ryQiNm6dzEvs2MvBWg3HW9rrDgA9M9DrDgA9Y7cv6F/+jg902KJ3lx3/ROjkroZnh9Mf4PBd/ob8P/Srg+b/hw+5H8DRk/+H/iX/D/2r2Uzs+Q8AfUaOH3iP7/938/0/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAfWwsL0laaO8FPhZpWihEnI6IiRhKHi5UypMRcSYi/jk8NJzVp3rdaQDgA6X/Tdr7f10evzS2t/VE8vlwfoyI3/zh3u8fzzQaK1PZ9U+2rzeeta+XetF/AGA/W+v01jq+5fWrJ7Nb5Sj78/LHrc1Fs7ib7dJqGYzB/DgSQxEx+mnSrrdkn1cGPkL8jacR8fVO40/y3MhEe+fTvfGz2KePNH66K36at7WO2Z/F194/dNctXaFfPM/mn9ud7r80LuTHzvf/SD5Dfbit+W/zrfkv3Z7/BrrMfxcOGuP633/Wte1pxDcHO8VPtuMnXeJfOmD8f3/rOxe7tTX/GHE5OsffGavYqC4X62vrVxeqM/Pl+fJSqTQ9NT1589qNUjHPURe3MtVv+9+tK2feNf7RLvFH9hn/9w84/j998eBX3+3UkC1sTyN++L3O7/+5d8TPnvqDA8afGf1L17k+G/9cl/Hv9/5fOWD8F/9ZnzvgQwGAI1BfW1+cqVTKK06cOHGyfdLrmQk4bG9u+l73BAAAAAAAAAAAAAAA6OYo/jtRr8cIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADA8fVlAAAA///xCNiN")
mbind(&(0x7f0000ffc000/0x4000)=nil, 0x4000, 0x2001, 0x0, 0x0, 0x0)
r4 = accept$unix(0xffffffffffffffff, 0x0, &(0x7f0000000080))
ioctl$sock_SIOCGIFVLAN_SET_VLAN_INGRESS_PRIORITY_CMD(r4, 0x8982, &(0x7f0000000140)={0x2, 'rose0\x00', {0x9}, 0x7})
mkdir(&(0x7f0000000b80)='./file1\x00', 0x0)
mount$tmpfs(0x0, &(0x7f00000000c0)='./file1\x00', &(0x7f0000000200), 0x0, &(0x7f0000000000)=ANY=[@ANYBLOB="70f3643fd1", @ANYRESHEX=0x0, @ANYBLOB=',nr_inodes=60p,\x00'])
r5 = fsopen(&(0x7f00000001c0)='ramfs\x00', 0x0)
fsconfig$FSCONFIG_SET_FLAG(r5, 0x6, 0x0, 0x0, 0x0)
sendto(r2, &(0x7f00000003c0)="87b855300cd8044c1b7caf963cfeb3e1db3c20c82f391673cd207d623027b365f10626c0ec3b8a8226f9b7303270160ee58f034a0a98376718b9204ab8b5db2ee7494e3d038883ddd85e", 0x4a, 0x0, 0x0, 0x0)
r6 = fsmount(r5, 0x0, 0x0)
fsconfig$FSCONFIG_SET_PATH_EMPTY(r5, 0x4, &(0x7f0000000000)='ramfs\x00', &(0x7f0000000040)='./file0\x00', r6)
keyctl$set_reqkey_keyring(0xe, 0x5)
quotactl$Q_GETINFO(0xffffffff80000501, &(0x7f0000000100)=@loop={'/dev/loop', 0x0}, 0x0, &(0x7f0000000180))

237.096911ms ago: executing program 0 (id=7):
io_setup(0x8000000, &(0x7f0000000040)=<r0=>0x0)
io_pgetevents(r0, 0x6, 0x2, &(0x7f0000000000)=[{}, {}], &(0x7f0000000080)={0x0, 0x3938700}, &(0x7f00000001c0)={&(0x7f0000000180)={[0x8000000000000000]}, 0x8})
r1 = socket$inet6_tcp(0xa, 0x1, 0x0)
r2 = socket(0x10, 0x3, 0x0)
sendto$inet6(r2, &(0x7f0000000080)="7800000018002507b9409b14ffff00000202be04020506050e130409430009003f0020480a0000000d0085a168d0bf46d32345653600648d270015000a00000049935ade4a460c89b6ec0cff3959547f509058ba86c902000000004a3200040016000b000a0000000000e000e218d1ddf66ed538f2523250", 0x78, 0x0, 0x0, 0x0)
bind$inet6(r1, &(0x7f0000000000)={0xa, 0x0, 0x0, @initdev={0xfe, 0x88, '\x00', 0x0, 0x0}, 0x8}, 0x1c)
bind$inet6(r1, &(0x7f0000000140)={0xa, 0x4e22}, 0x1c)
r3 = eventfd(0xffff)
io_submit(0x0, 0x1, &(0x7f0000000740)=[&(0x7f0000000700)={0x0, 0x0, 0x0, 0x6, 0x3, r1, &(0x7f0000000640)="3f4b86050b824361a0f4daeaf6d5d99ae47322cf0f26cf6e173fde87d6c805a90799fcaaba3860345c7424b5e4aeeb8d7e3309779301bb81e83e45e540346c1c987bdfdc289bbabda31b3417a6f5bc5fada517658f8ba1c0fd2187365e2c4b90dce7d836509c502a6747d94c90852759e2eb5a743ba46e9582144efbcc14d0abd2016203e4", 0x85, 0xa3fc, 0x0, 0x3, r3}])
openat$rtc(0xffffffffffffff9c, &(0x7f00000000c0), 0x2, 0x0)
r4 = socket$inet6_tcp(0xa, 0x1, 0x0)
perf_event_open$cgroup(&(0x7f0000000340)={0x1, 0x80, 0x0, 0x0, 0x86, 0x2, 0x0, 0x5afd, 0x8000, 0x2, 0x1, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext}, 0xffffffffffffffff, 0x0, 0xffffffffffffffff, 0x0)
io_submit(0x0, 0x0, 0x0)
bind$inet6(r4, &(0x7f0000d84000)={0xa, 0x2, 0x0, @loopback}, 0x1c)
setsockopt$inet6_int(r4, 0x29, 0x4a, &(0x7f0000000600)=0x8, 0x4)
setsockopt$inet6_tcp_int(r4, 0x6, 0x2000000000000022, &(0x7f0000000200)=0x1, 0x4)
sendto$inet6(r4, &(0x7f00000000c0)="044aac2f202c5feda71e039a57a93088fdcce4afe28aac61837792741a190670ccbe1a2b00aa77a87d56a3f12c7920ad02928a5d1014e5b896f000fcf6521928480be9af82613a5c661f4110adba358afd8b5b4ef1702051e393ede2698112a1f1bdf1d0f568546ed322ab4c53545bd2cd6e48522f0c154cb3c6864dc30ae921db100f1ee97a234503338f8fdf356472da0c7ab62f274f34", 0x116d962d5f73552, 0x20000845, &(0x7f0000b63fe4)={0xa, 0x2}, 0x1c)
close(r4)
syz_genetlink_get_family_id$nl80211(0x0, 0xffffffffffffffff)
sendmsg$NL80211_CMD_SET_WOWLAN(0xffffffffffffffff, &(0x7f0000004d40)={0x0, 0x0, 0x0}, 0x0)
perf_event_open(&(0x7f0000001340)={0x1, 0x80, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4, 0x0, 0x400, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_bp={0x0}}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
write$rfkill(0xffffffffffffffff, 0x0, 0x0)
syz_mount_image$ext4(&(0x7f0000000040)='ext4\x00', &(0x7f0000000480)='./file0\x00', 0x201000a, &(0x7f0000000000), 0x84, 0x460, &(0x7f00000004c0)="$eJzs289vFFUcAPDvzFJ+YxfEH/zSKhqJP1paUDl4wWjCxcRED3ispRCkUENrIoRINQaPhr9APZr4F3jCC1FOGq96NybEcBE96JrZnSlLu1t3u90uZT+fZNr3Zt7ue9+debtv3tsNoG8NZX+SiK0R8UtEDNaydxcYqv27fevSxF+3Lk0kUam89UcSpYj489aliaJo8bgt85lypJ8msadBvTMXLp4Zn5qaPJ/nR2bPvj8yc+HiC6fPjp+aPDV5buzIkcOHRl9+aezFFYlzW9bW3R9N79117J2rb0wcv/ruD99kTdyaH6+Po6bccZ1DMXT3a1nn6Y6f/d5yY/uddLKuYZFrq9caWpX14ex0DVT7/2CU4s7JG4zXP+lp44CuqlQq/25YtLdUJOYqwH0sG80D/aj4oM/uf4ttFYcfPXfzaG2qIov7dr7VjqyLNLuHL9fujbZ1qf6hiDg+9/cX2RYN5yEAAFbWtaMR8Xyj8V8aD9eVeyBfGypHxPaI2BERD0bEzoh4KKJa9pGIeLTN+ocW5BePf37atKzAWpSN/17J17buHv+lRZFyKc9tq8Y/kJw8PTV5MH9NDsTAhiw/ukQd37328+fNjtWP/7Itq78YC+bt+H3dggm6E+Oz453EXO/mxxGRXN+3OP5kfiUgGx/viojdy3j+7OSdfvbrvc2O/3/8S2i8ztSWylcRz9TO/1wsiL+QLL0+ObIxpiYPjhRXxWI3frzyZrP6O4p/BWTnf3PD638+/nJSv147034dV379rOk9zXKv//XJ29X0+nzfh+Ozs+dHI9Ync4v3j915bJEvymfxH9jfuP/viPjny/xxeyIiu4j3RcRjEfF43vYnIuLJiNi/RPzfv/rUe8uPv7uy+E+0df7bT5TOXP+2Wf2tnf/D1dSBfE8r73+tNrCT1w4AAADWirT6HfgkHZ5Pp+nwcO07/Dtjczo1PTP73MnpD86dqH1XvhwDaTHTNVg3Hzqazw0X+bEF+UPVeeNKpVLZVM0PT0xPdWtNHWjNlib9P/NbqdetA7qupXW0YhGm2S/agDVpBdbRgTVK/4f+pf9D/9L/oX816v+XI273oCnAKvP5D/1L/4f+pf9D/9L/oS918rv+pRI7jnXrme+3ROneaEbbiUjviWYsL5E2OrQxInrRng0R0Wrhy6vWwl6/MwEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKyM/wIAAP//677pmw==")

0s ago: executing program 2 (id=8):
sendmsg$NLBL_CIPSOV4_C_ADD(0xffffffffffffffff, &(0x7f00000000c0)={0x0, 0x0, &(0x7f0000000080)={&(0x7f0000000180)={0x1b0, 0x0, 0x1, 0x0, 0x0, {}, [@NLBL_CIPSOV4_A_MLSLVLLST={0x190, 0x8, 0x0, 0x1, [{0x24, 0x7, 0x0, 0x1, [@NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}]}, {0x14, 0x7, 0x0, 0x1, [@NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}]}, {0x34, 0x7, 0x0, 0x1, [@NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}]}, {0x2c, 0x7, 0x0, 0x1, [@NLBL_CIPSOV4_A_MLSLVLLOC={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}]}, {0xc, 0x7, 0x0, 0x1, [@NLBL_CIPSOV4_A_MLSLVLREM={0x8}]}, {0x44, 0x7, 0x0, 0x1, [@NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}]}, {0x54, 0x7, 0x0, 0x1, [@NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}]}, {0x14, 0x7, 0x0, 0x1, [@NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}]}, {0x3c, 0x7, 0x0, 0x1, [@NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}, @NLBL_CIPSOV4_A_MLSLVLLOC={0x8}, @NLBL_CIPSOV4_A_MLSLVLREM={0x8}]}]}, @NLBL_CIPSOV4_A_MTYPE={0x8}, @NLBL_CIPSOV4_A_MLSLVLLST={0x4}]}, 0x1b0}}, 0x0)
r0 = openat$sr(0xffffffffffffff9c, &(0x7f0000000080), 0x129e02, 0x0)
ioctl$BTRFS_IOC_START_SYNC(r0, 0x31f, &(0x7f0000000180))
r1 = socket$inet6_tcp(0xa, 0x1, 0x0)
perf_event_open(&(0x7f000001d000)={0x1, 0x80, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7f, 0x20000, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_bp={0x0}}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
r2 = socket$inet6_tcp(0xa, 0x1, 0x0)
setsockopt$inet6_int(r2, 0x29, 0x4a, 0x0, 0x0)
socket$inet6_udplite(0xa, 0x2, 0x88)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000200)={<r3=>0xffffffffffffffff})
r4 = eventfd(0x0)
r5 = openat$sysfs(0xffffffffffffff9c, &(0x7f00000001c0)='/sys/kernel/fscaps', 0x0, 0x0)
dup2(r5, r4)
pipe2(&(0x7f0000000780), 0x48c0)
getsockopt$sock_buf(r3, 0x1, 0x1c, 0x0, &(0x7f00000000c0))
getsockopt$IP_SET_OP_GET_BYNAME(0xffffffffffffffff, 0x1, 0x53, 0x0, 0x0)
poll(&(0x7f0000000040)=[{}, {}, {r1}], 0x3, 0x0)
setsockopt$inet6_int(r1, 0x29, 0x40, &(0x7f0000000000), 0x4)

kernel console output (not intermixed with test programs):

Warning: Permanently added '[localhost]:38739' (ED25519) to the list of known hosts.
syzkaller login: [   17.461156] cgroup: Unknown subsys name 'net'
[   17.462795] cgroup: Unknown subsys name 'net_prio'
[   17.464485] cgroup: Unknown subsys name 'devices'
[   17.466010] cgroup: Unknown subsys name 'blkio'
[   17.499538] cgroup: Unknown subsys name 'hugetlb'
[   17.500791] cgroup: Unknown subsys name 'rlimit'
Setting up swapspace version 1, size = 122.1 MiB (127995904 bytes)
no label, UUID=4cb1c1e7-a19f-4afc-b5cf-9bfb0c8d8375
[   17.582779] Adding 124996k swap on ./swap-file.  Priority:0 extents:1 across:124996k 
[   18.253338] audit: type=1400 audit(1731288762.457:6): avc:  denied  { execmem } for  pid=226 comm="syz-executor" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
[   25.423496] audit: type=1400 audit(1731288769.627:7): avc:  denied  { open } for  pid=2009 comm="syz.0.1" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=perf_event permissive=1
[   25.667695] EXT4-fs (loop2): old and new quota format mixing
[   25.750942] netlink: 180 bytes leftover after parsing attributes in process `syz.2.3'.
[   25.779477] audit: type=1400 audit(1731288769.983:8): avc:  denied  { kernel } for  pid=2054 comm="syz.1.2" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=perf_event permissive=1
[   25.832500] EXT4-fs (loop1): mounted filesystem without journal. Opts: ,errors=continue
[   25.903614] hrtimer: interrupt took 20080 ns
[   25.930011] EXT4-fs (loop3): quotafile must be on filesystem root
[   26.270820] netlink: 'syz.0.7': attribute type 11 has an invalid length.
[   26.465942] EXT4-fs error (device loop1): ext4_mb_generate_buddy:802: group 0, block bitmap and bg descriptor inconsistent: 25 vs 150994969 free clusters
[   26.572548] ------------[ cut here ]------------
[   26.583742] WARNING: CPU: 1 PID: 2062 at fs/ext4/xattr.c:1640 ext4_xattr_set_entry+0x2917/0x37c0
[   26.585960] Modules linked in:
[   26.587870] CPU: 1 PID: 2062 Comm: syz.1.2 Not tainted 5.10.0 #1
[   26.593058] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   26.597934] RIP: 0010:ext4_xattr_set_entry+0x2917/0x37c0
[   26.600351] Code: 00 e9 98 db ff ff e8 c8 f8 8f ff 48 8b 7c 24 08 45 31 ed e8 4b c3 df ff 48 8b ac 24 18 01 00 00 e9 79 db ff ff e8 a9 f8 8f ff <0f> 0b e9 71 e1 ff ff e8 9d f8 8f ff 48 8b 54 24 38 31 f6 4c 89 e7
[   26.606383] RSP: 0018:ffff88800f9c7378 EFLAGS: 00010202
[   26.608352] RAX: 0000000000010290 RBX: ffff888010561020 RCX: ffffc900011a5000
[   26.609826] RDX: 0000000000040000 RSI: ffffffff81b61617 RDI: 0000000000000007
[   26.611390] RBP: 0000000000000000 R08: 0000000000000001 R09: 0000000000000000
[   26.633655] R10: 0000000000000000 R11: 0000000000000001 R12: 00000000000007dc
[   26.635760] R13: 00000000ffffffc3 R14: ffff88800f9c76c0 R15: ffff88800f9c77e8
[   26.637581] FS:  00007f17d463c6c0(0000) GS:ffff88806cf00000(0000) knlGS:0000000000000000
[   26.639732] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[   26.641810] CR2: 00007fc3a0a23ab8 CR3: 000000000ca38000 CR4: 0000000000350ee0
[   26.645141] Call Trace:
[   26.646780]  ? mark_held_locks+0x9e/0xe0
[   26.648341]  ? ext4_xattr_inode_dec_ref_all+0xa10/0xa10
[   26.650231]  ? lockdep_hardirqs_on+0x79/0x100
[   26.652071]  ? entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   26.654056]  ? __kasan_kmalloc.constprop.0+0xc5/0xd0
[   26.655973]  ? __kasan_kmalloc.constprop.0+0xc2/0xd0
[   26.658040]  ext4_xattr_block_set+0x834/0x2f50
[   26.659731]  ? ext4_xattr_inode_dec_ref_all+0xa10/0xa10
[   26.661521]  ? ext4_xattr_block_find+0x690/0x690
[   26.663339]  ? asm_sysvec_apic_timer_interrupt+0x12/0x20
[   26.665272]  ? lockdep_hardirqs_on+0x79/0x100
[   26.667043]  ? asm_sysvec_apic_timer_interrupt+0x12/0x20
[   26.669048]  ext4_xattr_set_handle+0xd01/0x12b0
[   26.670740]  ? ext4_xattr_ibody_inline_set+0x2b0/0x2b0
[   26.672593]  ? ext4_journal_check_start+0x1ae/0x290
[   26.674769]  ? __ext4_journal_start_sb+0x1db/0x490
[   26.676526]  ext4_xattr_set+0x13a/0x340
[   26.678279]  ? ext4_xattr_set_credits+0x210/0x210
[   26.680081]  ? inode_has_perm+0x171/0x1d0
[   26.681681]  ? ext4_xattr_user_list+0xb0/0xb0
[   26.683338]  ext4_xattr_user_set+0xbc/0x100
[   26.685080]  __vfs_setxattr+0x10f/0x170
[   26.686714]  ? xattr_resolve_name+0x3d0/0x3d0
[   26.688373]  ? security_inode_permission+0xcb/0x100
[   26.690301]  __vfs_setxattr_noperm+0x11a/0x4c0
[   26.692067]  __vfs_setxattr_locked+0x1bf/0x250
[   26.693728]  vfs_setxattr+0xe8/0x270
[   26.695851]  ? __vfs_setxattr_locked+0x250/0x250
[   26.697719]  ? strncpy_from_user+0x9e/0x490
[   26.699331]  setxattr+0x23d/0x330
[   26.700761]  ? vfs_setxattr+0x270/0x270
[   26.702247]  ? filename_lookup+0x3b6/0x560
[   26.703888]  ? lock_release+0x6f0/0x6f0
[   26.705327]  ? preempt_count_add+0x74/0x140
[   26.706989]  ? __mnt_want_write+0x1bc/0x2a0
[   26.708719]  path_setxattr+0x170/0x190
[   26.709760]  ? setxattr+0x330/0x330
[   26.711538]  ? path_setxattr+0x190/0x190
[   26.713079]  ? __x64_sys_setxattr+0xd/0x160
[   26.714682]  __x64_sys_setxattr+0xc0/0x160
[   26.716289]  do_syscall_64+0x33/0x40
[   26.717770]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   26.719746] RIP: 0033:0x7f17d59e3ef9
[   26.721307] Code: ff ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 a8 ff ff ff f7 d8 64 89 01 48
[   26.726183] RSP: 002b:00007f17d463c038 EFLAGS: 00000246 ORIG_RAX: 00000000000000bc
[   26.728493] RAX: ffffffffffffffda RBX: 00007f17d5b9c058 RCX: 00007f17d59e3ef9
[   26.730778] RDX: 0000000000000000 RSI: 00000000200000c0 RDI: 0000000020000080
[   26.733061] RBP: 00007f17d5a56b76 R08: 0000000000000000 R09: 0000000000000000
[   26.735282] R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
[   26.737530] R13: 0000000000000000 R14: 00007f17d5b9c058 R15: 00007fff854823e8
[   26.739911] irq event stamp: 63405
[   26.741299] hardirqs last  enabled at (63443): [<ffffffff83ecb0ef>] _raw_spin_unlock_irq+0x1f/0x40
[   26.743975] hardirqs last disabled at (63456): [<ffffffff83ebb922>] __schedule+0xfe2/0x2030
[   26.746512] softirqs last  enabled at (63438): [<ffffffff84000f92>] asm_call_irq_on_stack+0x12/0x20
[   26.749323] softirqs last disabled at (63479): [<ffffffff84000f92>] asm_call_irq_on_stack+0x12/0x20
[   26.752262] ---[ end trace 898d6ac78affdccd ]---
[   26.755394] 
[   26.755761] ======================================================
[   26.757100] WARNING: possible circular locking dependency detected
[   26.758465] 5.10.0 #1 Tainted: G        W        
[   26.759480] ------------------------------------------------------
[   26.760865] syz.1.2/2062 is trying to acquire lock:
[   26.761974] ffff888019f58628 (sb_internal){.+.+}-{0:0}, at: evict+0x284/0x6d0
[   26.763615] 
[   26.763615] but task is already holding lock:
[   26.764905] ffff888013e2cf88 (&ei->xattr_sem){++++}-{3:3}, at: ext4_xattr_set_handle+0x15e/0x12b0
[   26.766875] 
[   26.766875] which lock already depends on the new lock.
[   26.766875] 
[   26.768678] 
[   26.768678] the existing dependency chain (in reverse order) is:
[   26.770313] 
[   26.770313] -> #2 (&ei->xattr_sem){++++}-{3:3}:
[   26.771662]        down_write+0x8d/0x150
[   26.772554]        ext4_xattr_set_handle+0x15e/0x12b0
[   26.773680]        ext4_initxattrs+0xb5/0x120
[   26.774655]        security_inode_init_security+0x1a7/0x350
[   26.775869]        __ext4_new_inode+0x38ec/0x55b0
[   26.776866]        ext4_create+0x2ce/0x4d0
[   26.777735]        lookup_open+0xf52/0x1330
[   26.778650]        path_openat+0x93f/0x26f0
[   26.779568]        do_filp_open+0x17e/0x3c0
[   26.780509]        do_sys_openat2+0x16d/0x420
[   26.781504]        __x64_sys_openat+0x13f/0x1f0
[   26.782501]        do_syscall_64+0x33/0x40
[   26.783387]        entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   26.784524] 
[   26.784524] -> #1 (jbd2_handle){++++}-{0:0}:
[   26.785739]        start_this_handle+0x103d/0x1440
[   26.786804]        jbd2__journal_start+0x3d3/0x960
[   26.787876]        __ext4_journal_start_sb+0x210/0x490
[   26.789093]        ext4_file_open+0x647/0xab0
[   26.790083]        do_dentry_open+0x650/0x1090
[   26.791100]        path_openat+0x196a/0x26f0
[   26.792092]        do_filp_open+0x17e/0x3c0
[   26.792991]        do_sys_openat2+0x16d/0x420
[   26.793969]        __x64_sys_openat+0x13f/0x1f0
[   26.795111]        do_syscall_64+0x33/0x40
[   26.795960]        entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   26.797165] 
[   26.797165] -> #0 (sb_internal){.+.+}-{0:0}:
[   26.798385]        __lock_acquire+0x2ac4/0x5ca0
[   26.799372]        lock_acquire+0x293/0x9b0
[   26.800283]        ext4_evict_inode+0x5a1/0x1890
[   26.801292]        evict+0x284/0x6d0
[   26.802081]        iput+0x4e5/0x840
[   26.802835]        ext4_xattr_block_set+0x2de/0x2f50
[   26.803918]        ext4_xattr_set_handle+0xd01/0x12b0
[   26.805029]        ext4_xattr_set+0x13a/0x340
[   26.805931]        ext4_xattr_user_set+0xbc/0x100
[   26.806928]        __vfs_setxattr+0x10f/0x170
[   26.807846]        __vfs_setxattr_noperm+0x11a/0x4c0
[   26.808890]        __vfs_setxattr_locked+0x1bf/0x250
[   26.809938]        vfs_setxattr+0xe8/0x270
[   26.810772]        setxattr+0x23d/0x330
[   26.811582]        path_setxattr+0x170/0x190
[   26.812487]        __x64_sys_setxattr+0xc0/0x160
[   26.813476]        do_syscall_64+0x33/0x40
[   26.814359]        entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   26.815560] 
[   26.815560] other info that might help us debug this:
[   26.815560] 
[   26.817252] Chain exists of:
[   26.817252]   sb_internal --> jbd2_handle --> &ei->xattr_sem
[   26.817252] 
[   26.819339]  Possible unsafe locking scenario:
[   26.819339] 
[   26.820661]        CPU0                    CPU1
[   26.821594]        ----                    ----
[   26.822562]   lock(&ei->xattr_sem);
[   26.823285]                                lock(jbd2_handle);
[   26.824501]                                lock(&ei->xattr_sem);
[   26.825765]   lock(sb_internal);
[   26.826490] 
[   26.826490]  *** DEADLOCK ***
[   26.826490] 
[   26.827779] 3 locks held by syz.1.2/2062:
[   26.828624]  #0: ffff888019f58438 (sb_writers#3){.+.+}-{0:0}, at: path_setxattr+0xb5/0x190
[   26.830424]  #1: ffff888013e2d348 (&sb->s_type->i_mutex_key#14){+.+.}-{3:3}, at: vfs_setxattr+0xca/0x270
[   26.832515]  #2: ffff888013e2cf88 (&ei->xattr_sem){++++}-{3:3}, at: ext4_xattr_set_handle+0x15e/0x12b0
[   26.834525] 
[   26.834525] stack backtrace:
[   26.835464] CPU: 1 PID: 2062 Comm: syz.1.2 Tainted: G        W         5.10.0 #1
[   26.836993] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   26.839073] Call Trace:
[   26.839630]  dump_stack+0x107/0x163
[   26.840404]  check_noncircular+0x25f/0x2e0
[   26.841298]  ? lockdep_hardirqs_on+0x79/0x100
[   26.842259]  ? print_circular_bug+0x450/0x450
[   26.843194]  ? mark_lock+0xf5/0x32b0
[   26.843963]  ? mark_lock+0xf5/0x32b0
[   26.844756]  ? mark_lock+0xf5/0x32b0
[   26.845538]  ? alloc_chain_hlocks+0x4bf/0xc80
[   26.846381]  ? print_irqtrace_events+0x270/0x270
[   26.847371]  ? print_irqtrace_events+0x270/0x270
[   26.848408]  __lock_acquire+0x2ac4/0x5ca0
[   26.849306]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   26.850570]  ? __lock_acquire+0x1661/0x5ca0
[   26.851501]  lock_acquire+0x293/0x9b0
[   26.852329]  ? evict+0x284/0x6d0
[   26.853076]  ? lock_release+0x6f0/0x6f0
[   26.853896]  ? dquot_set_dqblk+0x1240/0x1240
[   26.854839]  ext4_evict_inode+0x5a1/0x1890
[   26.855744]  ? evict+0x284/0x6d0
[   26.856480]  ? lock_downgrade+0x6d0/0x6d0
[   26.857395]  ? var_wake_function+0x130/0x130
[   26.858357]  ? ext4_da_write_begin+0xe60/0xe60
[   26.859351]  ? rwlock_bug.part.0+0x90/0x90
[   26.860234]  ? ext4_da_write_begin+0xe60/0xe60
[   26.861184]  evict+0x284/0x6d0
[   26.861879]  ? ext4_nfs_commit_metadata+0x300/0x300
[   26.862945]  iput+0x4e5/0x840
[   26.863594]  ext4_xattr_block_set+0x2de/0x2f50
[   26.864554]  ? ext4_xattr_block_find+0x690/0x690
[   26.865524]  ? asm_sysvec_apic_timer_interrupt+0x12/0x20
[   26.866642]  ? lockdep_hardirqs_on+0x79/0x100
[   26.867597]  ? asm_sysvec_apic_timer_interrupt+0x12/0x20
[   26.868772]  ext4_xattr_set_handle+0xd01/0x12b0
[   26.869757]  ? ext4_xattr_ibody_inline_set+0x2b0/0x2b0
[   26.870891]  ? ext4_journal_check_start+0x1ae/0x290
[   26.871959]  ? __ext4_journal_start_sb+0x1db/0x490
[   26.873038]  ext4_xattr_set+0x13a/0x340
[   26.873872]  ? ext4_xattr_set_credits+0x210/0x210
[   26.874853]  ? inode_has_perm+0x171/0x1d0
[   26.875723]  ? ext4_xattr_user_list+0xb0/0xb0
[   26.876659]  ext4_xattr_user_set+0xbc/0x100
[   26.877568]  __vfs_setxattr+0x10f/0x170
[   26.878417]  ? xattr_resolve_name+0x3d0/0x3d0
[   26.879345]  ? security_inode_permission+0xcb/0x100
[   26.880427]  __vfs_setxattr_noperm+0x11a/0x4c0
[   26.881409]  __vfs_setxattr_locked+0x1bf/0x250
[   26.882378]  vfs_setxattr+0xe8/0x270
[   26.883124]  ? __vfs_setxattr_locked+0x250/0x250
[   26.884074]  ? strncpy_from_user+0x9e/0x490
[   26.884941]  setxattr+0x23d/0x330
[   26.885668]  ? vfs_setxattr+0x270/0x270
[   26.886526]  ? filename_lookup+0x3b6/0x560
[   26.887430]  ? lock_release+0x6f0/0x6f0
[   26.888276]  ? preempt_count_add+0x74/0x140
[   26.889194]  ? __mnt_want_write+0x1bc/0x2a0
[   26.890123]  path_setxattr+0x170/0x190
[   26.890951]  ? setxattr+0x330/0x330
[   26.891732]  ? path_setxattr+0x190/0x190
[   26.892576]  ? __x64_sys_setxattr+0xd/0x160
[   26.893476]  __x64_sys_setxattr+0xc0/0x160
[   26.894343]  do_syscall_64+0x33/0x40
[   26.895130]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   26.896186] RIP: 0033:0x7f17d59e3ef9
[   26.896963] Code: ff ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 a8 ff ff ff f7 d8 64 89 01 48
[   26.900858] RSP: 002b:00007f17d463c038 EFLAGS: 00000246 ORIG_RAX: 00000000000000bc
[   26.902488] RAX: ffffffffffffffda RBX: 00007f17d5b9c058 RCX: 00007f17d59e3ef9
[   26.904022] RDX: 0000000000000000 RSI: 00000000200000c0 RDI: 0000000020000080
[   26.905526] RBP: 00007f17d5a56b76 R08: 0000000000000000 R09: 0000000000000000
[   26.906969] R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
[   26.908570] R13: 0000000000000000 R14: 00007f17d5b9c058 R15: 00007fff854823e8
[   26.925096] EXT4-fs (loop1): Delayed block allocation failed for inode 18 at logical offset 0 with max blocks 2048 with error 28
[   26.927566] EXT4-fs (loop1): This should not happen!! Data will be lost
[   26.927566] 
[   26.933340] EXT4-fs (loop1): Total free blocks count 0
[   26.934493] EXT4-fs (loop1): Free/Dirty block details
[   26.935768] EXT4-fs (loop1): free_blocks=2415919104
[   26.943325] EXT4-fs (loop1): dirty_blocks=8192
[   26.944699] EXT4-fs (loop1): Block reservation details
[   26.946078] EXT4-fs (loop1): i_reserved_data_blocks=512
[   26.971487] EXT4-fs (loop1): Delayed block allocation failed for inode 18 at logical offset 2050 with max blocks 2048 with error 28
[   26.974175] EXT4-fs (loop1): This should not happen!! Data will be lost
[   26.974175] 

VM DIAGNOSIS:
09:32:50  Registers:
info registers vcpu 0

CPU#0
RAX=ffffffff817e1863 RBX=ffff888008b379d8 RCX=ffff888008b379d8 RDX=dffffc0000000000
RSI=ffff888008b37d78 RDI=ffff888008b37d78 RBP=ffff888008b37d78 RSP=ffff888008b37878
R8 =ffffffff861975b6 R9 =ffffffff861975ba R10=ffffed1001166f3d R11=0000000000000001
R12=ffff888008b37990 R13=ffff888008b30000 R14=ffff888008b379e0 R15=ffff888008b37990
RIP=ffffffff8112a53e RFL=00000283 [--S---C] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007ffb1f7866c0 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f97ec1b9010 CR3=0000000019cf0000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM02=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM03=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM04=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM05=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM06=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM07=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 00007ffb20b80b19
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=0000000000000001 RBX=0000000000000001 RCX=ffffffff812ad4c3 RDX=fffffbfff0bacd82
RSI=0000000000000008 RDI=ffffffff85d66c08 RBP=1ffff11003421ed7 RSP=ffff88801a10f6a8
R8 =0000000000000000 R9 =ffffffff85d66c0f R10=fffffbfff0bacd81 R11=0000000000000001
R12=ffffffff850e7f00 R13=ffff88800feaf4c0 R14=dffffc0000000000 R15=000000110c299000
RIP=ffffffff812ad4cb RFL=00000247 [---Z-PC] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f97ec1b9010 CR3=0000000015c5e000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM02=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM03=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM04=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM05=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM06=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM07=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 00007fc3a090db19
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
