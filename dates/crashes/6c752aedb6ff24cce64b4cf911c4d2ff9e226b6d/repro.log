Warning: Permanently added '[localhost]:22934' (ED25519) to the list of known hosts.
executing program
syzkaller login: [   82.146334] audit: type=1400 audit(1730984929.205:6): avc:  denied  { execmem } for  pid=237 comm="syz-executor861" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
[   82.197389] EXT4-fs (loop0): mounted filesystem without journal. Opts: ,errors=continue
[   82.205473] EXT4-fs error (device loop0): ext4_mb_generate_buddy:802: group 0, block bitmap and bg descriptor inconsistent: 79 vs 25 free clusters
[   82.213307] 
[   82.213846] ======================================================
[   82.215799] WARNING: possible circular locking dependency detected
[   82.217822] 5.10.0 #1 Not tainted
[   82.218851] ------------------------------------------------------
[   82.221890] syz-executor861/237 is trying to acquire lock:
[   82.224202] ffff8880132ab200 (&ei->xattr_sem){++++}-{3:3}, at: ext4_find_inline_entry+0xb5/0x4a0
[   82.227084] 
[   82.227084] but task is already holding lock:
[   82.228687] ffff8880132ac970 (&ea_inode->i_rwsem#14/1){+.+.}-{3:3}, at: vfs_unlink+0xcd/0x610
[   82.230811] 
[   82.230811] which lock already depends on the new lock.
[   82.230811] 
[   82.232810] 
[   82.232810] the existing dependency chain (in reverse order) is:
[   82.234666] 
[   82.234666] -> #1 (&ea_inode->i_rwsem#14/1){+.+.}-{3:3}:
[   82.236380]        down_write+0x8d/0x150
[   82.237365]        ext4_xattr_set_entry+0x299e/0x37c0
[   82.238616]        ext4_xattr_ibody_inline_set+0x78/0x2b0
[   82.239948]        ext4_xattr_set_handle+0x939/0x12b0
[   82.241210]        ext4_xattr_set+0x13a/0x340
[   82.242283]        __vfs_setxattr+0x10f/0x170
[   82.243356]        __vfs_setxattr_noperm+0x11a/0x4c0
[   82.244579]        __vfs_setxattr_locked+0x1bf/0x250
[   82.245795]        vfs_setxattr+0xe8/0x270
[   82.246807]        setxattr+0x23d/0x330
[   82.247806]        path_setxattr+0x170/0x190
[   82.248886]        __x64_sys_setxattr+0xc0/0x160
[   82.249866]        do_syscall_64+0x33/0x40
[   82.250478]        entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   82.251295] 
[   82.251295] -> #0 (&ei->xattr_sem){++++}-{3:3}:
[   82.252337]        __lock_acquire+0x2ac4/0x5ca0
[   82.253014]        lock_acquire+0x293/0x9b0
[   82.253611]        down_read+0x96/0x450
[   82.254178]        ext4_find_inline_entry+0xb5/0x4a0
[   82.254889]        __ext4_find_entry+0xb7c/0x10d0
[   82.255572]        __ext4_unlink+0x10d/0xa40
[   82.256208]        ext4_unlink+0x323/0x8f0
[   82.256797]        vfs_unlink+0x2d0/0x610
[   82.257400]        do_unlinkat+0x39b/0x650
[   82.258007]        do_syscall_64+0x33/0x40
[   82.258596]        entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   82.259398] 
[   82.259398] other info that might help us debug this:
[   82.259398] 
[   82.260578]  Possible unsafe locking scenario:
[   82.260578] 
[   82.261448]        CPU0                    CPU1
[   82.262108]        ----                    ----
[   82.262753]   lock(&ea_inode->i_rwsem#14/1);
[   82.263391]                                lock(&ei->xattr_sem);
[   82.264298]                                lock(&ea_inode->i_rwsem#14/1);
[   82.265270]   lock(&ei->xattr_sem);
[   82.265775] 
[   82.265775]  *** DEADLOCK ***
[   82.265775] 
[   82.266634] 3 locks held by syz-executor861/237:
[   82.267317]  #0: ffff888008a1a438 (sb_writers#3){.+.+}-{0:0}, at: do_unlinkat+0x190/0x650
[   82.268548]  #1: ffff8880132ab5c0 (&type->i_mutex_dir_key#3/1){+.+.}-{3:3}, at: do_unlinkat+0x27d/0x650
[   82.269959]  #2: ffff8880132ac970 (&ea_inode->i_rwsem#14/1){+.+.}-{3:3}, at: vfs_unlink+0xcd/0x610
[   82.271269] 
[   82.271269] stack backtrace:
[   82.271907] CPU: 0 PID: 237 Comm: syz-executor861 Not tainted 5.10.0 #1
[   82.272867] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   82.274296] Call Trace:
[   82.274671]  dump_stack+0x107/0x163
[   82.275192]  check_noncircular+0x25f/0x2e0
[   82.275785]  ? print_circular_bug+0x450/0x450
[   82.276430]  ? alloc_chain_hlocks+0x4bf/0xc80
[   82.277075]  __lock_acquire+0x2ac4/0x5ca0
[   82.277694]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   82.278470]  ? __getblk_gfp+0x48/0x70
[   82.279032]  lock_acquire+0x293/0x9b0
[   82.279579]  ? ext4_find_inline_entry+0xb5/0x4a0
[   82.280266]  ? lock_release+0x6f0/0x6f0
[   82.280827]  ? ext4_da_get_block_prep+0x1210/0x1210
[   82.281569]  ? __lock_acquire+0xc2d/0x5ca0
[   82.282183]  down_read+0x96/0x450
[   82.282668]  ? ext4_find_inline_entry+0xb5/0x4a0
[   82.283342]  ? down_write+0x150/0x150
[   82.283854]  ? ext4_inode_attach_jinode+0x230/0x230
[   82.284569]  ext4_find_inline_entry+0xb5/0x4a0
[   82.285216]  ? ext4_try_create_inline_dir+0x2d0/0x2d0
[   82.285945]  ? lock_downgrade+0x6d0/0x6d0
[   82.286539]  ? find_first_zero_bit+0x94/0xb0
[   82.287158]  __ext4_find_entry+0xb7c/0x10d0
[   82.287763]  ? avc_has_extended_perms+0xf60/0xf60
[   82.288440]  ? ext4_dx_find_entry+0x430/0x430
[   82.289087]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   82.289815]  ? avc_has_perm+0xc5/0x1b0
[   82.290367]  ? avc_has_perm+0x108/0x1b0
[   82.290920]  __ext4_unlink+0x10d/0xa40
[   82.291491]  ? ext4_symlink+0xc60/0xc60
[   82.292056]  ? ext4_journal_check_start+0x1ae/0x290
[   82.292778]  ? __ext4_journal_start_sb+0x1db/0x490
[   82.293514]  ext4_unlink+0x323/0x8f0
[   82.294065]  vfs_unlink+0x2d0/0x610
[   82.294589]  ? __lookup_hash+0x36/0x190
[   82.295156]  do_unlinkat+0x39b/0x650
[   82.295678]  ? __x64_sys_rmdir+0x100/0x100
[   82.296278]  do_syscall_64+0x33/0x40
[   82.296800]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   82.297556] RIP: 0033:0x7f3b421b7a4d
[   82.298124] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[   82.300712] RSP: 002b:00007fff57b238f8 EFLAGS: 00000246 ORIG_RAX: 0000000000000057
[   82.301792] RAX: ffffffffffffffda RBX: 0030656c69662f2e RCX: 00007f3b421b7a4d
[   82.302818] RDX: 00007f3b421b7a4d RSI: ffffffffffffffc0 RDI: 0000000020000040
[   82.303852] RBP: 00007fff57b239b0 R08: 0000000000000000 R09: 0000000000000000
[   82.304898] R10: 0000000000000000 R11: 0000000000000246 R12: 00007fff57b23a28
[   82.306027] R13: 00007fff57b23a38 R14: 00007f3b42245d10 R15: 0000000000000001

VM DIAGNOSIS:
21:08:49  Registers:
info registers vcpu 0

CPU#0
RAX=dffffc0000000060 RBX=0000000000000005 RCX=0000000000000000 RDX=00000000000003fd
RSI=ffffffff823c0aec RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff88800b32f140
R8 =0000000000000001 R9 =0000000000000003 R10=000000000000001f R11=0000000000000001
R12=0000000000000000 R13=fffffbfff0f492a7 R14=fffffbfff0f4925e R15=dffffc0000000000
RIP=ffffffff823c0b14 RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00005555572cc380 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00005612682e2de8 CR3=000000000fb04000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 2e79616c7265766f 2e64657473757274
YMM01=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM02=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM03=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM04=0000000000000000 0000000000000000 00007f3b42239040 00007f3b4224ab60
YMM05=0000000000000000 0000000000000000 0000000000000001 0000000000000001
YMM06=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=ffffffff83eca430 RBX=ffff888008250000 RCX=ffffffff83eb246c RDX=ffff888008250000
RSI=0000000000000001 RDI=ffffffff83eca83f RBP=0000000000000001 RSP=ffff88800825fe78
R8 =0000000000000000 R9 =ffff88806cf3416b R10=ffffed100d9e682d R11=0000000000000001
R12=ffffed100104a000 R13=ffffffff85d66c08 R14=0000000000000000 R15=dffffc0000000000
RIP=ffffffff83eca43e RFL=00000246 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=1
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00005641f0a90000 CR3=000000000acbe000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 6576652d7372656b 726f772d6c6c696b
YMM02=0000000000000000 0000000000000000 0000000000000000 00000000000000ff
YMM03=0000000000000000 0000000000000000 696e656420737365 636341002f737973
YMM04=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM05=0000000000000000 0000000000000000 020101000000ffff 00000003ffffffff
YMM06=0000000000000000 0000000000000000 0000000700000003 0000561268301dd0
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 2064616572206f74 2064656c69614600
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
