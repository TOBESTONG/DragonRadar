Extracting prog: 26.911074978s
Minimizing prog: 10m47.754516352s
Simplifying prog options: 0s
Extracting C: 19.513496355s
Simplifying C: 1m51.91538084s


7 programs, timeouts [30s 1m40s 6m0s]
extracting reproducer from 7 programs
first checking the prog from the crash report
single: executing 1 programs separately with timeout 30s
testing program (duration=30s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$cgroup_ro-openat$dir-syz_mount_image$ext4-setregid-sendfile-newfstatat-socket$nl_generic-sendmsg$nl_generic-socket$inet6_udp-getsockopt$inet6_IPV6_FLOWLABEL_MGR-fchownat-clock_adjtime-lsetxattr$system_posix_acl-chdir-mkdir-epoll_create1
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
r1 = syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
r2 = openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000006ac0)='cpuacct.stat\x00', 0x275a, 0x0) (async, rerun: 64)
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000080)='ext3\x00', &(0x7f0000000480)='./file0\x00', 0xc0ed0806, &(0x7f0000000140)={[{@jqfmt_vfsold}, {@resgid={'resgid', 0x3d, 0xee00}}, {@bh}, {@noload}, {@data_err_ignore}, {@usrjquota}]}, 0xfe, 0x43e, &(0x7f00000004c0)="$eJzs3MtvG0UYAPBv7SR9k1DKo6WFQEFEPJImfdADFxBIHEBCgkMRp5CkVajboCZItIogcAhHVIk74ojEX8AJLgg4IXGFO6pUoVxaOBmtvZu6iZ3GiVOX7O8nbTvjHWvm292xZ2e8CaCwBtN/koi9EfFHRPTXs7cXGKz/d3NpfuKfpfmJJKrVt/9OauVuLM1P5EXz9+2pZ6rVLL+jSb2L70WMVypTl7L8yNyFD0dmL195YfrC+Lmpc1MXx06fPnH8SN+psZMdiTON68ahT2YOH3z93atvTpy5+v4v36Xt3Zvtb4yjUwbrR7eppztdWZfta0gnPV1sCG0pR0R6unpr/b8/yrFreV9/vPZ5VxsHbKlqtVpt9v2cWagC21gS3W4B0B35F316/5tvd2nocU+4/nL9BiiN+2a21ff0RCkr07vi/raTBiPizMK/X6dbbNE8BABAox/S8c/zzcZ/pXioodx92RrKQETcHxH7I+KBiDgQEQ9G1Mo+HBGPtFn/yhWS1eOf0rUNBbZO6fjvpWxt6/bxXz76i4FylttXi783OTtdmTqWHZOh6N2R5kfXqOPHV3//stW+xvFfuqX152PBrB3XelZM0E2Oz41vJuZG1z+LONTTLP4k8mWcJCIORsShDdYx/ey3h1vtu3P8a+jAOlP1m4hn6ud/IVbEn0tark+Ovnhq7OTIzqhMHRvJr4rVfv1t8a1W9W8q/g5Iz//uptf/cvwDyc6I2ctXztfWa2fbr2Pxzy9a3tNs9PrvS96ppfuy1z4en5u7NBrRl7yx+vWxW+/N83n5NP6ho837//64dSQejYj0Ij4SEY9FxONZ25+IiCcj4uga8f/8ylMftB//GrPyHZTGP3mn8x+N57/9RPn8T9+3H38uPf8naqmh7JX1fP6tt4GbOXYAAADwf1Gq/QY+KQ0vp0ul4eH6b/gPxO5SZWZ27rmzMx9dnKz/Vn4gekv5TFd/w3zoaDY3nOfHVuSPZ/PGX5V31fLDEzOVyW4HDwW3p0X/T/1V7nbrgC3neS0oLv0fikv/h+LS/6G49H8ormb9/9MutAO4+3z/Q3Hp/1Bc+j8Ul/4PhdTy2fjSph75l9j2iSjdE83Y/omedf8xiw0mdjTd1e1PJgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgM74LwAA//9wiOSH")
setregid(0x0, 0x0) (async)
sendfile(r1, r2, &(0x7f0000000980)=0x6, 0x8000000000000001)
newfstatat(0xffffffffffffff9c, &(0x7f0000000040)='./file0\x00', &(0x7f0000000080)={0x0, 0x0, 0x0, 0x0, <r3=>0x0}, 0x0) (async, rerun: 64)
r4 = socket$nl_generic(0x10, 0x3, 0x10) (rerun: 64)
sendmsg$nl_generic(r4, &(0x7f0000000940)={&(0x7f00000001c0)={0x10, 0x0, 0x0, 0x8000000}, 0xc, &(0x7f0000000900)={&(0x7f0000000200)={0x250, 0x38, 0x0, 0x70bd2b, 0x401, {0x1a}, [@generic="4a1d59ffe3318758eafccb9c7389980983c3486ed1ac17b17246a5", @generic, @nested={0x21d, 0x115, 0x0, 0x1, [@typed={0xc, 0x10f, 0x0, 0x0, @u64=0x401}, @typed={0x2f, 0xa8, 0x0, 0x0, @binary="b9ff8f6aa0f2545617a8e25db67ef524b1ae236b48e3a8dee73cf9268c4972a57fcef4fc3128c97b1de86e"}, @generic="f12b65f0432ff487f7ca3e219bc86f4fa611ae8109cb4d6967b264ef8031cb5a9555a53076aa23344477fbf4a89520129b1b26efc3482f3be0304658150450c855812a8b89e293b909bb9b73fe463361ec3d718dc8526c6e855e4bec1f9ae93d0e14e53b9c472483a293175c75d8de017798e2bdf48fbf5d45592063b0f90730f65fbd26a85300fbfd9eb9e2158adec3c5b552c553ceaf6543a538a81eada165f4a046cdabeb3a906c3f4f46af8816f0d9ed3baffbc7494928a61b28", @typed={0x14, 0x8d, 0x0, 0x0, @ipv6=@private0}, @generic="4390a0c48c7cfff61f3ff89968b905a33cc4d51f80788ea5956d61a0eb772e423296c72d44189806ffe3a3a5b43b9ea9dd65450d2d068f39a1bc0318acd7914582b40cd98ffd960713580005de14452663b1fed682c2eb713eee435566dc445975b4f5c062af35a6a19ff12aa158171d4f500a82e68fbe4d6f1b10f214a659842d158f2345a1fbfd14837a9b5541af1d5f2a54c117ba0249df530c4623946be0a88839d05cc5f55103b0ac5bac67fdc1f27003702e4060f829be43e56eeffc9fc22e4a7d386ba2abbb2a8e117fca2c5d975aba719046566b95044f13708b8702c1e6838bd9d11e637141cfca80318b1594", @typed={0x14, 0x37, 0x0, 0x0, @ipv6=@initdev={0xfe, 0x88, '\x00', 0x0, 0x0}}, @typed={0x8, 0x127, 0x0, 0x0, @u32=0x800000}]}]}, 0x250}, 0x1, 0x0, 0x0, 0x10}, 0x40) (async, rerun: 32)
r5 = socket$inet6_udp(0xa, 0x2, 0x0) (rerun: 32)
getsockopt$inet6_IPV6_FLOWLABEL_MGR(r5, 0x29, 0x20, 0x0, &(0x7f0000000140))
fchownat(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', r3, 0xffffffffffffffff, 0x0)
clock_adjtime(0x0, &(0x7f00000002c0)={0xfff, 0x0, 0x0, 0x0, 0x400, 0xe2c1, 0x1, 0x401, 0x0, 0x0, 0xd886, 0xff, 0x0, 0x7fffffff, 0x0, 0x2, 0x0, 0x8, 0x10000, 0xffffffff80000001, 0x8000, 0xe6e, 0x4, 0x0, 0x3, 0x2})
lsetxattr$system_posix_acl(&(0x7f0000000000)='./file0\x00', &(0x7f0000000100)='system.posix_acl_access\x00', &(0x7f0000001140)={{}, {0x1, 0x4}, [], {0x4, 0x2}, [], {0x10, 0x1}, {0x20, 0x4}}, 0x24, 0x2) (async)
chdir(&(0x7f0000000040)='./file0\x00') (async)
mkdir(&(0x7f00000000c0)='./bus\x00', 0x0) (async)
epoll_create1(0x80000)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
single: successfully extracted reproducer
found reproducer with 20 syscalls
minimizing guilty program
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$cgroup_ro-openat$dir-syz_mount_image$ext4-setregid-sendfile-newfstatat-socket$nl_generic-sendmsg$nl_generic-socket$inet6_udp-getsockopt$inet6_IPV6_FLOWLABEL_MGR-fchownat-clock_adjtime-lsetxattr$system_posix_acl-chdir-mkdir
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
r1 = syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
r2 = openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000006ac0)='cpuacct.stat\x00', 0x275a, 0x0) (async, rerun: 64)
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000080)='ext3\x00', &(0x7f0000000480)='./file0\x00', 0xc0ed0806, &(0x7f0000000140)={[{@jqfmt_vfsold}, {@resgid={'resgid', 0x3d, 0xee00}}, {@bh}, {@noload}, {@data_err_ignore}, {@usrjquota}]}, 0xfe, 0x43e, &(0x7f00000004c0)="$eJzs3MtvG0UYAPBv7SR9k1DKo6WFQEFEPJImfdADFxBIHEBCgkMRp5CkVajboCZItIogcAhHVIk74ojEX8AJLgg4IXGFO6pUoVxaOBmtvZu6iZ3GiVOX7O8nbTvjHWvm292xZ2e8CaCwBtN/koi9EfFHRPTXs7cXGKz/d3NpfuKfpfmJJKrVt/9OauVuLM1P5EXz9+2pZ6rVLL+jSb2L70WMVypTl7L8yNyFD0dmL195YfrC+Lmpc1MXx06fPnH8SN+psZMdiTON68ahT2YOH3z93atvTpy5+v4v36Xt3Zvtb4yjUwbrR7eppztdWZfta0gnPV1sCG0pR0R6unpr/b8/yrFreV9/vPZ5VxsHbKlqtVpt9v2cWagC21gS3W4B0B35F316/5tvd2nocU+4/nL9BiiN+2a21ff0RCkr07vi/raTBiPizMK/X6dbbNE8BABAox/S8c/zzcZ/pXioodx92RrKQETcHxH7I+KBiDgQEQ9G1Mo+HBGPtFn/yhWS1eOf0rUNBbZO6fjvpWxt6/bxXz76i4FylttXi783OTtdmTqWHZOh6N2R5kfXqOPHV3//stW+xvFfuqX152PBrB3XelZM0E2Oz41vJuZG1z+LONTTLP4k8mWcJCIORsShDdYx/ey3h1vtu3P8a+jAOlP1m4hn6ud/IVbEn0tark+Ovnhq7OTIzqhMHRvJr4rVfv1t8a1W9W8q/g5Iz//uptf/cvwDyc6I2ctXztfWa2fbr2Pxzy9a3tNs9PrvS96ppfuy1z4en5u7NBrRl7yx+vWxW+/N83n5NP6ho837//64dSQejYj0Ij4SEY9FxONZ25+IiCcj4uga8f/8ylMftB//GrPyHZTGP3mn8x+N57/9RPn8T9+3H38uPf8naqmh7JX1fP6tt4GbOXYAAADwf1Gq/QY+KQ0vp0ul4eH6b/gPxO5SZWZ27rmzMx9dnKz/Vn4gekv5TFd/w3zoaDY3nOfHVuSPZ/PGX5V31fLDEzOVyW4HDwW3p0X/T/1V7nbrgC3neS0oLv0fikv/h+LS/6G49H8ormb9/9MutAO4+3z/Q3Hp/1Bc+j8Ul/4PhdTy2fjSph75l9j2iSjdE83Y/omedf8xiw0mdjTd1e1PJgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgM74LwAA//9wiOSH")
setregid(0x0, 0x0) (async)
sendfile(r1, r2, &(0x7f0000000980)=0x6, 0x8000000000000001)
newfstatat(0xffffffffffffff9c, &(0x7f0000000040)='./file0\x00', &(0x7f0000000080)={0x0, 0x0, 0x0, 0x0, <r3=>0x0}, 0x0) (async, rerun: 64)
r4 = socket$nl_generic(0x10, 0x3, 0x10) (rerun: 64)
sendmsg$nl_generic(r4, &(0x7f0000000940)={&(0x7f00000001c0)={0x10, 0x0, 0x0, 0x8000000}, 0xc, &(0x7f0000000900)={&(0x7f0000000200)={0x250, 0x38, 0x0, 0x70bd2b, 0x401, {0x1a}, [@generic="4a1d59ffe3318758eafccb9c7389980983c3486ed1ac17b17246a5", @generic, @nested={0x21d, 0x115, 0x0, 0x1, [@typed={0xc, 0x10f, 0x0, 0x0, @u64=0x401}, @typed={0x2f, 0xa8, 0x0, 0x0, @binary="b9ff8f6aa0f2545617a8e25db67ef524b1ae236b48e3a8dee73cf9268c4972a57fcef4fc3128c97b1de86e"}, @generic="f12b65f0432ff487f7ca3e219bc86f4fa611ae8109cb4d6967b264ef8031cb5a9555a53076aa23344477fbf4a89520129b1b26efc3482f3be0304658150450c855812a8b89e293b909bb9b73fe463361ec3d718dc8526c6e855e4bec1f9ae93d0e14e53b9c472483a293175c75d8de017798e2bdf48fbf5d45592063b0f90730f65fbd26a85300fbfd9eb9e2158adec3c5b552c553ceaf6543a538a81eada165f4a046cdabeb3a906c3f4f46af8816f0d9ed3baffbc7494928a61b28", @typed={0x14, 0x8d, 0x0, 0x0, @ipv6=@private0}, @generic="4390a0c48c7cfff61f3ff89968b905a33cc4d51f80788ea5956d61a0eb772e423296c72d44189806ffe3a3a5b43b9ea9dd65450d2d068f39a1bc0318acd7914582b40cd98ffd960713580005de14452663b1fed682c2eb713eee435566dc445975b4f5c062af35a6a19ff12aa158171d4f500a82e68fbe4d6f1b10f214a659842d158f2345a1fbfd14837a9b5541af1d5f2a54c117ba0249df530c4623946be0a88839d05cc5f55103b0ac5bac67fdc1f27003702e4060f829be43e56eeffc9fc22e4a7d386ba2abbb2a8e117fca2c5d975aba719046566b95044f13708b8702c1e6838bd9d11e637141cfca80318b1594", @typed={0x14, 0x37, 0x0, 0x0, @ipv6=@initdev={0xfe, 0x88, '\x00', 0x0, 0x0}}, @typed={0x8, 0x127, 0x0, 0x0, @u32=0x800000}]}]}, 0x250}, 0x1, 0x0, 0x0, 0x10}, 0x40) (async, rerun: 32)
r5 = socket$inet6_udp(0xa, 0x2, 0x0) (rerun: 32)
getsockopt$inet6_IPV6_FLOWLABEL_MGR(r5, 0x29, 0x20, 0x0, &(0x7f0000000140))
fchownat(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', r3, 0xffffffffffffffff, 0x0)
clock_adjtime(0x0, &(0x7f00000002c0)={0xfff, 0x0, 0x0, 0x0, 0x400, 0xe2c1, 0x1, 0x401, 0x0, 0x0, 0xd886, 0xff, 0x0, 0x7fffffff, 0x0, 0x2, 0x0, 0x8, 0x10000, 0xffffffff80000001, 0x8000, 0xe6e, 0x4, 0x0, 0x3, 0x2})
lsetxattr$system_posix_acl(&(0x7f0000000000)='./file0\x00', &(0x7f0000000100)='system.posix_acl_access\x00', &(0x7f0000001140)={{}, {0x1, 0x4}, [], {0x4, 0x2}, [], {0x10, 0x1}, {0x20, 0x4}}, 0x24, 0x2) (async)
chdir(&(0x7f0000000040)='./file0\x00') (async)
mkdir(&(0x7f00000000c0)='./bus\x00', 0x0) (async)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$cgroup_ro-openat$dir-syz_mount_image$ext4-setregid-sendfile-newfstatat-socket$nl_generic-sendmsg$nl_generic-socket$inet6_udp-getsockopt$inet6_IPV6_FLOWLABEL_MGR-fchownat-clock_adjtime-lsetxattr$system_posix_acl-chdir
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
r1 = syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
r2 = openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000006ac0)='cpuacct.stat\x00', 0x275a, 0x0) (async, rerun: 64)
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000080)='ext3\x00', &(0x7f0000000480)='./file0\x00', 0xc0ed0806, &(0x7f0000000140)={[{@jqfmt_vfsold}, {@resgid={'resgid', 0x3d, 0xee00}}, {@bh}, {@noload}, {@data_err_ignore}, {@usrjquota}]}, 0xfe, 0x43e, &(0x7f00000004c0)="$eJzs3MtvG0UYAPBv7SR9k1DKo6WFQEFEPJImfdADFxBIHEBCgkMRp5CkVajboCZItIogcAhHVIk74ojEX8AJLgg4IXGFO6pUoVxaOBmtvZu6iZ3GiVOX7O8nbTvjHWvm292xZ2e8CaCwBtN/koi9EfFHRPTXs7cXGKz/d3NpfuKfpfmJJKrVt/9OauVuLM1P5EXz9+2pZ6rVLL+jSb2L70WMVypTl7L8yNyFD0dmL195YfrC+Lmpc1MXx06fPnH8SN+psZMdiTON68ahT2YOH3z93atvTpy5+v4v36Xt3Zvtb4yjUwbrR7eppztdWZfta0gnPV1sCG0pR0R6unpr/b8/yrFreV9/vPZ5VxsHbKlqtVpt9v2cWagC21gS3W4B0B35F316/5tvd2nocU+4/nL9BiiN+2a21ff0RCkr07vi/raTBiPizMK/X6dbbNE8BABAox/S8c/zzcZ/pXioodx92RrKQETcHxH7I+KBiDgQEQ9G1Mo+HBGPtFn/yhWS1eOf0rUNBbZO6fjvpWxt6/bxXz76i4FylttXi783OTtdmTqWHZOh6N2R5kfXqOPHV3//stW+xvFfuqX152PBrB3XelZM0E2Oz41vJuZG1z+LONTTLP4k8mWcJCIORsShDdYx/ey3h1vtu3P8a+jAOlP1m4hn6ud/IVbEn0tark+Ovnhq7OTIzqhMHRvJr4rVfv1t8a1W9W8q/g5Iz//uptf/cvwDyc6I2ctXztfWa2fbr2Pxzy9a3tNs9PrvS96ppfuy1z4en5u7NBrRl7yx+vWxW+/N83n5NP6ho837//64dSQejYj0Ij4SEY9FxONZ25+IiCcj4uga8f/8ylMftB//GrPyHZTGP3mn8x+N57/9RPn8T9+3H38uPf8naqmh7JX1fP6tt4GbOXYAAADwf1Gq/QY+KQ0vp0ul4eH6b/gPxO5SZWZ27rmzMx9dnKz/Vn4gekv5TFd/w3zoaDY3nOfHVuSPZ/PGX5V31fLDEzOVyW4HDwW3p0X/T/1V7nbrgC3neS0oLv0fikv/h+LS/6G49H8ormb9/9MutAO4+3z/Q3Hp/1Bc+j8Ul/4PhdTy2fjSph75l9j2iSjdE83Y/omedf8xiw0mdjTd1e1PJgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgM74LwAA//9wiOSH")
setregid(0x0, 0x0) (async)
sendfile(r1, r2, &(0x7f0000000980)=0x6, 0x8000000000000001)
newfstatat(0xffffffffffffff9c, &(0x7f0000000040)='./file0\x00', &(0x7f0000000080)={0x0, 0x0, 0x0, 0x0, <r3=>0x0}, 0x0) (async, rerun: 64)
r4 = socket$nl_generic(0x10, 0x3, 0x10) (rerun: 64)
sendmsg$nl_generic(r4, &(0x7f0000000940)={&(0x7f00000001c0)={0x10, 0x0, 0x0, 0x8000000}, 0xc, &(0x7f0000000900)={&(0x7f0000000200)={0x250, 0x38, 0x0, 0x70bd2b, 0x401, {0x1a}, [@generic="4a1d59ffe3318758eafccb9c7389980983c3486ed1ac17b17246a5", @generic, @nested={0x21d, 0x115, 0x0, 0x1, [@typed={0xc, 0x10f, 0x0, 0x0, @u64=0x401}, @typed={0x2f, 0xa8, 0x0, 0x0, @binary="b9ff8f6aa0f2545617a8e25db67ef524b1ae236b48e3a8dee73cf9268c4972a57fcef4fc3128c97b1de86e"}, @generic="f12b65f0432ff487f7ca3e219bc86f4fa611ae8109cb4d6967b264ef8031cb5a9555a53076aa23344477fbf4a89520129b1b26efc3482f3be0304658150450c855812a8b89e293b909bb9b73fe463361ec3d718dc8526c6e855e4bec1f9ae93d0e14e53b9c472483a293175c75d8de017798e2bdf48fbf5d45592063b0f90730f65fbd26a85300fbfd9eb9e2158adec3c5b552c553ceaf6543a538a81eada165f4a046cdabeb3a906c3f4f46af8816f0d9ed3baffbc7494928a61b28", @typed={0x14, 0x8d, 0x0, 0x0, @ipv6=@private0}, @generic="4390a0c48c7cfff61f3ff89968b905a33cc4d51f80788ea5956d61a0eb772e423296c72d44189806ffe3a3a5b43b9ea9dd65450d2d068f39a1bc0318acd7914582b40cd98ffd960713580005de14452663b1fed682c2eb713eee435566dc445975b4f5c062af35a6a19ff12aa158171d4f500a82e68fbe4d6f1b10f214a659842d158f2345a1fbfd14837a9b5541af1d5f2a54c117ba0249df530c4623946be0a88839d05cc5f55103b0ac5bac67fdc1f27003702e4060f829be43e56eeffc9fc22e4a7d386ba2abbb2a8e117fca2c5d975aba719046566b95044f13708b8702c1e6838bd9d11e637141cfca80318b1594", @typed={0x14, 0x37, 0x0, 0x0, @ipv6=@initdev={0xfe, 0x88, '\x00', 0x0, 0x0}}, @typed={0x8, 0x127, 0x0, 0x0, @u32=0x800000}]}]}, 0x250}, 0x1, 0x0, 0x0, 0x10}, 0x40) (async, rerun: 32)
r5 = socket$inet6_udp(0xa, 0x2, 0x0) (rerun: 32)
getsockopt$inet6_IPV6_FLOWLABEL_MGR(r5, 0x29, 0x20, 0x0, &(0x7f0000000140))
fchownat(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', r3, 0xffffffffffffffff, 0x0)
clock_adjtime(0x0, &(0x7f00000002c0)={0xfff, 0x0, 0x0, 0x0, 0x400, 0xe2c1, 0x1, 0x401, 0x0, 0x0, 0xd886, 0xff, 0x0, 0x7fffffff, 0x0, 0x2, 0x0, 0x8, 0x10000, 0xffffffff80000001, 0x8000, 0xe6e, 0x4, 0x0, 0x3, 0x2})
lsetxattr$system_posix_acl(&(0x7f0000000000)='./file0\x00', &(0x7f0000000100)='system.posix_acl_access\x00', &(0x7f0000001140)={{}, {0x1, 0x4}, [], {0x4, 0x2}, [], {0x10, 0x1}, {0x20, 0x4}}, 0x24, 0x2) (async)
chdir(&(0x7f0000000040)='./file0\x00') (async)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$cgroup_ro-openat$dir-syz_mount_image$ext4-setregid-sendfile-newfstatat-socket$nl_generic-sendmsg$nl_generic-socket$inet6_udp-getsockopt$inet6_IPV6_FLOWLABEL_MGR-fchownat-clock_adjtime-lsetxattr$system_posix_acl
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
r1 = syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
r2 = openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000006ac0)='cpuacct.stat\x00', 0x275a, 0x0) (async, rerun: 64)
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000080)='ext3\x00', &(0x7f0000000480)='./file0\x00', 0xc0ed0806, &(0x7f0000000140)={[{@jqfmt_vfsold}, {@resgid={'resgid', 0x3d, 0xee00}}, {@bh}, {@noload}, {@data_err_ignore}, {@usrjquota}]}, 0xfe, 0x43e, &(0x7f00000004c0)="$eJzs3MtvG0UYAPBv7SR9k1DKo6WFQEFEPJImfdADFxBIHEBCgkMRp5CkVajboCZItIogcAhHVIk74ojEX8AJLgg4IXGFO6pUoVxaOBmtvZu6iZ3GiVOX7O8nbTvjHWvm292xZ2e8CaCwBtN/koi9EfFHRPTXs7cXGKz/d3NpfuKfpfmJJKrVt/9OauVuLM1P5EXz9+2pZ6rVLL+jSb2L70WMVypTl7L8yNyFD0dmL195YfrC+Lmpc1MXx06fPnH8SN+psZMdiTON68ahT2YOH3z93atvTpy5+v4v36Xt3Zvtb4yjUwbrR7eppztdWZfta0gnPV1sCG0pR0R6unpr/b8/yrFreV9/vPZ5VxsHbKlqtVpt9v2cWagC21gS3W4B0B35F316/5tvd2nocU+4/nL9BiiN+2a21ff0RCkr07vi/raTBiPizMK/X6dbbNE8BABAox/S8c/zzcZ/pXioodx92RrKQETcHxH7I+KBiDgQEQ9G1Mo+HBGPtFn/yhWS1eOf0rUNBbZO6fjvpWxt6/bxXz76i4FylttXi783OTtdmTqWHZOh6N2R5kfXqOPHV3//stW+xvFfuqX152PBrB3XelZM0E2Oz41vJuZG1z+LONTTLP4k8mWcJCIORsShDdYx/ey3h1vtu3P8a+jAOlP1m4hn6ud/IVbEn0tark+Ovnhq7OTIzqhMHRvJr4rVfv1t8a1W9W8q/g5Iz//uptf/cvwDyc6I2ctXztfWa2fbr2Pxzy9a3tNs9PrvS96ppfuy1z4en5u7NBrRl7yx+vWxW+/N83n5NP6ho837//64dSQejYj0Ij4SEY9FxONZ25+IiCcj4uga8f/8ylMftB//GrPyHZTGP3mn8x+N57/9RPn8T9+3H38uPf8naqmh7JX1fP6tt4GbOXYAAADwf1Gq/QY+KQ0vp0ul4eH6b/gPxO5SZWZ27rmzMx9dnKz/Vn4gekv5TFd/w3zoaDY3nOfHVuSPZ/PGX5V31fLDEzOVyW4HDwW3p0X/T/1V7nbrgC3neS0oLv0fikv/h+LS/6G49H8ormb9/9MutAO4+3z/Q3Hp/1Bc+j8Ul/4PhdTy2fjSph75l9j2iSjdE83Y/omedf8xiw0mdjTd1e1PJgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgM74LwAA//9wiOSH")
setregid(0x0, 0x0) (async)
sendfile(r1, r2, &(0x7f0000000980)=0x6, 0x8000000000000001)
newfstatat(0xffffffffffffff9c, &(0x7f0000000040)='./file0\x00', &(0x7f0000000080)={0x0, 0x0, 0x0, 0x0, <r3=>0x0}, 0x0) (async, rerun: 64)
r4 = socket$nl_generic(0x10, 0x3, 0x10) (rerun: 64)
sendmsg$nl_generic(r4, &(0x7f0000000940)={&(0x7f00000001c0)={0x10, 0x0, 0x0, 0x8000000}, 0xc, &(0x7f0000000900)={&(0x7f0000000200)={0x250, 0x38, 0x0, 0x70bd2b, 0x401, {0x1a}, [@generic="4a1d59ffe3318758eafccb9c7389980983c3486ed1ac17b17246a5", @generic, @nested={0x21d, 0x115, 0x0, 0x1, [@typed={0xc, 0x10f, 0x0, 0x0, @u64=0x401}, @typed={0x2f, 0xa8, 0x0, 0x0, @binary="b9ff8f6aa0f2545617a8e25db67ef524b1ae236b48e3a8dee73cf9268c4972a57fcef4fc3128c97b1de86e"}, @generic="f12b65f0432ff487f7ca3e219bc86f4fa611ae8109cb4d6967b264ef8031cb5a9555a53076aa23344477fbf4a89520129b1b26efc3482f3be0304658150450c855812a8b89e293b909bb9b73fe463361ec3d718dc8526c6e855e4bec1f9ae93d0e14e53b9c472483a293175c75d8de017798e2bdf48fbf5d45592063b0f90730f65fbd26a85300fbfd9eb9e2158adec3c5b552c553ceaf6543a538a81eada165f4a046cdabeb3a906c3f4f46af8816f0d9ed3baffbc7494928a61b28", @typed={0x14, 0x8d, 0x0, 0x0, @ipv6=@private0}, @generic="4390a0c48c7cfff61f3ff89968b905a33cc4d51f80788ea5956d61a0eb772e423296c72d44189806ffe3a3a5b43b9ea9dd65450d2d068f39a1bc0318acd7914582b40cd98ffd960713580005de14452663b1fed682c2eb713eee435566dc445975b4f5c062af35a6a19ff12aa158171d4f500a82e68fbe4d6f1b10f214a659842d158f2345a1fbfd14837a9b5541af1d5f2a54c117ba0249df530c4623946be0a88839d05cc5f55103b0ac5bac67fdc1f27003702e4060f829be43e56eeffc9fc22e4a7d386ba2abbb2a8e117fca2c5d975aba719046566b95044f13708b8702c1e6838bd9d11e637141cfca80318b1594", @typed={0x14, 0x37, 0x0, 0x0, @ipv6=@initdev={0xfe, 0x88, '\x00', 0x0, 0x0}}, @typed={0x8, 0x127, 0x0, 0x0, @u32=0x800000}]}]}, 0x250}, 0x1, 0x0, 0x0, 0x10}, 0x40) (async, rerun: 32)
r5 = socket$inet6_udp(0xa, 0x2, 0x0) (rerun: 32)
getsockopt$inet6_IPV6_FLOWLABEL_MGR(r5, 0x29, 0x20, 0x0, &(0x7f0000000140))
fchownat(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', r3, 0xffffffffffffffff, 0x0)
clock_adjtime(0x0, &(0x7f00000002c0)={0xfff, 0x0, 0x0, 0x0, 0x400, 0xe2c1, 0x1, 0x401, 0x0, 0x0, 0xd886, 0xff, 0x0, 0x7fffffff, 0x0, 0x2, 0x0, 0x8, 0x10000, 0xffffffff80000001, 0x8000, 0xe6e, 0x4, 0x0, 0x3, 0x2})
lsetxattr$system_posix_acl(&(0x7f0000000000)='./file0\x00', &(0x7f0000000100)='system.posix_acl_access\x00', &(0x7f0000001140)={{}, {0x1, 0x4}, [], {0x4, 0x2}, [], {0x10, 0x1}, {0x20, 0x4}}, 0x24, 0x2) (async)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$cgroup_ro-openat$dir-syz_mount_image$ext4-setregid-sendfile-newfstatat-socket$nl_generic-sendmsg$nl_generic-socket$inet6_udp-getsockopt$inet6_IPV6_FLOWLABEL_MGR-fchownat-clock_adjtime
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
r1 = syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
r2 = openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000006ac0)='cpuacct.stat\x00', 0x275a, 0x0) (async, rerun: 64)
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000080)='ext3\x00', &(0x7f0000000480)='./file0\x00', 0xc0ed0806, &(0x7f0000000140)={[{@jqfmt_vfsold}, {@resgid={'resgid', 0x3d, 0xee00}}, {@bh}, {@noload}, {@data_err_ignore}, {@usrjquota}]}, 0xfe, 0x43e, &(0x7f00000004c0)="$eJzs3MtvG0UYAPBv7SR9k1DKo6WFQEFEPJImfdADFxBIHEBCgkMRp5CkVajboCZItIogcAhHVIk74ojEX8AJLgg4IXGFO6pUoVxaOBmtvZu6iZ3GiVOX7O8nbTvjHWvm292xZ2e8CaCwBtN/koi9EfFHRPTXs7cXGKz/d3NpfuKfpfmJJKrVt/9OauVuLM1P5EXz9+2pZ6rVLL+jSb2L70WMVypTl7L8yNyFD0dmL195YfrC+Lmpc1MXx06fPnH8SN+psZMdiTON68ahT2YOH3z93atvTpy5+v4v36Xt3Zvtb4yjUwbrR7eppztdWZfta0gnPV1sCG0pR0R6unpr/b8/yrFreV9/vPZ5VxsHbKlqtVpt9v2cWagC21gS3W4B0B35F316/5tvd2nocU+4/nL9BiiN+2a21ff0RCkr07vi/raTBiPizMK/X6dbbNE8BABAox/S8c/zzcZ/pXioodx92RrKQETcHxH7I+KBiDgQEQ9G1Mo+HBGPtFn/yhWS1eOf0rUNBbZO6fjvpWxt6/bxXz76i4FylttXi783OTtdmTqWHZOh6N2R5kfXqOPHV3//stW+xvFfuqX152PBrB3XelZM0E2Oz41vJuZG1z+LONTTLP4k8mWcJCIORsShDdYx/ey3h1vtu3P8a+jAOlP1m4hn6ud/IVbEn0tark+Ovnhq7OTIzqhMHRvJr4rVfv1t8a1W9W8q/g5Iz//uptf/cvwDyc6I2ctXztfWa2fbr2Pxzy9a3tNs9PrvS96ppfuy1z4en5u7NBrRl7yx+vWxW+/N83n5NP6ho837//64dSQejYj0Ij4SEY9FxONZ25+IiCcj4uga8f/8ylMftB//GrPyHZTGP3mn8x+N57/9RPn8T9+3H38uPf8naqmh7JX1fP6tt4GbOXYAAADwf1Gq/QY+KQ0vp0ul4eH6b/gPxO5SZWZ27rmzMx9dnKz/Vn4gekv5TFd/w3zoaDY3nOfHVuSPZ/PGX5V31fLDEzOVyW4HDwW3p0X/T/1V7nbrgC3neS0oLv0fikv/h+LS/6G49H8ormb9/9MutAO4+3z/Q3Hp/1Bc+j8Ul/4PhdTy2fjSph75l9j2iSjdE83Y/omedf8xiw0mdjTd1e1PJgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgM74LwAA//9wiOSH")
setregid(0x0, 0x0) (async)
sendfile(r1, r2, &(0x7f0000000980)=0x6, 0x8000000000000001)
newfstatat(0xffffffffffffff9c, &(0x7f0000000040)='./file0\x00', &(0x7f0000000080)={0x0, 0x0, 0x0, 0x0, <r3=>0x0}, 0x0) (async, rerun: 64)
r4 = socket$nl_generic(0x10, 0x3, 0x10) (rerun: 64)
sendmsg$nl_generic(r4, &(0x7f0000000940)={&(0x7f00000001c0)={0x10, 0x0, 0x0, 0x8000000}, 0xc, &(0x7f0000000900)={&(0x7f0000000200)={0x250, 0x38, 0x0, 0x70bd2b, 0x401, {0x1a}, [@generic="4a1d59ffe3318758eafccb9c7389980983c3486ed1ac17b17246a5", @generic, @nested={0x21d, 0x115, 0x0, 0x1, [@typed={0xc, 0x10f, 0x0, 0x0, @u64=0x401}, @typed={0x2f, 0xa8, 0x0, 0x0, @binary="b9ff8f6aa0f2545617a8e25db67ef524b1ae236b48e3a8dee73cf9268c4972a57fcef4fc3128c97b1de86e"}, @generic="f12b65f0432ff487f7ca3e219bc86f4fa611ae8109cb4d6967b264ef8031cb5a9555a53076aa23344477fbf4a89520129b1b26efc3482f3be0304658150450c855812a8b89e293b909bb9b73fe463361ec3d718dc8526c6e855e4bec1f9ae93d0e14e53b9c472483a293175c75d8de017798e2bdf48fbf5d45592063b0f90730f65fbd26a85300fbfd9eb9e2158adec3c5b552c553ceaf6543a538a81eada165f4a046cdabeb3a906c3f4f46af8816f0d9ed3baffbc7494928a61b28", @typed={0x14, 0x8d, 0x0, 0x0, @ipv6=@private0}, @generic="4390a0c48c7cfff61f3ff89968b905a33cc4d51f80788ea5956d61a0eb772e423296c72d44189806ffe3a3a5b43b9ea9dd65450d2d068f39a1bc0318acd7914582b40cd98ffd960713580005de14452663b1fed682c2eb713eee435566dc445975b4f5c062af35a6a19ff12aa158171d4f500a82e68fbe4d6f1b10f214a659842d158f2345a1fbfd14837a9b5541af1d5f2a54c117ba0249df530c4623946be0a88839d05cc5f55103b0ac5bac67fdc1f27003702e4060f829be43e56eeffc9fc22e4a7d386ba2abbb2a8e117fca2c5d975aba719046566b95044f13708b8702c1e6838bd9d11e637141cfca80318b1594", @typed={0x14, 0x37, 0x0, 0x0, @ipv6=@initdev={0xfe, 0x88, '\x00', 0x0, 0x0}}, @typed={0x8, 0x127, 0x0, 0x0, @u32=0x800000}]}]}, 0x250}, 0x1, 0x0, 0x0, 0x10}, 0x40) (async, rerun: 32)
r5 = socket$inet6_udp(0xa, 0x2, 0x0) (rerun: 32)
getsockopt$inet6_IPV6_FLOWLABEL_MGR(r5, 0x29, 0x20, 0x0, &(0x7f0000000140))
fchownat(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', r3, 0xffffffffffffffff, 0x0)
clock_adjtime(0x0, &(0x7f00000002c0)={0xfff, 0x0, 0x0, 0x0, 0x400, 0xe2c1, 0x1, 0x401, 0x0, 0x0, 0xd886, 0xff, 0x0, 0x7fffffff, 0x0, 0x2, 0x0, 0x8, 0x10000, 0xffffffff80000001, 0x8000, 0xe6e, 0x4, 0x0, 0x3, 0x2})

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$cgroup_ro-openat$dir-syz_mount_image$ext4-setregid-sendfile-newfstatat-socket$nl_generic-sendmsg$nl_generic-socket$inet6_udp-getsockopt$inet6_IPV6_FLOWLABEL_MGR-fchownat
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
r1 = syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
r2 = openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000006ac0)='cpuacct.stat\x00', 0x275a, 0x0) (async, rerun: 64)
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000080)='ext3\x00', &(0x7f0000000480)='./file0\x00', 0xc0ed0806, &(0x7f0000000140)={[{@jqfmt_vfsold}, {@resgid={'resgid', 0x3d, 0xee00}}, {@bh}, {@noload}, {@data_err_ignore}, {@usrjquota}]}, 0xfe, 0x43e, &(0x7f00000004c0)="$eJzs3MtvG0UYAPBv7SR9k1DKo6WFQEFEPJImfdADFxBIHEBCgkMRp5CkVajboCZItIogcAhHVIk74ojEX8AJLgg4IXGFO6pUoVxaOBmtvZu6iZ3GiVOX7O8nbTvjHWvm292xZ2e8CaCwBtN/koi9EfFHRPTXs7cXGKz/d3NpfuKfpfmJJKrVt/9OauVuLM1P5EXz9+2pZ6rVLL+jSb2L70WMVypTl7L8yNyFD0dmL195YfrC+Lmpc1MXx06fPnH8SN+psZMdiTON68ahT2YOH3z93atvTpy5+v4v36Xt3Zvtb4yjUwbrR7eppztdWZfta0gnPV1sCG0pR0R6unpr/b8/yrFreV9/vPZ5VxsHbKlqtVpt9v2cWagC21gS3W4B0B35F316/5tvd2nocU+4/nL9BiiN+2a21ff0RCkr07vi/raTBiPizMK/X6dbbNE8BABAox/S8c/zzcZ/pXioodx92RrKQETcHxH7I+KBiDgQEQ9G1Mo+HBGPtFn/yhWS1eOf0rUNBbZO6fjvpWxt6/bxXz76i4FylttXi783OTtdmTqWHZOh6N2R5kfXqOPHV3//stW+xvFfuqX152PBrB3XelZM0E2Oz41vJuZG1z+LONTTLP4k8mWcJCIORsShDdYx/ey3h1vtu3P8a+jAOlP1m4hn6ud/IVbEn0tark+Ovnhq7OTIzqhMHRvJr4rVfv1t8a1W9W8q/g5Iz//uptf/cvwDyc6I2ctXztfWa2fbr2Pxzy9a3tNs9PrvS96ppfuy1z4en5u7NBrRl7yx+vWxW+/N83n5NP6ho837//64dSQejYj0Ij4SEY9FxONZ25+IiCcj4uga8f/8ylMftB//GrPyHZTGP3mn8x+N57/9RPn8T9+3H38uPf8naqmh7JX1fP6tt4GbOXYAAADwf1Gq/QY+KQ0vp0ul4eH6b/gPxO5SZWZ27rmzMx9dnKz/Vn4gekv5TFd/w3zoaDY3nOfHVuSPZ/PGX5V31fLDEzOVyW4HDwW3p0X/T/1V7nbrgC3neS0oLv0fikv/h+LS/6G49H8ormb9/9MutAO4+3z/Q3Hp/1Bc+j8Ul/4PhdTy2fjSph75l9j2iSjdE83Y/omedf8xiw0mdjTd1e1PJgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgM74LwAA//9wiOSH")
setregid(0x0, 0x0) (async)
sendfile(r1, r2, &(0x7f0000000980)=0x6, 0x8000000000000001)
newfstatat(0xffffffffffffff9c, &(0x7f0000000040)='./file0\x00', &(0x7f0000000080)={0x0, 0x0, 0x0, 0x0, <r3=>0x0}, 0x0) (async, rerun: 64)
r4 = socket$nl_generic(0x10, 0x3, 0x10) (rerun: 64)
sendmsg$nl_generic(r4, &(0x7f0000000940)={&(0x7f00000001c0)={0x10, 0x0, 0x0, 0x8000000}, 0xc, &(0x7f0000000900)={&(0x7f0000000200)={0x250, 0x38, 0x0, 0x70bd2b, 0x401, {0x1a}, [@generic="4a1d59ffe3318758eafccb9c7389980983c3486ed1ac17b17246a5", @generic, @nested={0x21d, 0x115, 0x0, 0x1, [@typed={0xc, 0x10f, 0x0, 0x0, @u64=0x401}, @typed={0x2f, 0xa8, 0x0, 0x0, @binary="b9ff8f6aa0f2545617a8e25db67ef524b1ae236b48e3a8dee73cf9268c4972a57fcef4fc3128c97b1de86e"}, @generic="f12b65f0432ff487f7ca3e219bc86f4fa611ae8109cb4d6967b264ef8031cb5a9555a53076aa23344477fbf4a89520129b1b26efc3482f3be0304658150450c855812a8b89e293b909bb9b73fe463361ec3d718dc8526c6e855e4bec1f9ae93d0e14e53b9c472483a293175c75d8de017798e2bdf48fbf5d45592063b0f90730f65fbd26a85300fbfd9eb9e2158adec3c5b552c553ceaf6543a538a81eada165f4a046cdabeb3a906c3f4f46af8816f0d9ed3baffbc7494928a61b28", @typed={0x14, 0x8d, 0x0, 0x0, @ipv6=@private0}, @generic="4390a0c48c7cfff61f3ff89968b905a33cc4d51f80788ea5956d61a0eb772e423296c72d44189806ffe3a3a5b43b9ea9dd65450d2d068f39a1bc0318acd7914582b40cd98ffd960713580005de14452663b1fed682c2eb713eee435566dc445975b4f5c062af35a6a19ff12aa158171d4f500a82e68fbe4d6f1b10f214a659842d158f2345a1fbfd14837a9b5541af1d5f2a54c117ba0249df530c4623946be0a88839d05cc5f55103b0ac5bac67fdc1f27003702e4060f829be43e56eeffc9fc22e4a7d386ba2abbb2a8e117fca2c5d975aba719046566b95044f13708b8702c1e6838bd9d11e637141cfca80318b1594", @typed={0x14, 0x37, 0x0, 0x0, @ipv6=@initdev={0xfe, 0x88, '\x00', 0x0, 0x0}}, @typed={0x8, 0x127, 0x0, 0x0, @u32=0x800000}]}]}, 0x250}, 0x1, 0x0, 0x0, 0x10}, 0x40) (async, rerun: 32)
r5 = socket$inet6_udp(0xa, 0x2, 0x0) (rerun: 32)
getsockopt$inet6_IPV6_FLOWLABEL_MGR(r5, 0x29, 0x20, 0x0, &(0x7f0000000140))
fchownat(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', r3, 0xffffffffffffffff, 0x0)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$cgroup_ro-openat$dir-syz_mount_image$ext4-setregid-sendfile-newfstatat-socket$nl_generic-sendmsg$nl_generic-socket$inet6_udp-getsockopt$inet6_IPV6_FLOWLABEL_MGR
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
r1 = syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
r2 = openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000006ac0)='cpuacct.stat\x00', 0x275a, 0x0) (async, rerun: 64)
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000080)='ext3\x00', &(0x7f0000000480)='./file0\x00', 0xc0ed0806, &(0x7f0000000140)={[{@jqfmt_vfsold}, {@resgid={'resgid', 0x3d, 0xee00}}, {@bh}, {@noload}, {@data_err_ignore}, {@usrjquota}]}, 0xfe, 0x43e, &(0x7f00000004c0)="$eJzs3MtvG0UYAPBv7SR9k1DKo6WFQEFEPJImfdADFxBIHEBCgkMRp5CkVajboCZItIogcAhHVIk74ojEX8AJLgg4IXGFO6pUoVxaOBmtvZu6iZ3GiVOX7O8nbTvjHWvm292xZ2e8CaCwBtN/koi9EfFHRPTXs7cXGKz/d3NpfuKfpfmJJKrVt/9OauVuLM1P5EXz9+2pZ6rVLL+jSb2L70WMVypTl7L8yNyFD0dmL195YfrC+Lmpc1MXx06fPnH8SN+psZMdiTON68ahT2YOH3z93atvTpy5+v4v36Xt3Zvtb4yjUwbrR7eppztdWZfta0gnPV1sCG0pR0R6unpr/b8/yrFreV9/vPZ5VxsHbKlqtVpt9v2cWagC21gS3W4B0B35F316/5tvd2nocU+4/nL9BiiN+2a21ff0RCkr07vi/raTBiPizMK/X6dbbNE8BABAox/S8c/zzcZ/pXioodx92RrKQETcHxH7I+KBiDgQEQ9G1Mo+HBGPtFn/yhWS1eOf0rUNBbZO6fjvpWxt6/bxXz76i4FylttXi783OTtdmTqWHZOh6N2R5kfXqOPHV3//stW+xvFfuqX152PBrB3XelZM0E2Oz41vJuZG1z+LONTTLP4k8mWcJCIORsShDdYx/ey3h1vtu3P8a+jAOlP1m4hn6ud/IVbEn0tark+Ovnhq7OTIzqhMHRvJr4rVfv1t8a1W9W8q/g5Iz//uptf/cvwDyc6I2ctXztfWa2fbr2Pxzy9a3tNs9PrvS96ppfuy1z4en5u7NBrRl7yx+vWxW+/N83n5NP6ho837//64dSQejYj0Ij4SEY9FxONZ25+IiCcj4uga8f/8ylMftB//GrPyHZTGP3mn8x+N57/9RPn8T9+3H38uPf8naqmh7JX1fP6tt4GbOXYAAADwf1Gq/QY+KQ0vp0ul4eH6b/gPxO5SZWZ27rmzMx9dnKz/Vn4gekv5TFd/w3zoaDY3nOfHVuSPZ/PGX5V31fLDEzOVyW4HDwW3p0X/T/1V7nbrgC3neS0oLv0fikv/h+LS/6G49H8ormb9/9MutAO4+3z/Q3Hp/1Bc+j8Ul/4PhdTy2fjSph75l9j2iSjdE83Y/omedf8xiw0mdjTd1e1PJgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgM74LwAA//9wiOSH")
setregid(0x0, 0x0) (async)
sendfile(r1, r2, &(0x7f0000000980)=0x6, 0x8000000000000001)
newfstatat(0xffffffffffffff9c, &(0x7f0000000040)='./file0\x00', &(0x7f0000000080), 0x0) (async, rerun: 64)
r3 = socket$nl_generic(0x10, 0x3, 0x10) (rerun: 64)
sendmsg$nl_generic(r3, &(0x7f0000000940)={&(0x7f00000001c0)={0x10, 0x0, 0x0, 0x8000000}, 0xc, &(0x7f0000000900)={&(0x7f0000000200)={0x250, 0x38, 0x0, 0x70bd2b, 0x401, {0x1a}, [@generic="4a1d59ffe3318758eafccb9c7389980983c3486ed1ac17b17246a5", @generic, @nested={0x21d, 0x115, 0x0, 0x1, [@typed={0xc, 0x10f, 0x0, 0x0, @u64=0x401}, @typed={0x2f, 0xa8, 0x0, 0x0, @binary="b9ff8f6aa0f2545617a8e25db67ef524b1ae236b48e3a8dee73cf9268c4972a57fcef4fc3128c97b1de86e"}, @generic="f12b65f0432ff487f7ca3e219bc86f4fa611ae8109cb4d6967b264ef8031cb5a9555a53076aa23344477fbf4a89520129b1b26efc3482f3be0304658150450c855812a8b89e293b909bb9b73fe463361ec3d718dc8526c6e855e4bec1f9ae93d0e14e53b9c472483a293175c75d8de017798e2bdf48fbf5d45592063b0f90730f65fbd26a85300fbfd9eb9e2158adec3c5b552c553ceaf6543a538a81eada165f4a046cdabeb3a906c3f4f46af8816f0d9ed3baffbc7494928a61b28", @typed={0x14, 0x8d, 0x0, 0x0, @ipv6=@private0}, @generic="4390a0c48c7cfff61f3ff89968b905a33cc4d51f80788ea5956d61a0eb772e423296c72d44189806ffe3a3a5b43b9ea9dd65450d2d068f39a1bc0318acd7914582b40cd98ffd960713580005de14452663b1fed682c2eb713eee435566dc445975b4f5c062af35a6a19ff12aa158171d4f500a82e68fbe4d6f1b10f214a659842d158f2345a1fbfd14837a9b5541af1d5f2a54c117ba0249df530c4623946be0a88839d05cc5f55103b0ac5bac67fdc1f27003702e4060f829be43e56eeffc9fc22e4a7d386ba2abbb2a8e117fca2c5d975aba719046566b95044f13708b8702c1e6838bd9d11e637141cfca80318b1594", @typed={0x14, 0x37, 0x0, 0x0, @ipv6=@initdev={0xfe, 0x88, '\x00', 0x0, 0x0}}, @typed={0x8, 0x127, 0x0, 0x0, @u32=0x800000}]}]}, 0x250}, 0x1, 0x0, 0x0, 0x10}, 0x40) (async, rerun: 32)
r4 = socket$inet6_udp(0xa, 0x2, 0x0) (rerun: 32)
getsockopt$inet6_IPV6_FLOWLABEL_MGR(r4, 0x29, 0x20, 0x0, &(0x7f0000000140))

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$cgroup_ro-openat$dir-syz_mount_image$ext4-setregid-sendfile-newfstatat-socket$nl_generic-sendmsg$nl_generic-socket$inet6_udp
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
r1 = syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
r2 = openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000006ac0)='cpuacct.stat\x00', 0x275a, 0x0) (async, rerun: 64)
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000080)='ext3\x00', &(0x7f0000000480)='./file0\x00', 0xc0ed0806, &(0x7f0000000140)={[{@jqfmt_vfsold}, {@resgid={'resgid', 0x3d, 0xee00}}, {@bh}, {@noload}, {@data_err_ignore}, {@usrjquota}]}, 0xfe, 0x43e, &(0x7f00000004c0)="$eJzs3MtvG0UYAPBv7SR9k1DKo6WFQEFEPJImfdADFxBIHEBCgkMRp5CkVajboCZItIogcAhHVIk74ojEX8AJLgg4IXGFO6pUoVxaOBmtvZu6iZ3GiVOX7O8nbTvjHWvm292xZ2e8CaCwBtN/koi9EfFHRPTXs7cXGKz/d3NpfuKfpfmJJKrVt/9OauVuLM1P5EXz9+2pZ6rVLL+jSb2L70WMVypTl7L8yNyFD0dmL195YfrC+Lmpc1MXx06fPnH8SN+psZMdiTON68ahT2YOH3z93atvTpy5+v4v36Xt3Zvtb4yjUwbrR7eppztdWZfta0gnPV1sCG0pR0R6unpr/b8/yrFreV9/vPZ5VxsHbKlqtVpt9v2cWagC21gS3W4B0B35F316/5tvd2nocU+4/nL9BiiN+2a21ff0RCkr07vi/raTBiPizMK/X6dbbNE8BABAox/S8c/zzcZ/pXioodx92RrKQETcHxH7I+KBiDgQEQ9G1Mo+HBGPtFn/yhWS1eOf0rUNBbZO6fjvpWxt6/bxXz76i4FylttXi783OTtdmTqWHZOh6N2R5kfXqOPHV3//stW+xvFfuqX152PBrB3XelZM0E2Oz41vJuZG1z+LONTTLP4k8mWcJCIORsShDdYx/ey3h1vtu3P8a+jAOlP1m4hn6ud/IVbEn0tark+Ovnhq7OTIzqhMHRvJr4rVfv1t8a1W9W8q/g5Iz//uptf/cvwDyc6I2ctXztfWa2fbr2Pxzy9a3tNs9PrvS96ppfuy1z4en5u7NBrRl7yx+vWxW+/N83n5NP6ho837//64dSQejYj0Ij4SEY9FxONZ25+IiCcj4uga8f/8ylMftB//GrPyHZTGP3mn8x+N57/9RPn8T9+3H38uPf8naqmh7JX1fP6tt4GbOXYAAADwf1Gq/QY+KQ0vp0ul4eH6b/gPxO5SZWZ27rmzMx9dnKz/Vn4gekv5TFd/w3zoaDY3nOfHVuSPZ/PGX5V31fLDEzOVyW4HDwW3p0X/T/1V7nbrgC3neS0oLv0fikv/h+LS/6G49H8ormb9/9MutAO4+3z/Q3Hp/1Bc+j8Ul/4PhdTy2fjSph75l9j2iSjdE83Y/omedf8xiw0mdjTd1e1PJgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgM74LwAA//9wiOSH")
setregid(0x0, 0x0) (async)
sendfile(r1, r2, &(0x7f0000000980)=0x6, 0x8000000000000001)
newfstatat(0xffffffffffffff9c, &(0x7f0000000040)='./file0\x00', &(0x7f0000000080), 0x0) (async, rerun: 64)
r3 = socket$nl_generic(0x10, 0x3, 0x10) (rerun: 64)
sendmsg$nl_generic(r3, &(0x7f0000000940)={&(0x7f00000001c0)={0x10, 0x0, 0x0, 0x8000000}, 0xc, &(0x7f0000000900)={&(0x7f0000000200)={0x250, 0x38, 0x0, 0x70bd2b, 0x401, {0x1a}, [@generic="4a1d59ffe3318758eafccb9c7389980983c3486ed1ac17b17246a5", @generic, @nested={0x21d, 0x115, 0x0, 0x1, [@typed={0xc, 0x10f, 0x0, 0x0, @u64=0x401}, @typed={0x2f, 0xa8, 0x0, 0x0, @binary="b9ff8f6aa0f2545617a8e25db67ef524b1ae236b48e3a8dee73cf9268c4972a57fcef4fc3128c97b1de86e"}, @generic="f12b65f0432ff487f7ca3e219bc86f4fa611ae8109cb4d6967b264ef8031cb5a9555a53076aa23344477fbf4a89520129b1b26efc3482f3be0304658150450c855812a8b89e293b909bb9b73fe463361ec3d718dc8526c6e855e4bec1f9ae93d0e14e53b9c472483a293175c75d8de017798e2bdf48fbf5d45592063b0f90730f65fbd26a85300fbfd9eb9e2158adec3c5b552c553ceaf6543a538a81eada165f4a046cdabeb3a906c3f4f46af8816f0d9ed3baffbc7494928a61b28", @typed={0x14, 0x8d, 0x0, 0x0, @ipv6=@private0}, @generic="4390a0c48c7cfff61f3ff89968b905a33cc4d51f80788ea5956d61a0eb772e423296c72d44189806ffe3a3a5b43b9ea9dd65450d2d068f39a1bc0318acd7914582b40cd98ffd960713580005de14452663b1fed682c2eb713eee435566dc445975b4f5c062af35a6a19ff12aa158171d4f500a82e68fbe4d6f1b10f214a659842d158f2345a1fbfd14837a9b5541af1d5f2a54c117ba0249df530c4623946be0a88839d05cc5f55103b0ac5bac67fdc1f27003702e4060f829be43e56eeffc9fc22e4a7d386ba2abbb2a8e117fca2c5d975aba719046566b95044f13708b8702c1e6838bd9d11e637141cfca80318b1594", @typed={0x14, 0x37, 0x0, 0x0, @ipv6=@initdev={0xfe, 0x88, '\x00', 0x0, 0x0}}, @typed={0x8, 0x127, 0x0, 0x0, @u32=0x800000}]}]}, 0x250}, 0x1, 0x0, 0x0, 0x10}, 0x40) (async, rerun: 32)
socket$inet6_udp(0xa, 0x2, 0x0) (rerun: 32)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$cgroup_ro-openat$dir-syz_mount_image$ext4-setregid-sendfile-newfstatat-socket$nl_generic-sendmsg$nl_generic
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
r1 = syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
r2 = openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000006ac0)='cpuacct.stat\x00', 0x275a, 0x0) (async, rerun: 64)
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000080)='ext3\x00', &(0x7f0000000480)='./file0\x00', 0xc0ed0806, &(0x7f0000000140)={[{@jqfmt_vfsold}, {@resgid={'resgid', 0x3d, 0xee00}}, {@bh}, {@noload}, {@data_err_ignore}, {@usrjquota}]}, 0xfe, 0x43e, &(0x7f00000004c0)="$eJzs3MtvG0UYAPBv7SR9k1DKo6WFQEFEPJImfdADFxBIHEBCgkMRp5CkVajboCZItIogcAhHVIk74ojEX8AJLgg4IXGFO6pUoVxaOBmtvZu6iZ3GiVOX7O8nbTvjHWvm292xZ2e8CaCwBtN/koi9EfFHRPTXs7cXGKz/d3NpfuKfpfmJJKrVt/9OauVuLM1P5EXz9+2pZ6rVLL+jSb2L70WMVypTl7L8yNyFD0dmL195YfrC+Lmpc1MXx06fPnH8SN+psZMdiTON68ahT2YOH3z93atvTpy5+v4v36Xt3Zvtb4yjUwbrR7eppztdWZfta0gnPV1sCG0pR0R6unpr/b8/yrFreV9/vPZ5VxsHbKlqtVpt9v2cWagC21gS3W4B0B35F316/5tvd2nocU+4/nL9BiiN+2a21ff0RCkr07vi/raTBiPizMK/X6dbbNE8BABAox/S8c/zzcZ/pXioodx92RrKQETcHxH7I+KBiDgQEQ9G1Mo+HBGPtFn/yhWS1eOf0rUNBbZO6fjvpWxt6/bxXz76i4FylttXi783OTtdmTqWHZOh6N2R5kfXqOPHV3//stW+xvFfuqX152PBrB3XelZM0E2Oz41vJuZG1z+LONTTLP4k8mWcJCIORsShDdYx/ey3h1vtu3P8a+jAOlP1m4hn6ud/IVbEn0tark+Ovnhq7OTIzqhMHRvJr4rVfv1t8a1W9W8q/g5Iz//uptf/cvwDyc6I2ctXztfWa2fbr2Pxzy9a3tNs9PrvS96ppfuy1z4en5u7NBrRl7yx+vWxW+/N83n5NP6ho837//64dSQejYj0Ij4SEY9FxONZ25+IiCcj4uga8f/8ylMftB//GrPyHZTGP3mn8x+N57/9RPn8T9+3H38uPf8naqmh7JX1fP6tt4GbOXYAAADwf1Gq/QY+KQ0vp0ul4eH6b/gPxO5SZWZ27rmzMx9dnKz/Vn4gekv5TFd/w3zoaDY3nOfHVuSPZ/PGX5V31fLDEzOVyW4HDwW3p0X/T/1V7nbrgC3neS0oLv0fikv/h+LS/6G49H8ormb9/9MutAO4+3z/Q3Hp/1Bc+j8Ul/4PhdTy2fjSph75l9j2iSjdE83Y/omedf8xiw0mdjTd1e1PJgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgM74LwAA//9wiOSH")
setregid(0x0, 0x0) (async)
sendfile(r1, r2, &(0x7f0000000980)=0x6, 0x8000000000000001)
newfstatat(0xffffffffffffff9c, &(0x7f0000000040)='./file0\x00', &(0x7f0000000080), 0x0) (async, rerun: 64)
r3 = socket$nl_generic(0x10, 0x3, 0x10) (rerun: 64)
sendmsg$nl_generic(r3, &(0x7f0000000940)={&(0x7f00000001c0)={0x10, 0x0, 0x0, 0x8000000}, 0xc, &(0x7f0000000900)={&(0x7f0000000200)={0x250, 0x38, 0x0, 0x70bd2b, 0x401, {0x1a}, [@generic="4a1d59ffe3318758eafccb9c7389980983c3486ed1ac17b17246a5", @generic, @nested={0x21d, 0x115, 0x0, 0x1, [@typed={0xc, 0x10f, 0x0, 0x0, @u64=0x401}, @typed={0x2f, 0xa8, 0x0, 0x0, @binary="b9ff8f6aa0f2545617a8e25db67ef524b1ae236b48e3a8dee73cf9268c4972a57fcef4fc3128c97b1de86e"}, @generic="f12b65f0432ff487f7ca3e219bc86f4fa611ae8109cb4d6967b264ef8031cb5a9555a53076aa23344477fbf4a89520129b1b26efc3482f3be0304658150450c855812a8b89e293b909bb9b73fe463361ec3d718dc8526c6e855e4bec1f9ae93d0e14e53b9c472483a293175c75d8de017798e2bdf48fbf5d45592063b0f90730f65fbd26a85300fbfd9eb9e2158adec3c5b552c553ceaf6543a538a81eada165f4a046cdabeb3a906c3f4f46af8816f0d9ed3baffbc7494928a61b28", @typed={0x14, 0x8d, 0x0, 0x0, @ipv6=@private0}, @generic="4390a0c48c7cfff61f3ff89968b905a33cc4d51f80788ea5956d61a0eb772e423296c72d44189806ffe3a3a5b43b9ea9dd65450d2d068f39a1bc0318acd7914582b40cd98ffd960713580005de14452663b1fed682c2eb713eee435566dc445975b4f5c062af35a6a19ff12aa158171d4f500a82e68fbe4d6f1b10f214a659842d158f2345a1fbfd14837a9b5541af1d5f2a54c117ba0249df530c4623946be0a88839d05cc5f55103b0ac5bac67fdc1f27003702e4060f829be43e56eeffc9fc22e4a7d386ba2abbb2a8e117fca2c5d975aba719046566b95044f13708b8702c1e6838bd9d11e637141cfca80318b1594", @typed={0x14, 0x37, 0x0, 0x0, @ipv6=@initdev={0xfe, 0x88, '\x00', 0x0, 0x0}}, @typed={0x8, 0x127, 0x0, 0x0, @u32=0x800000}]}]}, 0x250}, 0x1, 0x0, 0x0, 0x10}, 0x40) (async, rerun: 32)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$cgroup_ro-openat$dir-syz_mount_image$ext4-setregid-sendfile-newfstatat-socket$nl_generic
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
r1 = syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
r2 = openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000006ac0)='cpuacct.stat\x00', 0x275a, 0x0) (async, rerun: 64)
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000080)='ext3\x00', &(0x7f0000000480)='./file0\x00', 0xc0ed0806, &(0x7f0000000140)={[{@jqfmt_vfsold}, {@resgid={'resgid', 0x3d, 0xee00}}, {@bh}, {@noload}, {@data_err_ignore}, {@usrjquota}]}, 0xfe, 0x43e, &(0x7f00000004c0)="$eJzs3MtvG0UYAPBv7SR9k1DKo6WFQEFEPJImfdADFxBIHEBCgkMRp5CkVajboCZItIogcAhHVIk74ojEX8AJLgg4IXGFO6pUoVxaOBmtvZu6iZ3GiVOX7O8nbTvjHWvm292xZ2e8CaCwBtN/koi9EfFHRPTXs7cXGKz/d3NpfuKfpfmJJKrVt/9OauVuLM1P5EXz9+2pZ6rVLL+jSb2L70WMVypTl7L8yNyFD0dmL195YfrC+Lmpc1MXx06fPnH8SN+psZMdiTON68ahT2YOH3z93atvTpy5+v4v36Xt3Zvtb4yjUwbrR7eppztdWZfta0gnPV1sCG0pR0R6unpr/b8/yrFreV9/vPZ5VxsHbKlqtVpt9v2cWagC21gS3W4B0B35F316/5tvd2nocU+4/nL9BiiN+2a21ff0RCkr07vi/raTBiPizMK/X6dbbNE8BABAox/S8c/zzcZ/pXioodx92RrKQETcHxH7I+KBiDgQEQ9G1Mo+HBGPtFn/yhWS1eOf0rUNBbZO6fjvpWxt6/bxXz76i4FylttXi783OTtdmTqWHZOh6N2R5kfXqOPHV3//stW+xvFfuqX152PBrB3XelZM0E2Oz41vJuZG1z+LONTTLP4k8mWcJCIORsShDdYx/ey3h1vtu3P8a+jAOlP1m4hn6ud/IVbEn0tark+Ovnhq7OTIzqhMHRvJr4rVfv1t8a1W9W8q/g5Iz//uptf/cvwDyc6I2ctXztfWa2fbr2Pxzy9a3tNs9PrvS96ppfuy1z4en5u7NBrRl7yx+vWxW+/N83n5NP6ho837//64dSQejYj0Ij4SEY9FxONZ25+IiCcj4uga8f/8ylMftB//GrPyHZTGP3mn8x+N57/9RPn8T9+3H38uPf8naqmh7JX1fP6tt4GbOXYAAADwf1Gq/QY+KQ0vp0ul4eH6b/gPxO5SZWZ27rmzMx9dnKz/Vn4gekv5TFd/w3zoaDY3nOfHVuSPZ/PGX5V31fLDEzOVyW4HDwW3p0X/T/1V7nbrgC3neS0oLv0fikv/h+LS/6G49H8ormb9/9MutAO4+3z/Q3Hp/1Bc+j8Ul/4PhdTy2fjSph75l9j2iSjdE83Y/omedf8xiw0mdjTd1e1PJgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgM74LwAA//9wiOSH")
setregid(0x0, 0x0) (async)
sendfile(r1, r2, &(0x7f0000000980)=0x6, 0x8000000000000001)
newfstatat(0xffffffffffffff9c, &(0x7f0000000040)='./file0\x00', &(0x7f0000000080), 0x0) (async, rerun: 64)
socket$nl_generic(0x10, 0x3, 0x10) (rerun: 64)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$cgroup_ro-openat$dir-syz_mount_image$ext4-setregid-sendfile-newfstatat
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
r1 = syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
r2 = openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000006ac0)='cpuacct.stat\x00', 0x275a, 0x0) (async, rerun: 64)
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000080)='ext3\x00', &(0x7f0000000480)='./file0\x00', 0xc0ed0806, &(0x7f0000000140)={[{@jqfmt_vfsold}, {@resgid={'resgid', 0x3d, 0xee00}}, {@bh}, {@noload}, {@data_err_ignore}, {@usrjquota}]}, 0xfe, 0x43e, &(0x7f00000004c0)="$eJzs3MtvG0UYAPBv7SR9k1DKo6WFQEFEPJImfdADFxBIHEBCgkMRp5CkVajboCZItIogcAhHVIk74ojEX8AJLgg4IXGFO6pUoVxaOBmtvZu6iZ3GiVOX7O8nbTvjHWvm292xZ2e8CaCwBtN/koi9EfFHRPTXs7cXGKz/d3NpfuKfpfmJJKrVt/9OauVuLM1P5EXz9+2pZ6rVLL+jSb2L70WMVypTl7L8yNyFD0dmL195YfrC+Lmpc1MXx06fPnH8SN+psZMdiTON68ahT2YOH3z93atvTpy5+v4v36Xt3Zvtb4yjUwbrR7eppztdWZfta0gnPV1sCG0pR0R6unpr/b8/yrFreV9/vPZ5VxsHbKlqtVpt9v2cWagC21gS3W4B0B35F316/5tvd2nocU+4/nL9BiiN+2a21ff0RCkr07vi/raTBiPizMK/X6dbbNE8BABAox/S8c/zzcZ/pXioodx92RrKQETcHxH7I+KBiDgQEQ9G1Mo+HBGPtFn/yhWS1eOf0rUNBbZO6fjvpWxt6/bxXz76i4FylttXi783OTtdmTqWHZOh6N2R5kfXqOPHV3//stW+xvFfuqX152PBrB3XelZM0E2Oz41vJuZG1z+LONTTLP4k8mWcJCIORsShDdYx/ey3h1vtu3P8a+jAOlP1m4hn6ud/IVbEn0tark+Ovnhq7OTIzqhMHRvJr4rVfv1t8a1W9W8q/g5Iz//uptf/cvwDyc6I2ctXztfWa2fbr2Pxzy9a3tNs9PrvS96ppfuy1z4en5u7NBrRl7yx+vWxW+/N83n5NP6ho837//64dSQejYj0Ij4SEY9FxONZ25+IiCcj4uga8f/8ylMftB//GrPyHZTGP3mn8x+N57/9RPn8T9+3H38uPf8naqmh7JX1fP6tt4GbOXYAAADwf1Gq/QY+KQ0vp0ul4eH6b/gPxO5SZWZ27rmzMx9dnKz/Vn4gekv5TFd/w3zoaDY3nOfHVuSPZ/PGX5V31fLDEzOVyW4HDwW3p0X/T/1V7nbrgC3neS0oLv0fikv/h+LS/6G49H8ormb9/9MutAO4+3z/Q3Hp/1Bc+j8Ul/4PhdTy2fjSph75l9j2iSjdE83Y/omedf8xiw0mdjTd1e1PJgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgM74LwAA//9wiOSH")
setregid(0x0, 0x0) (async)
sendfile(r1, r2, &(0x7f0000000980)=0x6, 0x8000000000000001)
newfstatat(0xffffffffffffff9c, &(0x7f0000000040)='./file0\x00', &(0x7f0000000080), 0x0) (async, rerun: 64)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$cgroup_ro-openat$dir-syz_mount_image$ext4-setregid-sendfile
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
r1 = syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
r2 = openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000006ac0)='cpuacct.stat\x00', 0x275a, 0x0) (async, rerun: 64)
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000080)='ext3\x00', &(0x7f0000000480)='./file0\x00', 0xc0ed0806, &(0x7f0000000140)={[{@jqfmt_vfsold}, {@resgid={'resgid', 0x3d, 0xee00}}, {@bh}, {@noload}, {@data_err_ignore}, {@usrjquota}]}, 0xfe, 0x43e, &(0x7f00000004c0)="$eJzs3MtvG0UYAPBv7SR9k1DKo6WFQEFEPJImfdADFxBIHEBCgkMRp5CkVajboCZItIogcAhHVIk74ojEX8AJLgg4IXGFO6pUoVxaOBmtvZu6iZ3GiVOX7O8nbTvjHWvm292xZ2e8CaCwBtN/koi9EfFHRPTXs7cXGKz/d3NpfuKfpfmJJKrVt/9OauVuLM1P5EXz9+2pZ6rVLL+jSb2L70WMVypTl7L8yNyFD0dmL195YfrC+Lmpc1MXx06fPnH8SN+psZMdiTON68ahT2YOH3z93atvTpy5+v4v36Xt3Zvtb4yjUwbrR7eppztdWZfta0gnPV1sCG0pR0R6unpr/b8/yrFreV9/vPZ5VxsHbKlqtVpt9v2cWagC21gS3W4B0B35F316/5tvd2nocU+4/nL9BiiN+2a21ff0RCkr07vi/raTBiPizMK/X6dbbNE8BABAox/S8c/zzcZ/pXioodx92RrKQETcHxH7I+KBiDgQEQ9G1Mo+HBGPtFn/yhWS1eOf0rUNBbZO6fjvpWxt6/bxXz76i4FylttXi783OTtdmTqWHZOh6N2R5kfXqOPHV3//stW+xvFfuqX152PBrB3XelZM0E2Oz41vJuZG1z+LONTTLP4k8mWcJCIORsShDdYx/ey3h1vtu3P8a+jAOlP1m4hn6ud/IVbEn0tark+Ovnhq7OTIzqhMHRvJr4rVfv1t8a1W9W8q/g5Iz//uptf/cvwDyc6I2ctXztfWa2fbr2Pxzy9a3tNs9PrvS96ppfuy1z4en5u7NBrRl7yx+vWxW+/N83n5NP6ho837//64dSQejYj0Ij4SEY9FxONZ25+IiCcj4uga8f/8ylMftB//GrPyHZTGP3mn8x+N57/9RPn8T9+3H38uPf8naqmh7JX1fP6tt4GbOXYAAADwf1Gq/QY+KQ0vp0ul4eH6b/gPxO5SZWZ27rmzMx9dnKz/Vn4gekv5TFd/w3zoaDY3nOfHVuSPZ/PGX5V31fLDEzOVyW4HDwW3p0X/T/1V7nbrgC3neS0oLv0fikv/h+LS/6G49H8ormb9/9MutAO4+3z/Q3Hp/1Bc+j8Ul/4PhdTy2fjSph75l9j2iSjdE83Y/omedf8xiw0mdjTd1e1PJgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgM74LwAA//9wiOSH")
setregid(0x0, 0x0) (async)
sendfile(r1, r2, &(0x7f0000000980)=0x6, 0x8000000000000001)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$cgroup_ro-openat$dir-syz_mount_image$ext4-setregid
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000006ac0)='cpuacct.stat\x00', 0x275a, 0x0) (async, rerun: 64)
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000080)='ext3\x00', &(0x7f0000000480)='./file0\x00', 0xc0ed0806, &(0x7f0000000140)={[{@jqfmt_vfsold}, {@resgid={'resgid', 0x3d, 0xee00}}, {@bh}, {@noload}, {@data_err_ignore}, {@usrjquota}]}, 0xfe, 0x43e, &(0x7f00000004c0)="$eJzs3MtvG0UYAPBv7SR9k1DKo6WFQEFEPJImfdADFxBIHEBCgkMRp5CkVajboCZItIogcAhHVIk74ojEX8AJLgg4IXGFO6pUoVxaOBmtvZu6iZ3GiVOX7O8nbTvjHWvm292xZ2e8CaCwBtN/koi9EfFHRPTXs7cXGKz/d3NpfuKfpfmJJKrVt/9OauVuLM1P5EXz9+2pZ6rVLL+jSb2L70WMVypTl7L8yNyFD0dmL195YfrC+Lmpc1MXx06fPnH8SN+psZMdiTON68ahT2YOH3z93atvTpy5+v4v36Xt3Zvtb4yjUwbrR7eppztdWZfta0gnPV1sCG0pR0R6unpr/b8/yrFreV9/vPZ5VxsHbKlqtVpt9v2cWagC21gS3W4B0B35F316/5tvd2nocU+4/nL9BiiN+2a21ff0RCkr07vi/raTBiPizMK/X6dbbNE8BABAox/S8c/zzcZ/pXioodx92RrKQETcHxH7I+KBiDgQEQ9G1Mo+HBGPtFn/yhWS1eOf0rUNBbZO6fjvpWxt6/bxXz76i4FylttXi783OTtdmTqWHZOh6N2R5kfXqOPHV3//stW+xvFfuqX152PBrB3XelZM0E2Oz41vJuZG1z+LONTTLP4k8mWcJCIORsShDdYx/ey3h1vtu3P8a+jAOlP1m4hn6ud/IVbEn0tark+Ovnhq7OTIzqhMHRvJr4rVfv1t8a1W9W8q/g5Iz//uptf/cvwDyc6I2ctXztfWa2fbr2Pxzy9a3tNs9PrvS96ppfuy1z4en5u7NBrRl7yx+vWxW+/N83n5NP6ho837//64dSQejYj0Ij4SEY9FxONZ25+IiCcj4uga8f/8ylMftB//GrPyHZTGP3mn8x+N57/9RPn8T9+3H38uPf8naqmh7JX1fP6tt4GbOXYAAADwf1Gq/QY+KQ0vp0ul4eH6b/gPxO5SZWZ27rmzMx9dnKz/Vn4gekv5TFd/w3zoaDY3nOfHVuSPZ/PGX5V31fLDEzOVyW4HDwW3p0X/T/1V7nbrgC3neS0oLv0fikv/h+LS/6G49H8ormb9/9MutAO4+3z/Q3Hp/1Bc+j8Ul/4PhdTy2fjSph75l9j2iSjdE83Y/omedf8xiw0mdjTd1e1PJgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgM74LwAA//9wiOSH")
setregid(0x0, 0x0) (async)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$cgroup_ro-openat$dir-syz_mount_image$ext4
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000006ac0)='cpuacct.stat\x00', 0x275a, 0x0) (async, rerun: 64)
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000080)='ext3\x00', &(0x7f0000000480)='./file0\x00', 0xc0ed0806, &(0x7f0000000140)={[{@jqfmt_vfsold}, {@resgid={'resgid', 0x3d, 0xee00}}, {@bh}, {@noload}, {@data_err_ignore}, {@usrjquota}]}, 0xfe, 0x43e, &(0x7f00000004c0)="$eJzs3MtvG0UYAPBv7SR9k1DKo6WFQEFEPJImfdADFxBIHEBCgkMRp5CkVajboCZItIogcAhHVIk74ojEX8AJLgg4IXGFO6pUoVxaOBmtvZu6iZ3GiVOX7O8nbTvjHWvm292xZ2e8CaCwBtN/koi9EfFHRPTXs7cXGKz/d3NpfuKfpfmJJKrVt/9OauVuLM1P5EXz9+2pZ6rVLL+jSb2L70WMVypTl7L8yNyFD0dmL195YfrC+Lmpc1MXx06fPnH8SN+psZMdiTON68ahT2YOH3z93atvTpy5+v4v36Xt3Zvtb4yjUwbrR7eppztdWZfta0gnPV1sCG0pR0R6unpr/b8/yrFreV9/vPZ5VxsHbKlqtVpt9v2cWagC21gS3W4B0B35F316/5tvd2nocU+4/nL9BiiN+2a21ff0RCkr07vi/raTBiPizMK/X6dbbNE8BABAox/S8c/zzcZ/pXioodx92RrKQETcHxH7I+KBiDgQEQ9G1Mo+HBGPtFn/yhWS1eOf0rUNBbZO6fjvpWxt6/bxXz76i4FylttXi783OTtdmTqWHZOh6N2R5kfXqOPHV3//stW+xvFfuqX152PBrB3XelZM0E2Oz41vJuZG1z+LONTTLP4k8mWcJCIORsShDdYx/ey3h1vtu3P8a+jAOlP1m4hn6ud/IVbEn0tark+Ovnhq7OTIzqhMHRvJr4rVfv1t8a1W9W8q/g5Iz//uptf/cvwDyc6I2ctXztfWa2fbr2Pxzy9a3tNs9PrvS96ppfuy1z4en5u7NBrRl7yx+vWxW+/N83n5NP6ho837//64dSQejYj0Ij4SEY9FxONZ25+IiCcj4uga8f/8ylMftB//GrPyHZTGP3mn8x+N57/9RPn8T9+3H38uPf8naqmh7JX1fP6tt4GbOXYAAADwf1Gq/QY+KQ0vp0ul4eH6b/gPxO5SZWZ27rmzMx9dnKz/Vn4gekv5TFd/w3zoaDY3nOfHVuSPZ/PGX5V31fLDEzOVyW4HDwW3p0X/T/1V7nbrgC3neS0oLv0fikv/h+LS/6G49H8ormb9/9MutAO4+3z/Q3Hp/1Bc+j8Ul/4PhdTy2fjSph75l9j2iSjdE83Y/omedf8xiw0mdjTd1e1PJgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgM74LwAA//9wiOSH")

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$cgroup_ro-openat$dir
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000006ac0)='cpuacct.stat\x00', 0x275a, 0x0) (async, rerun: 64)
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$cgroup_ro
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000006ac0)='cpuacct.stat\x00', 0x275a, 0x0) (async, rerun: 64)

program did not crash
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-syz_mount_image$ext4-openat$dir
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-fcntl$lock-openat$dir
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
fcntl$lock(r0, 0x24, &(0x7f0000000240)={0x0, 0x0, 0xfe, 0xff}) (async, rerun: 64)
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)

program did not crash
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-fcntl$lock-syz_mount_image$ext4-openat$dir
detailed listing:
executing program 0:
r0 = syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
fcntl$lock(r0, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x0, 0xe}) (async, rerun: 64)
syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_open_procfs-syz_mount_image$ext4-openat$dir
detailed listing:
executing program 0:
syz_open_procfs(0x0, &(0x7f0000000100)='status\x00')
syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_mount_image$ext4-openat$dir
detailed listing:
executing program 0:
syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (async, rerun: 64)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_mount_image$ext4-openat$dir
detailed listing:
executing program 0:
syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0)

program did not crash
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_mount_image$ext4-openat$dir
detailed listing:
executing program 0:
syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
openat$dir(0xffffffffffffff9c, 0x0, 0x490003, 0x0) (async, rerun: 64)

program did not crash
testing program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_mount_image$ext4-openat$dir
detailed listing:
executing program 0:
syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000480)='./file1\x00', 0x248, &(0x7f0000000000)={[{@orlov}, {@quota}, {@noinit_itable}, {@noload}, {@auto_da_alloc_val={'auto_da_alloc', 0x3d, 0x2}}, {}, {@jqfmt_vfsold}, {@noload}, {@grpid}, {@grpquota}]}, 0xfd, 0x463, &(0x7f0000000dc0)="$eJzs3M1vG0UbAPBn10779jN5S/loKVAoiIqPpEkL9MABkJA4gIQEh3IMSVqVug1qgkSriAZUlQsSVOKOkLgg8Rdw4oSAExLXckeVKtQLhZPRxmvXcezUiR07xb+f5HrHXnueZ3fHOzvTTQAD62D2TxKxMyKuRcRwRKSNK2yrPN26uTD1982FqSTK5bf+TLKPxV83F6aqqyb5845KoZh9UXo5iZea1Dt34eKZyVJp5nxeHps/+/7Y3IWLz54+O3lq5tTMuYnjx48dHX/h+YnnupLn/7NY9380e2Dfa+9cfWPqxNV3f/4uqQu6Po/uGIqIhdo2afREdyvru111y0mxj4GwJlsjopgfrddiOAqXd9feG45XP+lrcMCGKpfL5YnWby+Wgf+wJPodAdAf1RN9dv1bffSo67Ep3Hi5cgGU5X0rf1TeKdbGQYYarm+76WBEnFj856vsERsyDgEAsNwPWf/nmWb9vzTuq1tvdz43NJLPpeyJiHsiYm9E3BuxtO79EfHAGus/2FBe2f9Jr68rsTZl/b8X87mt5f2/2izYSCEv7VrKfyg5ebo0cyTfJodjaGtWHm/67UnEYvb82+et6q/v/2WPrP5qXzCP43px6/LPTE/OT3aceO7GxxH7i83yT6J4O4vYFxH711nH6ae+PbD8lUJt6c75r6IL80zlryOerOz/xWjIvypZfX5y7H9RmjkyVj0qVvrl1ytvtqq/o/y7INv/25se/7X8R5L6+dq5FV+x5U51XPn905bXNOs9/rckby+r/MPJ+fnz4xFbktdXvl43wF0tV9fP8j98qHn73xO3t8SDEZEdxA9FxMMR8Uge+6MR8VhEHFol/59eefy99ee/sbL8p9e0/9e+UDjz4/et6m9v/x+rFpaCauf3r90AO9l2AAAAcLdII2JnJOlobTlNR0cr/4d/b2xPS7Nz80+fnP3g3HTlHoGRGEqrI13DdeOh4/nYcLU8kZcv5eWj+bjxl4VtS+XRqdnSdL+ThwG3o0X7z/xR6Hd0wIZzvxYMLu0fBtf6279fDrjb3aEVp72KA+g9Z3EYXM3a/6U+xAH0nvM/DK5a+/+ijZXrbvdqvHkTuPs4/8Pg0v5hIHVyX/+mWIhvIlZfJ9ksoa5p4bNOPl7sQYSRbo4N1cOFiUJEH8MotvtXLeJC+VLHlfb7lwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7/g0AAP//DKPkGg==")
openat$dir(0xffffffffffffff9c, &(0x7f0000000000)='./file0\x00', 0x490003, 0x0) (rerun: 64)

program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
extracting C reproducer
testing compiled C program (duration=35.701766857s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_mount_image$ext4-openat$dir
program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
simplifying C reproducer
testing compiled C program (duration=35.701766857s, {Threaded:false Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_mount_image$ext4-openat$dir
program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing compiled C program (duration=35.701766857s, {Threaded:false Repeat:false RepeatTimes:0 Procs:1 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:false Cgroups:false BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_mount_image$ext4-openat$dir
program did not crash
testing compiled C program (duration=35.701766857s, {Threaded:false Repeat:true RepeatTimes:0 Procs:1 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_mount_image$ext4-openat$dir
program crashed: KASAN: slab-out-of-bounds Read in ext4_xattr_inode_dec_ref_all
a never seen crash title: KASAN: slab-out-of-bounds Read in ext4_xattr_inode_dec_ref_all, ignore
testing compiled C program (duration=35.701766857s, {Threaded:false Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox: SandboxArg:0 Leak:false NetInjection:false NetDevices:false NetReset:false Cgroups:false BinfmtMisc:false CloseFDs:false KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:false UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_mount_image$ext4-openat$dir
program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing compiled C program (duration=35.701766857s, {Threaded:false Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox: SandboxArg:0 Leak:false NetInjection:false NetDevices:false NetReset:false Cgroups:false BinfmtMisc:false CloseFDs:false KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:false UseTmpDir:false HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_mount_image$ext4-openat$dir
program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing compiled C program (duration=35.701766857s, {Threaded:false Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox: SandboxArg:0 Leak:false NetInjection:false NetDevices:false NetReset:false Cgroups:false BinfmtMisc:false CloseFDs:false KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:false UseTmpDir:false HandleSegv:false Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_mount_image$ext4-openat$dir
program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
testing compiled C program (duration=35.701766857s, {Threaded:false Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox: SandboxArg:0 Leak:false NetInjection:false NetDevices:false NetReset:false Cgroups:false BinfmtMisc:false CloseFDs:false KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:false Swap:false UseTmpDir:false HandleSegv:false Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): syz_mount_image$ext4-openat$dir
program crashed: KASAN: use-after-free Read in ext4_xattr_set_entry
reproducing took 13m26.094501007s
repro crashed as (corrupted=false):
EXT4-fs (loop3): mounted filesystem without journal. Opts: orlov,quota,noinit_itable,noload,auto_da_alloc=0x0000000000000002,bsddf,jqfmt=vfsold,noload,grpid,grpquota,,errors=continue
==================================================================
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
BUG: KASAN: use-after-free in ext4_xattr_set_entry+0x3228/0x37c0 fs/ext4/xattr.c:1583
Read of size 4 at addr ffff88800aa82000 by task syz-executor412/243
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries

CPU: 0 PID: 243 Comm: syz-executor412 Not tainted 5.10.0 #1
Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
Call Trace:
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x107/0x163 lib/dump_stack.c:118
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
 print_address_description.constprop.0+0x1c/0x210 mm/kasan/report.c:385
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
 __kasan_report mm/kasan/report.c:545 [inline]
 kasan_report.cold+0x37/0x7c mm/kasan/report.c:562
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
 ext4_xattr_set_entry+0x3228/0x37c0 fs/ext4/xattr.c:1583
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
 ext4_xattr_ibody_inline_set+0x78/0x2b0 fs/ext4/xattr.c:2198
 ext4_xattr_set_handle+0x939/0x12b0 fs/ext4/xattr.c:2378
 ext4_initxattrs+0xb5/0x120 fs/ext4/xattr_security.c:43
 security_inode_init_security+0x1a7/0x350 security/security.c:1053
 __ext4_new_inode+0x38ec/0x55b0 fs/ext4/ialloc.c:1317
 ext4_tmpfile+0x216/0x490 fs/ext4/namei.c:2685
 vfs_tmpfile+0x132/0x280 fs/namei.c:3284
 do_tmpfile fs/namei.c:3317 [inline]
 path_openat+0x166e/0x26f0 fs/namei.c:3360
 do_filp_open+0x17e/0x3c0 fs/namei.c:3396
 do_sys_openat2+0x16d/0x420 fs/open.c:1168
 do_sys_open fs/open.c:1184 [inline]
 __do_sys_openat fs/open.c:1200 [inline]
 __se_sys_openat fs/open.c:1195 [inline]
 __x64_sys_openat+0x13f/0x1f0 fs/open.c:1195
 do_syscall_64+0x33/0x40 arch/x86/entry/common.c:46
 entry_SYSCALL_64_after_hwframe+0x44/0xa9
RIP: 0033:0x7ff04360838d
Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
RSP: 002b:00007fff034493e8 EFLAGS: 00000246 ORIG_RAX: 0000000000000101
RAX: ffffffffffffffda RBX: 0000000000000037 RCX: 00007ff04360838d
RDX: 0000000000490003 RSI: 0000000020000000 RDI: ffffffffffffff9c
RBP: 0000000000000000 R08: 00000000000000a0 R09: 00000000000000a0
R10: 0000000000000000 R11: 0000000000000246 R12: 00007fff034495c8
R13: 00007fff034495d8 R14: 00007fff03449430 R15: 00007fff03449420

Allocated by task 222:
 kasan_save_stack+0x1b/0x40 mm/kasan/common.c:48
 kasan_set_track mm/kasan/common.c:56 [inline]
 __kasan_kmalloc.constprop.0+0xc2/0xd0 mm/kasan/common.c:461
 slab_post_alloc_hook mm/slab.h:535 [inline]
 slab_alloc_node mm/slub.c:2891 [inline]
 slab_alloc mm/slub.c:2899 [inline]
 kmem_cache_alloc+0x145/0x330 mm/slub.c:2904
 __build_skb+0x21/0x60 net/core/skbuff.c:311
 build_skb+0x1a/0x220 net/core/skbuff.c:327
 e1000_clean_rx_irq+0x93d/0x1160 drivers/net/ethernet/intel/e1000/e1000_main.c:4386
 e1000_clean+0x943/0x1f30 drivers/net/ethernet/intel/e1000/e1000_main.c:3803
 napi_poll net/core/dev.c:6759 [inline]
 net_rx_action+0x463/0x11f0 net/core/dev.c:6829
 __do_softirq+0x295/0xa3f kernel/softirq.c:298

Freed by task 222:
 kasan_save_stack+0x1b/0x40 mm/kasan/common.c:48
 kasan_set_track+0x1c/0x30 mm/kasan/common.c:56
 kasan_set_free_info+0x1b/0x30 mm/kasan/generic.c:355
 __kasan_slab_free+0x110/0x150 mm/kasan/common.c:422
 slab_free_hook mm/slub.c:1544 [inline]
 slab_free_freelist_hook+0x53/0x130 mm/slub.c:1577
 slab_free mm/slub.c:3142 [inline]
 kmem_cache_free+0x97/0x340 mm/slub.c:3158
 napi_skb_finish net/core/dev.c:6067 [inline]
 napi_gro_receive+0x6c7/0x840 net/core/dev.c:6090
 e1000_receive_skb drivers/net/ethernet/intel/e1000/e1000_main.c:4007 [inline]
 e1000_clean_rx_irq+0x627/0x1160 drivers/net/ethernet/intel/e1000/e1000_main.c:4463
 e1000_clean+0x943/0x1f30 drivers/net/ethernet/intel/e1000/e1000_main.c:3803
 napi_poll net/core/dev.c:6759 [inline]
 net_rx_action+0x463/0x11f0 net/core/dev.c:6829
 __do_softirq+0x295/0xa3f kernel/softirq.c:298

The buggy address belongs to the object at ffff88800aa82000
 which belongs to the cache skbuff_head_cache of size 224
The buggy address is located 0 bytes inside of
 224-byte region [ffff88800aa82000, ffff88800aa820e0)
The buggy address belongs to the page:
page:00000000a11485e5 refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0xaa82
flags: 0x100000000000200(slab)
raw: 0100000000000200 dead000000000100 dead000000000122 ffff8880082d4640
raw: 0000000000000000 00000000000c000c 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ffff88800aa81f00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ffff88800aa81f80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
>ffff88800aa82000: fa fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                   ^
 ffff88800aa82080: fb fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc
 ffff88800aa82100: fc fc fc fc fc fc fc fc fa fb fb fb fb fb fb fb
==================================================================
EXT4-fs error (device loop0): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop0): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop0): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop0): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop0): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop0): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop0): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries

final repro crashed as (corrupted=false):
EXT4-fs (loop3): mounted filesystem without journal. Opts: orlov,quota,noinit_itable,noload,auto_da_alloc=0x0000000000000002,bsddf,jqfmt=vfsold,noload,grpid,grpquota,,errors=continue
==================================================================
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
BUG: KASAN: use-after-free in ext4_xattr_set_entry+0x3228/0x37c0 fs/ext4/xattr.c:1583
Read of size 4 at addr ffff88800aa82000 by task syz-executor412/243
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries

CPU: 0 PID: 243 Comm: syz-executor412 Not tainted 5.10.0 #1
Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
Call Trace:
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x107/0x163 lib/dump_stack.c:118
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
 print_address_description.constprop.0+0x1c/0x210 mm/kasan/report.c:385
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
 __kasan_report mm/kasan/report.c:545 [inline]
 kasan_report.cold+0x37/0x7c mm/kasan/report.c:562
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
 ext4_xattr_set_entry+0x3228/0x37c0 fs/ext4/xattr.c:1583
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop1): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
 ext4_xattr_ibody_inline_set+0x78/0x2b0 fs/ext4/xattr.c:2198
 ext4_xattr_set_handle+0x939/0x12b0 fs/ext4/xattr.c:2378
 ext4_initxattrs+0xb5/0x120 fs/ext4/xattr_security.c:43
 security_inode_init_security+0x1a7/0x350 security/security.c:1053
 __ext4_new_inode+0x38ec/0x55b0 fs/ext4/ialloc.c:1317
 ext4_tmpfile+0x216/0x490 fs/ext4/namei.c:2685
 vfs_tmpfile+0x132/0x280 fs/namei.c:3284
 do_tmpfile fs/namei.c:3317 [inline]
 path_openat+0x166e/0x26f0 fs/namei.c:3360
 do_filp_open+0x17e/0x3c0 fs/namei.c:3396
 do_sys_openat2+0x16d/0x420 fs/open.c:1168
 do_sys_open fs/open.c:1184 [inline]
 __do_sys_openat fs/open.c:1200 [inline]
 __se_sys_openat fs/open.c:1195 [inline]
 __x64_sys_openat+0x13f/0x1f0 fs/open.c:1195
 do_syscall_64+0x33/0x40 arch/x86/entry/common.c:46
 entry_SYSCALL_64_after_hwframe+0x44/0xa9
RIP: 0033:0x7ff04360838d
Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
RSP: 002b:00007fff034493e8 EFLAGS: 00000246 ORIG_RAX: 0000000000000101
RAX: ffffffffffffffda RBX: 0000000000000037 RCX: 00007ff04360838d
RDX: 0000000000490003 RSI: 0000000020000000 RDI: ffffffffffffff9c
RBP: 0000000000000000 R08: 00000000000000a0 R09: 00000000000000a0
R10: 0000000000000000 R11: 0000000000000246 R12: 00007fff034495c8
R13: 00007fff034495d8 R14: 00007fff03449430 R15: 00007fff03449420

Allocated by task 222:
 kasan_save_stack+0x1b/0x40 mm/kasan/common.c:48
 kasan_set_track mm/kasan/common.c:56 [inline]
 __kasan_kmalloc.constprop.0+0xc2/0xd0 mm/kasan/common.c:461
 slab_post_alloc_hook mm/slab.h:535 [inline]
 slab_alloc_node mm/slub.c:2891 [inline]
 slab_alloc mm/slub.c:2899 [inline]
 kmem_cache_alloc+0x145/0x330 mm/slub.c:2904
 __build_skb+0x21/0x60 net/core/skbuff.c:311
 build_skb+0x1a/0x220 net/core/skbuff.c:327
 e1000_clean_rx_irq+0x93d/0x1160 drivers/net/ethernet/intel/e1000/e1000_main.c:4386
 e1000_clean+0x943/0x1f30 drivers/net/ethernet/intel/e1000/e1000_main.c:3803
 napi_poll net/core/dev.c:6759 [inline]
 net_rx_action+0x463/0x11f0 net/core/dev.c:6829
 __do_softirq+0x295/0xa3f kernel/softirq.c:298

Freed by task 222:
 kasan_save_stack+0x1b/0x40 mm/kasan/common.c:48
 kasan_set_track+0x1c/0x30 mm/kasan/common.c:56
 kasan_set_free_info+0x1b/0x30 mm/kasan/generic.c:355
 __kasan_slab_free+0x110/0x150 mm/kasan/common.c:422
 slab_free_hook mm/slub.c:1544 [inline]
 slab_free_freelist_hook+0x53/0x130 mm/slub.c:1577
 slab_free mm/slub.c:3142 [inline]
 kmem_cache_free+0x97/0x340 mm/slub.c:3158
 napi_skb_finish net/core/dev.c:6067 [inline]
 napi_gro_receive+0x6c7/0x840 net/core/dev.c:6090
 e1000_receive_skb drivers/net/ethernet/intel/e1000/e1000_main.c:4007 [inline]
 e1000_clean_rx_irq+0x627/0x1160 drivers/net/ethernet/intel/e1000/e1000_main.c:4463
 e1000_clean+0x943/0x1f30 drivers/net/ethernet/intel/e1000/e1000_main.c:3803
 napi_poll net/core/dev.c:6759 [inline]
 net_rx_action+0x463/0x11f0 net/core/dev.c:6829
 __do_softirq+0x295/0xa3f kernel/softirq.c:298

The buggy address belongs to the object at ffff88800aa82000
 which belongs to the cache skbuff_head_cache of size 224
The buggy address is located 0 bytes inside of
 224-byte region [ffff88800aa82000, ffff88800aa820e0)
The buggy address belongs to the page:
page:00000000a11485e5 refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0xaa82
flags: 0x100000000000200(slab)
raw: 0100000000000200 dead000000000100 dead000000000122 ffff8880082d4640
raw: 0000000000000000 00000000000c000c 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ffff88800aa81f00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ffff88800aa81f80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
>ffff88800aa82000: fa fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                   ^
 ffff88800aa82080: fb fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc
 ffff88800aa82100: fc fc fc fc fc fc fc fc fa fb fb fb fb fb fb fb
==================================================================
EXT4-fs error (device loop0): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop0): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop0): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop0): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop2): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop0): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop0): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop0): ext4_xattr_set_entry:1586: inode #32: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries
EXT4-fs error (device loop3): ext4_xattr_set_entry:1586: inode #28: comm syz-executor412: corrupted xattr entries

