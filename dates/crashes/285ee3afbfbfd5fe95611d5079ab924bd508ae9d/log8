last executing test programs:

0s ago: executing program 1 (id=2):
r0 = syz_genetlink_get_family_id$ethtool(&(0x7f0000000080), 0xffffffffffffffff)
r1 = socket$nl_generic(0x10, 0x3, 0x10)
sendmsg$ETHTOOL_MSG_STRSET_GET(r1, &(0x7f00000003c0)={0x0, 0x0, &(0x7f00000002c0)={&(0x7f0000000340)={0x28, r0, 0x21, 0x0, 0x0, {}, [@ETHTOOL_A_STRSET_STRINGSETS={0x10, 0x2, 0x0, 0x1, [{0xc, 0x1, 0x0, 0x1, [@ETHTOOL_A_STRINGSET_ID={0x8, 0x1, 0xffffffffffffffff}]}]}, @ETHTOOL_A_STRSET_HEADER={0x4}]}, 0x28}}, 0x0)

kernel console output (not intermixed with test programs):

Warning: Permanently added '[localhost]:37567' (ED25519) to the list of known hosts.
syzkaller login: [   18.002838] cgroup: Unknown subsys name 'net'
[   18.003703] cgroup: Unknown subsys name 'net_prio'
[   18.004633] cgroup: Unknown subsys name 'devices'
[   18.005769] cgroup: Unknown subsys name 'blkio'
[   18.037291] cgroup: Unknown subsys name 'hugetlb'
[   18.038516] cgroup: Unknown subsys name 'rlimit'
Setting up swapspace version 1, size = 122.1 MiB (127995904 bytes)
no label, UUID=a495db8b-5089-4859-a3d9-9535ff605cf8
[   18.151533] Adding 124996k swap on ./swap-file.  Priority:0 extents:1 across:124996k 
[   18.853096] audit: type=1400 audit(1730916940.731:6): avc:  denied  { execmem } for  pid=226 comm="syz-executor" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
[   25.285607] ================================================================================
[   25.292458] UBSAN: shift-out-of-bounds in net/ethtool/strset.c:191:28
[   25.301335] shift exponent 4294967295 is too large for 32-bit type 'unsigned int'
[   25.302697] CPU: 1 PID: 2016 Comm: syz.1.2 Not tainted 5.10.0 #1
[   25.303731] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   25.305349] Call Trace:
[   25.305759]  dump_stack+0x107/0x163
[   25.306345]  ubsan_epilogue+0xb/0x5a
[   25.306944]  __ubsan_handle_shift_out_of_bounds.cold+0xb2/0x186
[   25.307906]  ? __nla_parse+0x3e/0x50
[   25.308523]  strset_parse_request.cold+0x3b/0x40
[   25.309284]  ? strset_reply_size+0x280/0x280
[   25.310002]  ? strset_reply_size+0x280/0x280
[   25.310707]  ethnl_default_parse+0xdd/0x130
[   25.311400]  ethnl_default_doit+0x281/0xa80
[   25.312098]  ? __nla_parse+0x3e/0x50
[   25.312680]  ? ethnl_reply_init+0x1f0/0x1f0
[   25.313368]  ? genl_family_rcv_msg_attrs_parse.constprop.0+0x1b7/0x280
[   25.314427]  ? genl_family_rcv_msg_attrs_parse.constprop.0+0xaf/0x280
[   25.315447]  genl_family_rcv_msg_doit+0x22d/0x330
[   25.316204]  ? genl_family_rcv_msg_attrs_parse.constprop.0+0x280/0x280
[   25.317251]  ? genl_op_from_full+0x177/0x230
[   25.317938]  ? genl_get_cmd+0x11b/0x270
[   25.318566]  genl_rcv_msg+0x33e/0x5a0
[   25.319196]  ? genl_family_rcv_msg_doit+0x330/0x330
[   25.319996]  ? ethnl_reply_init+0x1f0/0x1f0
[   25.320669]  ? ethnl_default_parse+0x130/0x130
[   25.321401]  ? ethnl_fill_reply_header.part.0+0x320/0x320
[   25.322271]  ? get_order+0x20/0x20
[   25.322842]  ? lock_release+0x6f0/0x6f0
[   25.323490]  netlink_rcv_skb+0x14b/0x430
[   25.324142]  ? genl_family_rcv_msg_doit+0x330/0x330
[   25.324941]  ? netlink_ack+0xab0/0xab0
[   25.325561]  ? is_vmalloc_addr+0x7b/0xb0
[   25.326222]  genl_rcv+0x24/0x40
[   25.326747]  netlink_unicast+0x53a/0x7e0
[   25.327391]  ? netlink_attachskb+0x810/0x810
[   25.328183]  netlink_sendmsg+0x912/0xe20
[   25.328872]  ? netlink_unicast+0x7e0/0x7e0
[   25.329582]  ? netlink_unicast+0x7e0/0x7e0
[   25.330265]  sock_sendmsg+0x15c/0x190
[   25.330853]  ____sys_sendmsg+0x709/0x880
[   25.331539]  ? kernel_sendmsg+0x50/0x50
[   25.332157]  ? __ia32_sys_recvmmsg+0x260/0x260
[   25.332873]  ? __lock_acquire+0xc2d/0x5ca0
[   25.333555]  ___sys_sendmsg+0xf3/0x170
[   25.334168]  ? sendmsg_copy_msghdr+0x160/0x160
[   25.334877]  ? __fget_files+0x2cc/0x460
[   25.335494]  ? lock_downgrade+0x6d0/0x6d0
[   25.336157]  ? __fget_files+0x2ee/0x460
[   25.336799]  ? __fget_light+0xea/0x280
[   25.337552]  __sys_sendmsg+0xe5/0x1b0
[   25.338151]  ? __sys_sendmsg_sock+0xb0/0xb0
[   25.338837]  ? __x64_sys_futex+0x3ab/0x5b0
[   25.339515]  ? syscall_enter_from_user_mode+0x27/0x80
[   25.340325]  do_syscall_64+0x33/0x40
[   25.340932]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   25.341741] RIP: 0033:0x7faa2ff55ef9
[   25.342345] Code: ff ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 a8 ff ff ff f7 d8 64 89 01 48
[   25.345292] RSP: 002b:00007faa2ebcf038 EFLAGS: 00000246 ORIG_RAX: 000000000000002e
[   25.346513] RAX: ffffffffffffffda RBX: 00007faa3010df80 RCX: 00007faa2ff55ef9
[   25.347661] RDX: 0000000000000000 RSI: 00000000200003c0 RDI: 0000000000000003
[   25.348796] RBP: 00007faa2ffc8b76 R08: 0000000000000000 R09: 0000000000000000
[   25.349964] R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
[   25.351131] R13: 0000000000000000 R14: 00007faa3010df80 R15: 00007ffff1b16a18
[   25.380859] ================================================================================

VM DIAGNOSIS:
02:15:47  Registers:
info registers vcpu 0

CPU#0
RAX=0000000000000001 RBX=2514f928cc045827 RCX=ffff888019c7fcf8 RDX=1ffff110021fb468
RSI=0000000000000000 RDI=0000000000000000 RBP=1ffff1100338ff97 RSP=ffff888019c7fca8
R8 =0000000000000000 R9 =0000000000000000 R10=0000000000000001 R11=0000000000000001
R12=0000000000000001 R13=0000000000000002 R14=ffff888010fda348 R15=ffff888010fd9a00
RIP=ffffffff812ad45c RFL=00000246 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0000 0000000000000000 00000000 00000000
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007f7dec8f9540 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f7dec940000 CR3=000000000f85a000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 0000000000000007 00007f7dece13a90
YMM02=0000000000000000 0000000000000000 325f4342494c4700 352e322e325f4342
YMM03=0000000000000000 0000000000000000 0000000000000000 0000000000004342
YMM04=0000000000000000 0000000000000000 322e325f4342494c 4700352e322e325f
YMM05=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM06=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=dffffc0000000000 RBX=1ffff11001bb8f24 RCX=0000000000000000 RDX=0000000000000000
RSI=0000000000000000 RDI=ffff88800ae91c48 RBP=0000000000000001 RSP=ffff88800ddc7910
R8 =0000000000000001 R9 =0000000000000000 R10=ffffed10016770ea R11=0000000000000001
R12=0000000000000000 R13=ffff88800ae91c48 R14=0000000000000000 R15=0000000000000000
RIP=ffffffff812ad7ca RFL=00000216 [----AP-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007ff54f1248c0 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=000056113af770f0 CR3=000000000c186000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM02=0000000000000000 0000000000000000 0000000000000000 00000000000000ff
YMM03=0000000000000000 0000000000000000 0000000000ff0000 000000ff000000ff
YMM04=0000000000000000 0000000000000000 2f2f2f2f2f2f2f2f 2f2f2f2f2f2f2f2f
YMM05=0000000000000000 0000000000000000 000056113af93120 000056113af95720
YMM06=0000000000000000 0000000000000000 0000000000000000 ffffffff00000004
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 3c20706f20262620 30203d3e20706f00
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000020000000 0000000020000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
