Warning: Permanently added '[localhost]:57097' (ED25519) to the list of known hosts.
executing program
syzkaller login: [   65.567814] audit: type=1400 audit(1730916227.216:6): avc:  denied  { execmem } for  pid=236 comm="syz-executor187" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
[   65.595151] EXT4-fs (loop0): mounted filesystem without journal. Opts: ,errors=continue
[   65.597145] ext4 filesystem being mounted at /file0 supports timestamps until 2038 (0x7fffffff)
[   65.620297] 
[   65.620598] ======================================================
[   65.621677] WARNING: possible circular locking dependency detected
[   65.622721] 5.10.0 #1 Not tainted
[   65.623259] ------------------------------------------------------
[   65.624302] syz-executor187/236 is trying to acquire lock:
[   65.626081] ffff888013af76e8 (&ei->xattr_sem){++++}-{3:3}, at: ext4_xattr_get+0x14e/0xa40
[   65.627893] 
[   65.627893] but task is already holding lock:
[   65.628855] ffff888013af7aa8 (&ea_inode->i_rwsem#14/1){+.+.}-{3:3}, at: chown_common+0x349/0x570
[   65.630259] 
[   65.630259] which lock already depends on the new lock.
[   65.630259] 
[   65.631552] 
[   65.631552] the existing dependency chain (in reverse order) is:
[   65.632743] 
[   65.632743] -> #1 (&ea_inode->i_rwsem#14/1){+.+.}-{3:3}:
[   65.633941]        down_write+0x8d/0x150
[   65.634632]        ext4_xattr_set_entry+0x299e/0x37c0
[   65.635484]        ext4_xattr_block_set+0x834/0x2f50
[   65.636315]        ext4_xattr_set_handle+0xd01/0x12b0
[   65.637174]        ext4_xattr_set+0x13a/0x340
[   65.637868]        __vfs_setxattr+0x10f/0x170
[   65.638558]        __vfs_setxattr_noperm+0x11a/0x4c0
[   65.639376]        __vfs_setxattr_locked+0x1bf/0x250
[   65.640209]        vfs_setxattr+0xe8/0x270
[   65.640933]        setxattr+0x23d/0x330
[   65.641637]        path_setxattr+0x170/0x190
[   65.642324]        __x64_sys_setxattr+0xc0/0x160
[   65.643065]        do_syscall_64+0x33/0x40
[   65.643722]        entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   65.644596] 
[   65.644596] -> #0 (&ei->xattr_sem){++++}-{3:3}:
[   65.645589]        __lock_acquire+0x2ac4/0x5ca0
[   65.646326]        lock_acquire+0x293/0x9b0
[   65.647019]        down_read+0x96/0x450
[   65.647651]        ext4_xattr_get+0x14e/0xa40
[   65.648378]        __vfs_getxattr+0xdb/0x140
[   65.649086]        cap_inode_need_killpriv+0x3c/0x60
[   65.649913]        security_inode_need_killpriv+0x46/0xa0
[   65.650794]        notify_change+0x882/0x1090
[   65.651523]        chown_common+0x37e/0x570
[   65.652223]        do_fchownat+0x126/0x1e0
[   65.652891]        __x64_sys_lchown+0x7a/0xc0
[   65.653591]        do_syscall_64+0x33/0x40
[   65.654280]        entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   65.655186] 
[   65.655186] other info that might help us debug this:
[   65.655186] 
[   65.656422]  Possible unsafe locking scenario:
[   65.656422] 
[   65.657410]        CPU0                    CPU1
[   65.658148]        ----                    ----
[   65.658884]   lock(&ea_inode->i_rwsem#14/1);
[   65.659584]                                lock(&ei->xattr_sem);
[   65.660524]                                lock(&ea_inode->i_rwsem#14/1);
[   65.661587]   lock(&ei->xattr_sem);
[   65.662149] 
[   65.662149]  *** DEADLOCK ***
[   65.662149] 
[   65.663088] 2 locks held by syz-executor187/236:
[   65.663837]  #0: ffff88800cc0c438 (sb_writers#3){.+.+}-{0:0}, at: do_fchownat+0x101/0x1e0
[   65.665162]  #1: ffff888013af7aa8 (&ea_inode->i_rwsem#14/1){+.+.}-{3:3}, at: chown_common+0x349/0x570
[   65.666641] 
[   65.666641] stack backtrace:
[   65.667347] CPU: 0 PID: 236 Comm: syz-executor187 Not tainted 5.10.0 #1
[   65.668413] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   65.670003] Call Trace:
[   65.670419]  dump_stack+0x107/0x163
[   65.671005]  check_noncircular+0x25f/0x2e0
[   65.671661]  ? print_circular_bug+0x450/0x450
[   65.672379]  ? __is_insn_slot_addr+0x1ad/0x270
[   65.673151]  ? alloc_chain_hlocks+0x4bf/0xc80
[   65.673872]  ? unwind_get_return_address+0x51/0x90
[   65.674644]  ? stack_trace_save+0xc0/0xc0
[   65.675296]  __lock_acquire+0x2ac4/0x5ca0
[   65.675951]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   65.676785]  lock_acquire+0x293/0x9b0
[   65.677391]  ? ext4_xattr_get+0x14e/0xa40
[   65.678048]  ? lock_release+0x6f0/0x6f0
[   65.678714]  down_read+0x96/0x450
[   65.679295]  ? ext4_xattr_get+0x14e/0xa40
[   65.679975]  ? down_write+0x150/0x150
[   65.680557]  ? find_held_lock+0x2c/0x110
[   65.681191]  ext4_xattr_get+0x14e/0xa40
[   65.681819]  ? ext4_xattr_ibody_get+0x4a0/0x4a0
[   65.682549]  ? xattr_resolve_name+0x26e/0x3d0
[   65.683261]  ? ext4_xattr_security_set+0x40/0x40
[   65.684000]  __vfs_getxattr+0xdb/0x140
[   65.684607]  ? __vfs_setxattr+0x170/0x170
[   65.685256]  ? igrab+0xb0/0xb0
[   65.685758]  cap_inode_need_killpriv+0x3c/0x60
[   65.686487]  security_inode_need_killpriv+0x46/0xa0
[   65.687265]  notify_change+0x882/0x1090
[   65.687895]  chown_common+0x37e/0x570
[   65.688516]  ? vfs_fchmod+0xc0/0xc0
[   65.689104]  ? lock_release+0x6f0/0x6f0
[   65.689717]  ? __mnt_want_write+0x1bc/0x2a0
[   65.690406]  do_fchownat+0x126/0x1e0
[   65.691004]  ? chown_common+0x570/0x570
[   65.691632]  __x64_sys_lchown+0x7a/0xc0
[   65.692263]  ? syscall_enter_from_user_mode+0x27/0x80
[   65.693122]  do_syscall_64+0x33/0x40
[   65.693743]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   65.694547] RIP: 0033:0x7f2a81673a4d
[   65.695144] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[   65.698083] RSP: 002b:00007ffd168bb258 EFLAGS: 00000246 ORIG_RAX: 000000000000005e
[   65.699267] RAX: ffffffffffffffda RBX: 0030656c69662f2e RCX: 00007f2a81673a4d
[   65.700443] RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000020000000
[   65.701583] RBP: 00007ffd168bb310 R08: 0000000000000000 R09: 0000000000000000
[   65.702721] R10: 0000000000000000 R11: 0000000000000246 R12: 00007ffd168bb388
[   65.703950] R13: 00007ffd168bb398 R14: 00007f2a81701d10 R15: 0000000000000001

VM DIAGNOSIS:
02:03:47  Registers:
info registers vcpu 0

CPU#0
RAX=000000000000000d RBX=0000000000000000 RCX=0000000000000000 RDX=00000000000003f8
RSI=ffffffff823c0a41 RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff8880128f7288
R8 =0000000000000001 R9 =0000000000000003 R10=000000000000001f R11=0000000000000001
R12=000000000000000d R13=0000000000000000 R14=ffffffff87a492a0 R15=dffffc0000000000
RIP=ffffffff823c0a6c RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000555556063380 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=000055767184d808 CR3=000000000ab00000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 2e79616c7265766f 2e64657473757274
YMM01=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM02=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM03=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM04=0000000000000000 0000000000000000 00007f2a816f4d60 00007f2a81706b60
YMM05=0000000000000000 0000000000000000 0000000000000001 0000000000000001
YMM06=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=0000000000000000 RBX=0000000000000003 RCX=ffffffff817dd971 RDX=0000000000000003
RSI=ffffffff817dd9a3 RDI=0000000000000005 RBP=697665642f000000 RSP=ffff88800ac9f7f8
R8 =0000000000000000 R9 =ffff888009e78f20 R10=0000000000000007 R11=0000000000000001
R12=697665642f737973 R13=ffff888009e78ef0 R14=ffff888009e78f20 R15=dffffc0000000000
RIP=ffffffff81460ec4 RFL=00000206 [-----P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007fd06aa9f8c0 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=0000557671818d40 CR3=000000000ca12000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 ffff000000000000 0000000000000000
YMM02=0000000000000000 0000000000000000 000064656863736f 692f65756575712f
YMM03=0000000000000000 0000000000000000 7269762f73656369 7665642f7379732f
YMM04=0000000000000000 0000000000000000 2f2f2f2f2f2f2f2f 2f2f2f2f2f2f2f2f
YMM05=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM06=0000000000000000 0000000000000000 00005576717e6660 0000000400000000
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 3a212d2b007b3d0d 0a0920002c0d0a09
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
