Warning: Permanently added '[localhost]:38977' (ED25519) to the list of known hosts.
executing program
syzkaller login: [   20.016675] audit: type=1400 audit(1731338766.458:6): avc:  denied  { execmem } for  pid=236 comm="syz-executor188" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
[   20.054569] EXT4-fs (loop0): 1 orphan inode deleted
[   20.055485] EXT4-fs (loop0): mounted filesystem without journal. Opts: errors=remount-ro,sysvgroups,dioread_lock,grpquota,noauto_da_alloc,resgid=0x0000000000000000,barrier,auto_da_alloc,usrquota,
[   20.058652] ext4 filesystem being mounted at /file1 supports timestamps until 2038 (0x7fffffff)
[   20.082260] ==================================================================
[   20.083622] BUG: KASAN: use-after-free in ext4_find_extent+0xcaf/0xd10
[   20.084735] Read of size 4 at addr ffff8880104c252c by task syz-executor188/236
[   20.085967] 
[   20.086680] CPU: 1 PID: 236 Comm: syz-executor188 Not tainted 5.10.0 #1
[   20.088751] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   20.090797] Call Trace:
[   20.091249]  dump_stack+0x107/0x163
[   20.091855]  ? ext4_find_extent+0xcaf/0xd10
[   20.092556]  ? ext4_find_extent+0xcaf/0xd10
[   20.093272]  print_address_description.constprop.0+0x1c/0x210
[   20.094270]  ? _raw_spin_lock_irqsave+0x4e/0x50
[   20.095100]  ? vprintk_func+0x95/0x250
[   20.095791]  ? ext4_find_extent+0xcaf/0xd10
[   20.096495]  ? ext4_find_extent+0xcaf/0xd10
[   20.097232]  kasan_report.cold+0x37/0x7c
[   20.097945]  ? ext4_find_extent+0xcaf/0xd10
[   20.098678]  ext4_find_extent+0xcaf/0xd10
[   20.099399]  ext4_ext_remove_space+0x1445/0x4470
[   20.100221]  ? find_held_lock+0x2c/0x110
[   20.100932]  ? ext4_es_remove_extent+0x201/0x460
[   20.101800]  ? do_raw_write_lock+0x11a/0x280
[   20.102537]  ? ext4_ext_index_trans_blocks+0x160/0x160
[   20.103445]  ? ext4_es_remove_extent+0x103/0x460
[   20.104269]  ? ext4_es_lookup_extent+0xc90/0xc90
[   20.105072]  ? down_write_killable_nested+0x180/0x180
[   20.105962]  ? __ext4_journal_start_sb+0x11c/0x490
[   20.106784]  ext4_punch_hole+0x678/0x1130
[   20.107467]  ext4_fallocate+0x10e7/0x3e70
[   20.108219]  ? lock_release+0x6f0/0x6f0
[   20.109035]  ? ext4_ext_truncate+0x260/0x260
[   20.109968]  ? ext4_ext_truncate+0x260/0x260
[   20.110902]  vfs_fallocate+0x494/0xdd0
[   20.111737]  ioctl_preallocate+0x18e/0x200
[   20.112628]  ? fiemap_prep+0x220/0x220
[   20.113454]  do_vfs_ioctl+0xe3c/0x1140
[   20.114286]  ? generic_block_fiemap+0x60/0x60
[   20.115245]  ? selinux_bprm_creds_for_exec+0xac0/0xac0
[   20.116365]  ? trace_event_raw_event_rseq_update+0x200/0x200
[   20.117567]  ? vfs_write+0x354/0xac0
[   20.118363]  __x64_sys_ioctl+0x108/0x210
[   20.119228]  do_syscall_64+0x33/0x40
[   20.120003]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   20.121074] RIP: 0033:0x7f747a3b1f4d
[   20.121852] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[   20.125493] RSP: 002b:00007ffe9f4b1e48 EFLAGS: 00000246 ORIG_RAX: 0000000000000010
[   20.126837] RAX: ffffffffffffffda RBX: 0031656c69662f2e RCX: 00007f747a3b1f4d
[   20.128089] RDX: 0000000020000080 RSI: 0000000040305829 RDI: 0000000000000004
[   20.129292] RBP: 00007ffe9f4b1ef0 R08: 0000000000000001 R09: 0000000000000001
[   20.130581] R10: 0000000000000001 R11: 0000000000000246 R12: 00007ffe9f4b1f68
[   20.131798] R13: 00007ffe9f4b1f78 R14: 00007f747a441d10 R15: 0000000000000001
[   20.133111] 
[   20.133373] Allocated by task 1:
[   20.134002]  kasan_save_stack+0x1b/0x40
[   20.134691]  __kasan_kmalloc.constprop.0+0xc2/0xd0
[   20.135510]  kmem_cache_alloc+0x145/0x330
[   20.136220]  __alloc_file+0x21/0x310
[   20.136885]  alloc_empty_file+0x6d/0x170
[   20.137629]  path_openat+0x125/0x26f0
[   20.138300]  do_filp_open+0x17e/0x3c0
[   20.138957]  do_sys_openat2+0x16d/0x420
[   20.139614]  __x64_sys_openat+0x13f/0x1f0
[   20.140284]  do_syscall_64+0x33/0x40
[   20.140919]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   20.141790] 
[   20.142138] Freed by task 236:
[   20.142693]  kasan_save_stack+0x1b/0x40
[   20.143342]  kasan_set_track+0x1c/0x30
[   20.144060]  kasan_set_free_info+0x1b/0x30
[   20.144753]  __kasan_slab_free+0x110/0x150
[   20.145447]  slab_free_freelist_hook+0x53/0x130
[   20.146214]  kmem_cache_free+0x97/0x340
[   20.146913]  rcu_do_batch+0x496/0x1440
[   20.147552]  rcu_core+0x62d/0x9d0
[   20.148148]  __do_softirq+0x295/0xa3f
[   20.148760] 
[   20.149037] Last call_rcu():
[   20.149507]  kasan_save_stack+0x1b/0x40
[   20.150209]  kasan_record_aux_stack+0x9e/0xb0
[   20.151029]  call_rcu+0xe6/0x13b0
[   20.151591]  task_work_run+0xe2/0x1a0
[   20.152209]  exit_to_user_mode_prepare+0x155/0x160
[   20.153057]  syscall_exit_to_user_mode+0x3d/0x270
[   20.153850]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   20.154683] 
[   20.154955] Second to last call_rcu():
[   20.155588]  kasan_save_stack+0x1b/0x40
[   20.156244]  kasan_record_aux_stack+0x9e/0xb0
[   20.157040]  call_rcu+0xe6/0x13b0
[   20.157612]  task_work_run+0xe2/0x1a0
[   20.158242]  exit_to_user_mode_prepare+0x155/0x160
[   20.159089]  syscall_exit_to_user_mode+0x3d/0x270
[   20.159902]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   20.160722] 
[   20.161023] The buggy address belongs to the object at ffff8880104c2500
[   20.161023]  which belongs to the cache filp of size 488
[   20.163032] The buggy address is located 44 bytes inside of
[   20.163032]  488-byte region [ffff8880104c2500, ffff8880104c26e8)
[   20.164973] The buggy address belongs to the page:
[   20.165766] page:0000000006483fc5 refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x104c2
[   20.167261] head:0000000006483fc5 order:1 compound_mapcount:0
[   20.168233] flags: 0x100000000010200(slab|head)
[   20.169005] raw: 0100000000010200 dead000000000100 dead000000000122 ffff888008144000
[   20.170330] raw: 0000000000000000 00000000000c000c 00000001ffffffff ffff88800cc85581
[   20.171650] page dumped because: kasan: bad access detected
[   20.172608] page->mem_cgroup:ffff88800cc85581
[   20.173321] 
[   20.173608] Memory state around the buggy address:
[   20.174405]  ffff8880104c2400: fb fb fb fb fb fb fb fb fb fb fb fb fb fc fc fc
[   20.175727]  ffff8880104c2480: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   20.177024] >ffff8880104c2500: fa fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
[   20.178209]                                   ^
[   20.179018]  ffff8880104c2580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
[   20.180190]  ffff8880104c2600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
[   20.181358] ==================================================================
[   20.182569] Disabling lock debugging due to kernel taint
[   20.183651] EXT4-fs error (device loop0): ext4_free_blocks:5297: comm syz-executor188: Freeing blocks not in datazone - block = 141974574725920, count = 12
[   20.186071] EXT4-fs (loop0): Remounting filesystem read-only
[   20.187139] EXT4-fs error (device loop0): ext4_free_blocks:5297: comm syz-executor188: Freeing blocks not in datazone - block = 17922898495616, count = 11392
[   20.197859] syz-executor188 (236) used greatest stack depth: 24432 bytes left

VM DIAGNOSIS:
23:26:06  Registers:
info registers vcpu 0

CPU#0
RAX=0000000000000000 RBX=1ffff1100116bf73 RCX=ffffffff817bb363 RDX=0000000000000000
RSI=ffffffff817bb371 RDI=0000000000000005 RBP=ffff888008b5fd20 RSP=ffff888008b5fb80
R8 =0000000000000000 R9 =0000000000000000 R10=0000000000000000 R11=0000000000000001
R12=ffff888008b5fbb8 R13=0000000000000000 R14=ffff88800b2de600 R15=ffff888008b5fd88
RIP=ffffffff81460ec4 RFL=00000246 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007f37570e38c0 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f92ff8a1d10 CR3=000000000b618000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM02=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM03=0000000000000000 0000000000000000 ff0000000000ff00 000000ff000000ff
YMM04=0000000000000000 0000000000000000 2f2f2f2f2f2f2f2f 2f2f2f2f2f2f2f2f
YMM05=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM06=0000000000000000 0000000000000000 000055aec77cced0 0000000000000000
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 2064616572206f74 2064656c69614600
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000020000000 0000000020000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=0000000000000077 RBX=0000000000000000 RCX=0000000000000000 RDX=00000000000003f8
RSI=ffffffff823c0a41 RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff8880156ff2c0
R8 =0000000000000001 R9 =0000000000000003 R10=000000000000001f R11=0000000000000001
R12=0000000000000077 R13=0000000000000000 R14=ffffffff87a492a0 R15=dffffc0000000000
RIP=ffffffff823c0a6c RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000555556c8d380 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00000000200200ff CR3=000000000c882000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM02=0000000000000000 0000000000000000 0000000000000000 00ffffffffffffff
YMM03=0000000000000000 0000000000000000 00000000000000ff 00000000000000ff
YMM04=0000000000000000 0000000000000000 00007f747a434d60 00007f747a446b80
YMM05=0000000000000000 0000000000000000 0000000000000001 0000000000000001
YMM06=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
