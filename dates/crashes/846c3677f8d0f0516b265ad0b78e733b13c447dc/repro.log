Warning: Permanently added '[localhost]:52314' (ED25519) to the list of known hosts.
syzkaller login: [   58.912013] audit: type=1400 audit(1730890922.520:6): avc:  denied  { execmem } for  pid=239 comm="syz-executor873" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
executing program
[   59.075371] ------------[ cut here ]------------
[   59.078680] kernel BUG at fs/notify/dnotify/dnotify.c:118!
[   59.084672] invalid opcode: 0000 [#1] PREEMPT SMP KASAN NOPTI
[   59.087770] CPU: 1 PID: 59 Comm: kworker/u4:1 Not tainted 5.10.0 #1
[   59.089921] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   59.093376] Workqueue: events_unbound fsnotify_mark_destroy_workfn
[   59.095490] RIP: 0010:dnotify_free_mark+0x4b/0x60
[   59.097105] Code: 80 3c 02 00 75 32 48 83 bd 80 00 00 00 00 75 15 e8 aa c5 bc ff 48 8b 3d 83 31 4d 04 48 89 ee 5d e9 3a ae e9 ff e8 95 c5 bc ff <0f> 0b 48 c7 c7 c0 fa 29 85 e8 96 42 57 02 e8 d2 f5 e9 ff eb c7 41
[   59.103496] RSP: 0018:ffff88800aa37c50 EFLAGS: 00010293
[   59.105319] RAX: 0000000000000000 RBX: ffffffff845009c0 RCX: 1ffff11001546f96
[   59.107850] RDX: ffff88800a943400 RSI: ffffffff8189492b RDI: ffff88800c408080
[   59.110452] RBP: ffff88800c408000 R08: 0000000000000001 R09: ffffffff86e5f70f
[   59.112931] R10: 0000000000000001 R11: 0000000000000001 R12: ffff888009049000
[   59.115419] R13: ffff88800aa37ca0 R14: ffff88800aa37cb0 R15: dffffc0000000000
[   59.117899] FS:  0000000000000000(0000) GS:ffff88806cf00000(0000) knlGS:0000000000000000
[   59.120709] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[   59.122762] CR2: 00007fa633675490 CR3: 000000000bce2000 CR4: 0000000000350ee0
[   59.125326] Call Trace:
[   59.126256]  fsnotify_final_mark_destroy+0x77/0xb0
[   59.127814]  fsnotify_mark_destroy_workfn+0x1b1/0x290
[   59.129231]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   59.130678]  ? fsnotify_final_mark_destroy+0xb0/0xb0
[   59.132081]  process_one_work+0x7ce/0x16c0
[   59.133272]  ? lock_release+0x6f0/0x6f0
[   59.134368]  ? pwq_dec_nr_in_flight+0x320/0x320
[   59.135610]  ? rwlock_bug.part.0+0x90/0x90
[   59.136716]  ? _raw_spin_lock_irq+0x41/0x50
[   59.137875]  worker_thread+0x61d/0x1310
[   59.138976]  ? __kthread_parkme+0x13f/0x1e0
[   59.140152]  ? process_one_work+0x16c0/0x16c0
[   59.141399]  kthread+0x3b2/0x4a0
[   59.142341]  ? __kthread_bind_mask+0xc0/0xc0
[   59.143557]  ret_from_fork+0x22/0x30
[   59.144548] Modules linked in:
[   59.145635] ---[ end trace 2d9507c563a59620 ]---
[   59.147423] RIP: 0010:dnotify_free_mark+0x4b/0x60
[   59.148815] Code: 80 3c 02 00 75 32 48 83 bd 80 00 00 00 00 75 15 e8 aa c5 bc ff 48 8b 3d 83 31 4d 04 48 89 ee 5d e9 3a ae e9 ff e8 95 c5 bc ff <0f> 0b 48 c7 c7 c0 fa 29 85 e8 96 42 57 02 e8 d2 f5 e9 ff eb c7 41
[   59.153958] RSP: 0018:ffff88800aa37c50 EFLAGS: 00010293
[   59.155705] RAX: 0000000000000000 RBX: ffffffff845009c0 RCX: 1ffff11001546f96
[   59.157711] RDX: ffff88800a943400 RSI: ffffffff8189492b RDI: ffff88800c408080
[   59.159708] RBP: ffff88800c408000 R08: 0000000000000001 R09: ffffffff86e5f70f
[   59.161766] R10: 0000000000000001 R11: 0000000000000001 R12: ffff888009049000
[   59.163821] R13: ffff88800aa37ca0 R14: ffff88800aa37cb0 R15: dffffc0000000000
[   59.165977] FS:  0000000000000000(0000) GS:ffff88806cf00000(0000) knlGS:0000000000000000
[   59.168527] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[   59.170405] CR2: 00007fa633675490 CR3: 000000000ddbc000 CR4: 0000000000350ee0

VM DIAGNOSIS:
19:02:02  Registers:
info registers vcpu 0

CPU#0
RAX=dffffc0000000000 RBX=1ffff11001a12ea5 RCX=ffffffff86101363 RDX=ffff88800d0975f8
RSI=0000000000000001 RDI=0000000000000001 RBP=0000000000000001 RSP=ffff88800d0974d8
R8 =ffffffff8610135e R9 =ffffffff86101362 R10=ffffed1001a12ec3 R11=000000000001f5fd
R12=ffff88800d097608 R13=ffff88800d0975f5 R14=ffff88800d097610 R15=ffff88800d0975c0
RIP=ffffffff8112a9b6 RFL=00000246 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007fdf4c5c5900 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007fdf4cb89970 CR3=000000000b686000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 0000000000000000 00000000000000ff
YMM02=0000000000000000 0000000000000000 0000000000000000 00000000000000ff
YMM03=0000000000000000 0000000000000000 5320444f4854454d 5f54505952434e45
YMM04=0000000000000000 0000000000000000 4040404040404040 4040404040404040
YMM05=0000000000000000 0000000000000000 5a5a5a5a5a5a5a5a 5a5a5a5a5a5a5a5a
YMM06=0000000000000000 0000000000000000 2020202020202020 2020202020202020
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 ffbc64ffffbc44ff ffbc34ffffbc9f00
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=000000000000004e RBX=0000000000000000 RCX=0000000000000000 RDX=00000000000003f8
RSI=ffffffff823c0a41 RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff88800aa37658
R8 =0000000000000000 R9 =ffffffff85d66c0f R10=000000000000001f R11=0000000000000001
R12=000000000000004e R13=0000000000000000 R14=ffffffff87a492a0 R15=dffffc0000000000
RIP=ffffffff823c0a6c RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007fa633675490 CR3=000000000bce2000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 3d3d3d3d3d3d3d3d 3d3d3d3d3d3d3d3d
YMM01=0000000000000000 0000000000000000 0000000000000000 646873733d4d4d4f
YMM02=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM03=0000000000000000 0000000000000000 66207463656e6e6f 6373696420646576
YMM04=0000000000000000 0000000000000000 b8ee688d492446a7 00000000001265e8
YMM05=0000000000000000 0000000000000000 d3fdd5f48436fbd7 00000000000aeab8
YMM06=0000000000000000 0000000000000000 3cf6de28f73a070c 00000000000ae970
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 415453454d49545f 454d49544c414552
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
