Warning: Permanently added '[localhost]:18754' (ED25519) to the list of known hosts.
syzkaller login: [   20.037907] audit: type=1400 audit(1730912075.791:6): avc:  denied  { execmem } for  pid=236 comm="syz-executor109" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
executing program
[   20.074556] FAULT_INJECTION: forcing a failure.
[   20.074556] name failslab, interval 1, probability 0, space 0, times 1
[   20.077144] CPU: 1 PID: 237 Comm: syz-executor109 Not tainted 5.10.0 #1
[   20.078856] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   20.081404] Call Trace:
[   20.082075]  dump_stack+0x107/0x163
[   20.082988]  should_fail.cold+0x5/0x1f
[   20.083969]  ? hashtab_duplicate+0x235/0x580
[   20.085078]  should_failslab+0x5/0x10
[   20.086034]  kmem_cache_alloc+0x5b/0x330
[   20.087084]  ? __kasan_kmalloc.constprop.0+0xc2/0xd0
[   20.088359]  hashtab_duplicate+0x235/0x580
[   20.089421]  ? cond_insertf+0x320/0x320
[   20.090453]  ? security_read_policy+0x310/0x310
[   20.091645]  cond_policydb_dup+0x154/0x9e0
[   20.092733]  ? __kmalloc_track_caller+0x187/0x2b0
[   20.093939]  ? memcpy+0x39/0x60
[   20.094637]  security_set_bools+0x1ae/0x740
[   20.095334]  ? sel_commit_bools_write+0x29b/0x510
[   20.096055]  sel_commit_bools_write+0x429/0x510
[   20.096770]  ? sel_write_context+0x3a0/0x3a0
[   20.097426]  ? sel_write_context+0x3a0/0x3a0
[   20.098094]  vfs_write+0x29a/0xac0
[   20.098626]  ksys_write+0x12d/0x250
[   20.099171]  ? __ia32_sys_read+0xb0/0xb0
[   20.099806]  ? syscall_enter_from_user_mode+0x27/0x80
[   20.100580]  do_syscall_64+0x33/0x40
[   20.101136]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   20.101890] RIP: 0033:0x7f72914c492d
[   20.102439] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[   20.105222] RSP: 002b:00007ffe0582c058 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
[   20.106348] RAX: ffffffffffffffda RBX: 0000000000000001 RCX: 00007f72914c492d
[   20.107411] RDX: 0000000000000048 RSI: 0000000020000dc0 RDI: 0000000000000003
[   20.108463] RBP: 00007ffe0582c090 R08: 0000000000000000 R09: 0000000120080522
[   20.109554] R10: 0000000000000064 R11: 0000000000000246 R12: 0000000000000004
[   20.110614] R13: 00007ffe0582c1e8 R14: 00007f7291553bd0 R15: 0000000000000001
[   20.112247] ==================================================================
[   20.113416] BUG: KASAN: double-free or invalid-free in kmem_cache_free+0x97/0x340
[   20.114548] 
[   20.114807] CPU: 1 PID: 237 Comm: syz-executor109 Not tainted 5.10.0 #1
[   20.115779] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   20.117553] Call Trace:
[   20.117952]  dump_stack+0x107/0x163
[   20.118477]  print_address_description.constprop.0+0x1c/0x210
[   20.120109]  ? _raw_spin_lock_irqsave+0x4e/0x50
[   20.120852]  ? vprintk_func+0x95/0x250
[   20.121750]  ? kmem_cache_free+0x97/0x340
[   20.122356]  kasan_report_invalid_free+0x51/0x80
[   20.123074]  ? kmem_cache_free+0x97/0x340
[   20.123727]  __kasan_slab_free+0x13f/0x150
[   20.124354]  slab_free_freelist_hook+0x53/0x130
[   20.125061]  ? hashtab_duplicate+0x464/0x580
[   20.125719]  kmem_cache_free+0x97/0x340
[   20.126292]  ? __kasan_kmalloc.constprop.0+0xc2/0xd0
[   20.127062]  ? security_read_policy+0x310/0x310
[   20.127744]  hashtab_duplicate+0x464/0x580
[   20.128354]  ? cond_insertf+0x320/0x320
[   20.128950]  ? security_read_policy+0x310/0x310
[   20.129634]  cond_policydb_dup+0x154/0x9e0
[   20.130257]  ? __kmalloc_track_caller+0x187/0x2b0
[   20.130975]  ? memcpy+0x39/0x60
[   20.131453]  security_set_bools+0x1ae/0x740
[   20.132101]  ? sel_commit_bools_write+0x29b/0x510
[   20.132811]  sel_commit_bools_write+0x429/0x510
[   20.133512]  ? sel_write_context+0x3a0/0x3a0
[   20.134191]  ? sel_write_context+0x3a0/0x3a0
[   20.134872]  vfs_write+0x29a/0xac0
[   20.135408]  ksys_write+0x12d/0x250
[   20.135974]  ? __ia32_sys_read+0xb0/0xb0
[   20.136571]  ? syscall_enter_from_user_mode+0x27/0x80
[   20.137329]  do_syscall_64+0x33/0x40
[   20.137932]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   20.138719] RIP: 0033:0x7f72914c492d
[   20.139257] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[   20.142013] RSP: 002b:00007ffe0582c058 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
[   20.143143] RAX: ffffffffffffffda RBX: 0000000000000001 RCX: 00007f72914c492d
[   20.144196] RDX: 0000000000000048 RSI: 0000000020000dc0 RDI: 0000000000000003
[   20.145240] RBP: 00007ffe0582c090 R08: 0000000000000000 R09: 0000000120080522
[   20.146286] R10: 0000000000000064 R11: 0000000000000246 R12: 0000000000000004
[   20.147334] R13: 00007ffe0582c1e8 R14: 00007f7291553bd0 R15: 0000000000000001
[   20.148439] 
[   20.148677] Allocated by task 237:
[   20.149207]  kasan_save_stack+0x1b/0x40
[   20.149790]  __kasan_kmalloc.constprop.0+0xc2/0xd0
[   20.150501]  __kmalloc_track_caller+0x156/0x2b0
[   20.151228]  kmemdup+0x23/0x50
[   20.151692]  security_set_bools+0x17f/0x740
[   20.152329]  sel_commit_bools_write+0x429/0x510
[   20.153019]  vfs_write+0x29a/0xac0
[   20.153526]  ksys_write+0x12d/0x250
[   20.154062]  do_syscall_64+0x33/0x40
[   20.154607]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   20.155361] 
[   20.155607] The buggy address belongs to the object at ffff88800ae97800
[   20.155607]  which belongs to the cache kmalloc-1k of size 1024
[   20.157603] The buggy address is located 136 bytes inside of
[   20.157603]  1024-byte region [ffff88800ae97800, ffff88800ae97c00)
[   20.159368] The buggy address belongs to the page:
[   20.160128] page:0000000055ed5eee refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0xae90
[   20.161520] head:0000000055ed5eee order:3 compound_mapcount:0 compound_pincount:0
[   20.162644] flags: 0x100000000010200(slab|head)
[   20.163349] raw: 0100000000010200 dead000000000100 dead000000000122 ffff888008041140
[   20.164530] raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
[   20.165724] page dumped because: kasan: bad access detected
[   20.166563] 
[   20.166820] Memory state around the buggy address:
[   20.167574]  ffff88800ae97780: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   20.168675]  ffff88800ae97800: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[   20.169769] >ffff88800ae97880: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[   20.170862]                       ^
[   20.171402]  ffff88800ae97900: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[   20.172489]  ffff88800ae97980: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[   20.173573] ==================================================================
[   20.174663] Disabling lock debugging due to kernel taint

VM DIAGNOSIS:
00:54:36  Registers:
info registers vcpu 0

CPU#0
RAX=ffffffff815299a5 RBX=dffffc0000000000 RCX=1ffffffff0e3d934 RDX=0000000000000000
RSI=ffffffff84ca9e68 RDI=ffffffff84ca9e68 RBP=ffff88800bdb7cc8 RSP=ffff88800bdb7bf8
R8 =0000000000000001 R9 =0000000000000001 R10=000000007fff0000 R11=0000000000000001
R12=000000007b356448 R13=0000000000000055 R14=ffffc90000690058 R15=ffff88800bdb7cc8
RIP=ffffffff815299a5 RFL=00000246 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007fc158254900 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007fc1576abbe0 CR3=000000000bd78000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 4d3fde5d210b9a95 9d47609072820908
YMM02=0000000000000000 0000000000000000 f3e88f777023e8a3 00000000000aea10
YMM03=0000000000000000 0000000000000000 ac8bc31478ec8511 00000000000aef78
YMM04=0000000000000000 0000000000000000 f2edee3b75dba6e6 000000000012a0c8
YMM05=0000000000000000 0000000000000000 d3fdd5f48436fbd7 00000000000aeab8
YMM06=0000000000000000 0000000000000000 d7fbd3e46421ceb3 00000000000ae970
YMM07=0000000000000000 0000000000000000 a1fcdcf819d7e1e5 00000000000ae728
YMM08=0000000000000000 0000000000000000 44495f474f4c5359 530069253d595449
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=dffffc0000000060 RBX=0000000000000005 RCX=0000000000000000 RDX=00000000000003fd
RSI=ffffffff823c0aec RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff88800acff4d0
R8 =0000000000000001 R9 =0000000000000003 R10=000000000000001f R11=0000000000000001
R12=0000000000000000 R13=fffffbfff0f492a7 R14=fffffbfff0f4925e R15=dffffc0000000000
RIP=ffffffff823c0b14 RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000555557376380 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=0000000020000040 CR3=000000000fbc6000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 ffff000000000000 ffff00000000ff00
YMM02=0000000000000000 0000000000000000 0000000000ff0000 00000000000000ff
YMM03=0000000000000000 0000000000000000 0000000000ff0000 00000000000000ff
YMM04=0000000000000000 0000000000000000 00007f7291546aa0 00007f7291558b80
YMM05=0000000000000000 0000000000000000 0000000000000001 0000000000000001
YMM06=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM07=0000000000000000 0000000000000000 2f2f2f2f2f2f2f2f 2f2f2f2f2f2f2f2f
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
