last executing test programs:

0s ago: executing program 0 (id=1):
syz_mount_image$ext4(&(0x7f0000000040)='ext4\x00', &(0x7f0000000140)='./file0\x00', 0xe, &(0x7f00000001c0)={[{@noload}, {@resuid={'resuid', 0x3d, 0xee01}}, {@debug_want_extra_isize={'debug_want_extra_isize', 0x3d, 0x2a}}, {@sb={'sb', 0x3d, 0x16f}}, {@i_version}, {@quota}]}, 0x3, 0x431, &(0x7f0000000500)="$eJzs289PHFUcAPDvzAKV/hCs9UdpVbQaiT+g0Ko9eNFo4kETEz3UIwJtsNtiCia2IYrG1KNp4t14NPEv8KQXo55MvOrdNGkMl1ZPa2Z3BpZllwJdWO1+Psm07828zXvfffN235vHBtC1hrN/koj9EfF7RAzUsmsLDNf+u7m8OPX38uJUEpXKW38l1XI3lheniqLF6/blmZE0Iv0siSNN6p2/dPncZLk8czHPjy2cf39s/tLlZ2fPT56dOTtzYeLUqZMnxl94fuK5tsSZxXVj6KO5o4dfe+fqG1Onr77787dJEX9DHG0yvNHFJyqVNlfXWQfq0klPBxvClpQiIuuu3ur4H4hSrHbeQLz6aUcbB+yoSq7F5aUKcAdLotMtADqj+KLP1r/FsXuzj867/lJtAZTFfTM/ald6Is3L9Dasb9tpOCJOL/3zVXbEzjyHAABY4/ts/vNMs/lfGvfXlbs730MZjIh7IuJgRNwbEYci4r6IatkHIuLBLdbfuEmyfv6TXttWYJuUzf9ezPe21s7/itlfDJby3IFq/L3JmdnyzPH8PRmJ3j1ZfnyDOn545bcvWl2rn/9lR1Z/MRfM23GtZ8/a10xPLkzeTsz1rn8SMdTTLP5kZScgiYjDETG0zTpmn/rmaKtrt45/A23YZ6p8HfFkrf+XoiH+QrLx/uTYXVGeOT5W3BXr/fLrlTdb1X9b8bdB1v97m97/K/EPJvX7tfNbr+PKH5+3XNNs9/7vS96upvvycx9OLixcHI/oS16vNbr+/MTqa4t8UT6Lf+RY8/F/MFbfiSMRkd3ED0XEwxHxSN72RyPisYg4tkH8P738+Hvbj39nZfFPb6n/VxN90XimeaJ07sfv1lQ6uJX4s/4/WU2N5Gc28/m3mXZt724GAACA/580IvZHko6upNN0dLT2N/yHYm9anptfePrM3AcXpmu/ERiM3rR40jVQ9zx0PF/WF/mJhvyJ/Lnxl6X+an50aq483engocvtazH+M3+WOt06YMf5vRZ0L+MfupfxD93L+Ifu1WT893eiHcDua/b9/3EH2gHsvobxb9sPuoj1P3Qv4x+6l/EPXWm+P279I3kJiXWJSP8TzZDYoUSnP5kAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADa498AAAD//wgz6sQ=")
chdir(&(0x7f0000000240)='./file0\x00')
r0 = openat$procfs(0xffffffffffffff9c, &(0x7f0000000080)='/proc/locks\x00', 0x0, 0x0)
read$ptp(r0, &(0x7f0000001080)=""/4091, 0xffb)
r1 = open(&(0x7f00009e1000)='./file0\x00', 0x102440, 0x0)
fcntl$setlease(r1, 0x400, 0x0)
open$dir(&(0x7f0000000000)='./file0\x00', 0x440, 0x0)
creat(&(0x7f0000000080)='./file3\x00', 0x0)
link(&(0x7f00000000c0)='./file3\x00', &(0x7f0000000100)='./bus\x00')

kernel console output (not intermixed with test programs):

Warning: Permanently added '[localhost]:2104' (ED25519) to the list of known hosts.
syzkaller login: [   17.784224] cgroup: Unknown subsys name 'net'
[   17.785065] cgroup: Unknown subsys name 'net_prio'
[   17.785929] cgroup: Unknown subsys name 'devices'
[   17.786714] cgroup: Unknown subsys name 'blkio'
[   17.813522] cgroup: Unknown subsys name 'hugetlb'
[   17.814443] cgroup: Unknown subsys name 'rlimit'
Setting up swapspace version 1, size = 122.1 MiB (127995904 bytes)
no label, UUID=98e5b698-916d-4a08-b66d-973b4e11bc18
[   17.910067] Adding 124996k swap on ./swap-file.  Priority:0 extents:1 across:124996k 
[   18.576293] audit: type=1400 audit(1730949002.234:6): avc:  denied  { execmem } for  pid=229 comm="syz-executor" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
[   24.924019] EXT4-fs: Warning: mounting with data=journal disables delayed allocation, dioread_nolock, O_DIRECT and fast_commit support!
[   24.927913] EXT4-fs (loop0): encrypted files will use data=ordered instead of data journaling mode
[   24.949264] EXT4-fs error (device loop0): ext4_mb_generate_buddy:802: group 0, block bitmap and bg descriptor inconsistent: 191 vs 220 free clusters
[   24.952636] EXT4-fs warning (device loop0): ext4_expand_extra_isize_ea:2782: Unable to expand inode 15. Delete some EAs or run e2fsck.
[   24.955446] EXT4-fs (loop0): 1 truncate cleaned up
[   24.956254] EXT4-fs (loop0): mounted filesystem without journal. Opts: noload,resuid=0x000000000000ee01,debug_want_extra_isize=0x000000000000002a,sb=0x000000000000016f,i_version,quota,,errors=continue
[   24.966969] ------------[ cut here ]------------
[   24.967822] WARNING: CPU: 1 PID: 2043 at mm/page_alloc.c:4930 __alloc_pages_nodemask+0x58a/0x6a0
[   24.970755] Modules linked in:
[   24.971532] CPU: 1 PID: 2043 Comm: syz.0.1 Not tainted 5.10.0 #1
[   24.973084] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   24.975102] RIP: 0010:__alloc_pages_nodemask+0x58a/0x6a0
[   24.978910] Code: 00 00 0c 00 0f 85 86 00 00 00 4c 89 c2 44 89 e6 44 89 ff c6 44 24 70 00 4c 89 6c 24 58 e8 de d6 ff ff 49 89 c6 e9 17 fd ff ff <0f> 0b e9 d6 fd ff ff 4c 89 44 24 18 4c 89 44 24 10 89 74 24 0c 4c
[   24.985240] RSP: 0018:ffff88800c54f810 EFLAGS: 00010246
[   24.989312] RAX: 0000000000000000 RBX: 1ffff110018a9f06 RCX: 0000000000000000
[   24.991376] RDX: 0000000000000000 RSI: dffffc0000000000 RDI: 0000000000040d40
[   24.993192] RBP: 0000000000000000 R08: ffffffff84529240 R09: 0000000000000000
[   24.994845] R10: 0000000000000000 R11: 0000000000000001 R12: 000000000000000f
[   24.997712] R13: 000000000000000f R14: 0000000000000000 R15: ffff88800c54fa38
[   25.000105] FS:  00007fcc9df636c0(0000) GS:ffff88806cf00000(0000) knlGS:0000000000000000
[   25.003827] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[   25.005105] CR2: 00007f957e705e08 CR3: 000000000fefc000 CR4: 0000000000350ee0
[   25.008652] Call Trace:
[   25.009387]  ? __alloc_pages_slowpath.constprop.0+0x23a0/0x23a0
[   25.011297]  ? ext4_xattr_check_entries+0x337/0x3c0
[   25.012787]  alloc_pages_current+0x191/0x2a0
[   25.013936]  kmalloc_order+0x32/0xa0
[   25.014632]  kmalloc_order_trace+0x14/0x110
[   25.016175]  ext4_update_inline_data+0x1f3/0x480
[   25.017478]  ? ext4_add_dirent_to_inline+0x530/0x530
[   25.018731]  ? ext4_add_dirent_to_inline+0xde/0x530
[   25.020033]  ? ext4_add_dirent_to_inline+0xe9/0x530
[   25.021302]  ? is_dynamic_key+0x1c0/0x1c0
[   25.022570]  ? get_max_inline_xattr_value_size+0x3db/0x510
[   25.024052]  ext4_try_add_inline_entry+0x41b/0x650
[   25.025399]  ? ext4_da_write_inline_data_end+0x310/0x310
[   25.026735]  ? current_time+0x72/0x2c0
[   25.027531]  ? mark_held_locks+0x9e/0xe0
[   25.028640]  ext4_add_entry+0x34e/0xc60
[   25.029396]  ? lockdep_hardirqs_on+0x79/0x100
[   25.030203]  ? make_indexed_dir+0xdb0/0xdb0
[   25.031065]  ? current_time+0x1e6/0x2c0
[   25.031827]  ? igrab+0xb0/0xb0
[   25.032394]  ? __ext4_journal_start_sb+0x1db/0x490
[   25.033226]  ? inc_nlink+0x46/0x160
[   25.033844]  __ext4_link+0x45e/0x5c0
[   25.034565]  ? ext4_unlink+0x8f0/0x8f0
[   25.035261]  ? down_write+0xdb/0x150
[   25.036303]  ? down_write_killable_nested+0x180/0x180
[   25.037245]  ext4_link+0x207/0x280
[   25.037921]  vfs_link+0x83e/0xc20
[   25.038476]  do_linkat+0x3c5/0x560
[   25.039122]  ? user_path_at_empty+0x100/0x100
[   25.040289]  __x64_sys_link+0x5d/0x80
[   25.040984]  do_syscall_64+0x33/0x40
[   25.041601]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   25.042786] RIP: 0033:0x7fcc9f2e9ef9
[   25.043422] Code: ff ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 a8 ff ff ff f7 d8 64 89 01 48
[   25.046647] RSP: 002b:00007fcc9df63038 EFLAGS: 00000246 ORIG_RAX: 0000000000000056
[   25.047965] RAX: ffffffffffffffda RBX: 00007fcc9f4a1f80 RCX: 00007fcc9f2e9ef9
[   25.049600] RDX: 0000000000000000 RSI: 0000000020000100 RDI: 00000000200000c0
[   25.050865] RBP: 00007fcc9f35cb76 R08: 0000000000000000 R09: 0000000000000000
[   25.052316] R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
[   25.053571] R13: 0000000000000000 R14: 00007fcc9f4a1f80 R15: 00007ffd9a451488
[   25.055092] irq event stamp: 5401
[   25.055689] hardirqs last  enabled at (5409): [<ffffffff812d54e1>] console_unlock+0x991/0xba0
[   25.057332] hardirqs last disabled at (5432): [<ffffffff83ebb922>] __schedule+0xfe2/0x2030
[   25.059062] softirqs last  enabled at (5448): [<ffffffff84000f92>] asm_call_irq_on_stack+0x12/0x20
[   25.062166] softirqs last disabled at (5463): [<ffffffff84000f92>] asm_call_irq_on_stack+0x12/0x20
[   25.063860] ---[ end trace 2111f2498bf4bcfa ]---

VM DIAGNOSIS:
11:10:08  Registers:
info registers vcpu 0

CPU#0
RAX=00000000828e9348 RBX=000000002e4b8aec RCX=0000000000000cc0 RDX=00000000e4956b63
RSI=0000000000000003 RDI=00000000b5fd9ee4 RBP=ffff88800cecae80 RSP=ffff88800c547be8
R8 =0000000088d9c5c5 R9 =ffffffff86045754 R10=ffffed10018a8f71 R11=0000000000000139
R12=ffff88800c547c58 R13=0000000000000006 R14=0000000000000006 R15=00000000000b8aec
RIP=ffffffff820ab662 RFL=00000246 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f3d38ece6f4 CR3=0000000008f10000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 2f736b6e696c2f76 6564752f6e75722f
YMM01=0000000000000000 0000000000000000 616c2d7962663278 5c6b736964663278
YMM02=0000000000000000 0000000000000000 ffffffffffff0000 ffff000000000000
YMM03=0000000000000000 0000000000000000 0000000000000000 000000000000ff00
YMM04=0000000000000000 0000000000000000 2f2f2f2f2f2f2f2f 2f2f2f2f2f2f2f2f
YMM05=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM06=0000000000000000 0000000000000000 000056378a1d6f90 0000000000000000
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 3c20706f20262620 30203d3e20706f00
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=dffffc0000000000 RBX=ffff88800b7af328 RCX=0000000000000000 RDX=1ffff110016f5e65
RSI=ffffffff817bc9fe RDI=ffff88800b7af334 RBP=0000000000000008 RSP=ffff88800b7af250
R8 =ffffffff861102b6 R9 =0000000000000001 R10=ffffed10016f5e59 R11=0000000000000001
R12=ffff88800b7af328 R13=0000000000000000 R14=ffff888008c54e00 R15=0000000000000031
RIP=ffffffff8134e90b RFL=00000246 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007fbbc3376900 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007fbbc27abb30 CR3=000000000be28000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM01=0000000000000000 0000000000000000 6434653961613931 3133393166663836
YMM02=0000000000000000 0000000000000000 6164346539616139 3131333931666638
YMM03=0000000000000000 0000000000000000 2f6c616e72756f6a 2f676f6c2f6e7572
YMM04=0000000000000000 0000000000000000 c8f26ac84d6c490a 00000000001275e8
YMM05=0000000000000000 0000000000000000 d3fdd5f48436fbd7 00000000000aeab8
YMM06=0000000000000000 0000000000000000 5b01cc9db67d6c8b 00000000000ae970
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 44495f474f4c5359 530069253d595449
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 2020000000002020 2020202020200000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
