last executing test programs:

51.837682ms ago: executing program 1 (id=2):
connect$unix(0xffffffffffffffff, &(0x7f0000000000), 0x1) (async)
r0 = socket(0x2, 0x2, 0x0) (async)
r1 = socket(0x2, 0x400000000002, 0x0)
dup2(r1, r0) (async)
setsockopt$sock_int(r0, 0xffff, 0x1002, &(0x7f0000000040)=0x3f, 0x4) (async)
socket$inet(0x2, 0x2, 0x0) (async)
recvmsg(r1, &(0x7f0000001680)={0x0, 0x0, 0x0}, 0x842) (async)
pipe(&(0x7f0000000040)={0xffffffffffffffff, <r2=>0xffffffffffffffff})
r3 = fcntl$dupfd(r2, 0x3, 0xffffffffffffffff)
write(0xffffffffffffffff, &(0x7f0000000100), 0xfffffe5d) (async)
write(r3, &(0x7f0000000100), 0xfffffe5d) (async)
execve(0x0, 0x0, 0x0) (async)
connect$unix(0xffffffffffffffff, &(0x7f0000000000), 0x10) (async, rerun: 64)
perf_event_open(&(0x7f000001d000)={0x1, 0x80, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_bp={0x0}}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0) (rerun: 64)
r4 = socket$inet6(0xa, 0x2, 0x0)
setsockopt$inet6_buf(r4, 0x29, 0x15, &(0x7f00000001c0)="bae3161ba5b2c0e1d42af043d58e4264ce71373e94ab2d4a4301726c70086a4e6b198d5b67b2a30521441a878eebcab3117e32ba9fb301db521dd2d1be48356888f2b04d148eaa910b0cf3e8b6a5c4005a08ea0901aee6c9afb540878b13b99fad377c3ff15fc66397b21f31c8693f0d0705a6cf3117a4a745e42b483f69d5c554a203c8dd20a9a56ce44e6401e07809506552ca839d747d6639a27ee1f7a136cf364eb6b9379bb0ede916d159e4", 0xae) (async)
r5 = socket$inet6(0xa, 0x3, 0x5)
getsockopt$inet6_IPV6_IPSEC_POLICY(r4, 0x29, 0x22, 0x0, &(0x7f0000000000))
setsockopt$sock_int(0xffffffffffffffff, 0x1, 0x9, &(0x7f0000000280), 0x4) (async)
r6 = socket$inet_udplite(0x2, 0x2, 0x88)
ioctl$sock_ipv4_tunnel_SIOCDELTUNNEL(r6, 0x89f2, &(0x7f0000000300)={'syztnl2\x00', &(0x7f00000004c0)={'syztnl2\x00', 0x0, 0x8000, 0x40, 0xff, 0x101, {{0xa, 0x4, 0x3, 0x3b, 0x28, 0x68, 0x0, 0x9, 0x4, 0x0, @local, @dev={0xac, 0x14, 0x14, 0xf}, {[@timestamp_prespec={0x44, 0x14, 0x2c, 0x3, 0x9, [{@local, 0x1ff}, {@private=0xa010100, 0x8}]}]}}}}}) (async)
setsockopt$inet6_int(r5, 0x29, 0x1000000000021, 0x0, 0x0)
syz_mount_image$ext4(&(0x7f0000000180)='ext4\x00', &(0x7f00000000c0)='./file0\x00', 0x800714, &(0x7f0000000340)={[{@dioread_nolock}, {@user_xattr}, {@debug_want_extra_isize={'debug_want_extra_isize', 0x3d, 0x5c}}, {@resuid={'resuid', 0x3d, 0xee01}}, {@mblk_io_submit}, {@errors_continue}, {@usrjquota}, {@prjquota}, {@nodiscard}]}, 0xfe, 0x43a, &(0x7f00000008c0)="$eJzs289vFFUcAPDvzLag/GpFREHQKhobf7S0oHLwotHEgyYmesBjbQtBFmpoTYQ0Wo3BoyHxbjya+Bd40otRTyZe9W5IiDYmoKea2Z0pu0u39Mcui8znkwy8t/N23/vum7fz9r1uAKU1lP2TROyIiN8iYqCebS4wVP/v2uL85D+L85NJLC29+WdSK3d1cX6yKFo8b3ueGU4j0k+TvJJms+cvnJ6oVqfP5fnRuTPvjc6ev/DMqTMTJ6dPTp8dP3bs6JGx558bf7YjcWZxXd3/4cyBfa++fen1yeOX3vnpm6y9ew/WzzfG0SlDWeB/LdW0nnu805X12M6GdNLXw4awLpWIyLqrvzb+B6IS1ztvIF75pKeNA7oquzdtbX96YQm4gyXR6xYAvVHc6LPvv8Vxi6Yet4UrL9a/AGVxX8uP+pm+SPMy/V2sfygiji/8+2V2RJfWIQAAGn2XzX+eXmn+l8behnK78j2UwYi4JyJ2R8S9EbEnIu6LqJW9PyIeWGf9rVtDN85/0ssbCmyNsvnfC/neVvP8r5j9xWAlz+2sxd+fnDhVnT6cvyfD0b81y4+tUsf3L//6ebtzjfO/7MjqL+aCeTsu97Us0E1NzE10alJ65eOI/X0rxZ8s7wQkEbEvIvav76V3FYlTT359oF2hm8e/ig7sMy19FfFEvf8XoiX+QrL6/uToXVGdPjxaXBU3+vmXi2+0q39T8XdA1v/bmq//lhIDfyeN+7Wz66/j4u+ftf1Os9Hrf0vyVm3Pekv+2AcTc3PnxiK2JK/V8k2Pj19/bpEvymfxDx9aefzvzp+Txf9gRGQX8cGIeCgiHs7b/khEPBoRh1aJ/8eXHnt34/F3Vxb/1Iqff8vX/2Bz/68/UTn9w7ft6l9b/x+tpYbzR2qffzex1gZu5r0DAACA/4s0InZEko4sp9N0ZKT+N/x7YltanZmde+rEzPtnp+q/ERiM/rRY6RpoWA8dSxbyV6znx/O14uL8kXzd+IvK3bX8yORMdarHsUPZbW8z/jN/VHrdOqDr/F4Lyqt1/Kc9agdw67n/Q3kZ/1Bexj+U10rj/6OWvL0AuDO5/0N5Gf9QXsY/lJfxD6W0md/1S5Q5Eelt0QyJLiV6/ckEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQGf8FAAD//yWS7pw=")
r7 = open(&(0x7f0000000000)='./bus\x00', 0x60142, 0x0)
ioctl$EXT4_IOC_GET_ES_CACHE(r7, 0xc020662a, &(0x7f00000001c0)={0x0, 0x0, 0x6}) (async)
setsockopt$sock_int(0xffffffffffffffff, 0x1, 0x9, &(0x7f0000000040)=0x1, 0x4) (async)
setsockopt$inet_tcp_TCP_REPAIR(0xffffffffffffffff, 0x6, 0x13, 0x0, 0x0)
connect$inet(0xffffffffffffffff, 0x0, 0x0)
setsockopt$inet_tcp_TCP_REPAIR(0xffffffffffffffff, 0x6, 0x13, &(0x7f0000000000), 0x4) (async)
syz_mount_image$ext4(&(0x7f0000000780)='ext4\x00', &(0x7f0000000240)='./file0\x00', 0x3000480, &(0x7f0000000080), 0x45, 0x786, &(0x7f00000007c0)="$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")

33.166808ms ago: executing program 1 (id=5):
r0 = socket$nl_generic(0x10, 0x3, 0x10)
r1 = syz_genetlink_get_family_id$ethtool(&(0x7f00000003c0), 0xffffffffffffffff)
sendmsg$ETHTOOL_MSG_DEBUG_SET(r0, &(0x7f0000000540)={0x0, 0x0, &(0x7f0000000500)={&(0x7f00000004c0)={0x14, r1, 0x1}, 0x14}}, 0x0)
syz_mount_image$ext4(&(0x7f0000000040)='ext4\x00', &(0x7f0000000500)='./file1\x00', 0x4000, &(0x7f0000001240), 0x12, 0x4b4, &(0x7f0000001b00)="$eJzs3d9rW9cdAPDvvbay/HBmZ9tDFlgWlgwnbJHseEnMHrIMxvIU2Ja9Z54tG2PZMpacxCYMh/0BgzHWQp/61JdC/4BCyZ9QCoH2vbSlpbRJ+9CHtiqSrtLElWKHyL5gfz5wfM+5V9L3e2x0dc+9x7oB7FunIuJqRAxExLmIGM7Wp1m51mxstB/36OHd6WZJotG48VkSSbau81pJtjzSfkocjIi/XYv4Z/LDuLW19YWpSqW8krVL9cXlUm1t/fz84tRcea68NDExfmny8uTFybG+9HMkIq786aP//+e1P19567e337/5ydl/NdMayrY/2Y9+ane90PpddAxGxMpOBMvBQLYs5JwHAADb0zzG/0lE/Kp1/D8cA62jUwAAAGAvafxhKL5OIhoAAADAnpW25sAmaTGbCzAUaVostufw/iwOp5Vqrf6b2erq0kx7ruxIFNLZ+Up5LJsrPBKFpNkez+bYdtoXNrUnIuJYRPxv+FCrXZyuVmbyPvkBAAAA+8SRTeP/L4fb438AAABgjxnJOwEAAABgxxn/AwAAwN5n/A8AAAB72l+uX2+WRuf+1zO31lYXqrfOz5RrC8XF1enidHVluThXrc61vrNvcavXq1Sry7+LpdU7pXq5Vi/V1tZvLlZXl+o355+6BTYAAACwi4798v57SURs/P5QqzQdyDspYFckz/PgD3cuD2D3DeSdAJCbwbwTAHJTyDsBIHdbnQfoOXnn7f7nAgAA7IzRn/e+/u/cAOxtad4JAAC7zvV/2L8KZgDCvvfjLba/+PX/RuO5EgIAAPpuqFWStJhdCxyKNC0WI462bgtQSGbnK+WxbHzw7nDhR832eOuZyfP97zAAAAAAAAAAAAAAAAAAAAAAAAAA7GONRhINAAAAYE+LSD9OWt/mHzE6fGZo8/mBA8lXw61lRNx+5cZLd6bq9ZXx5vrPH6+vv5ytv5DHGQwAAABgs844vTOOBwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIB+evTw7nSn7GbcT/8YESPd4g/GwdbyYBQi4vAXSQw+8bwkIgb6EH/jXkQc7xY/aaYVI1kW3eIfyjF+GhFH+hAf9rP7zf3P1W7vvzROtZbd33+DWXlRvfd/6eP930CP/c/RbcY48eCNUs/49yJODHbf/3TiJz3in95m/H/8fX2917bGqxGjXT9/kqdileqLy6Xa2vr5+cWpufJceWliYvzS5OXJi5Njpdn5Sjn72TXGf3/x5rfP6v/hHvFHtuj/mW32/5sHdx7+tF0tdIt/9nT3z9/jPeKn2Wffr7N6c/top77Rrj/p5OvvnHxW/2d69H+rv//Zbfb/3F///cE2HwoA7ILa2vrCVKVSXlFRUVF5XMl7zwQAAPTb9wf9eWcCAAAAAAAAAAAAAAAAAAAA+9dufJ3Y5pgb+XQVAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOCZvgsAAP//96DU7Q==")
r2 = open(&(0x7f0000000180)='./bus\x00', 0x14d27e, 0x0)
ioctl$AUTOFS_DEV_IOCTL_READY(r2, 0xc0189376, &(0x7f0000000000)={{0x1, 0x1, 0x18, <r3=>r0, {0x2}}, './file0/file0\x00'})
preadv(r3, &(0x7f0000000440)=[{&(0x7f00000001c0)=""/166, 0xa6}, {&(0x7f0000000280)=""/220, 0xdc}, {&(0x7f0000000080)=""/16, 0x10}, {&(0x7f0000000580)=""/169, 0xa9}, {&(0x7f0000000100)=""/59, 0x3b}, {&(0x7f0000000680)=""/250, 0xfa}], 0x6, 0xb9c, 0x4)
mlock(&(0x7f0000ffb000/0x3000)=nil, 0x3000)
msync(&(0x7f0000400000/0xc00000)=nil, 0xc00000, 0x6)
mount(&(0x7f0000000380)=@loop={'/dev/loop', 0x0}, &(0x7f0000000140)='./bus\x00', 0x0, 0x1000, 0x0)
r4 = socket$netlink(0x10, 0x3, 0x0)
sendmsg$netlink(r4, &(0x7f00000002c0)={0x0, 0x0, &(0x7f00000058c0)=[{&(0x7f0000005300)={0x14, 0x1c, 0x1, 0x0, 0x0, "", [@nested={0x4}]}, 0x14}], 0x1}, 0x0)
r5 = open(&(0x7f0000000400)='./bus\x00', 0x14113e, 0x0)
write$binfmt_script(r5, &(0x7f00000000c0), 0x208e24b)
write$binfmt_script(r2, &(0x7f0000000640)={'#! ', './file0'}, 0xb)

0s ago: executing program 3 (id=4):
syz_mount_image$vfat(&(0x7f0000000440), &(0x7f0000000000)='./file1\x00', 0x844, &(0x7f0000001e00)=ANY=[@ANYBLOB="0098c29236a106ca9a33e585c61217dc773d5170ceb0c69ff0d8f93325aefd1192e34ad0172823d9fa63c4c54a788ea25a819d2adec15e7d55f1958850fdb75b402a639650ca1e96cb3fbe428a000200002cd90c49e3eebd069b9b357e423194a2cb378d594d0d478e734b7d5f0c627f92f2319b42e9455d38d1378ef16119eb1dc185acd5ae7912d4616de6266341740ca122406609000000fa25cd52710d71f3e10b9f1c38a5bbb74f7a57cd6482cb4489d136595549c006af9db54cf60e8a37ae3cd48ca39832c4772e579d896c1785da133b53d91e3f430d819ad7a97dd6a42e1d2d04074852c5a2ed005a0b96d672a4e7d58f6be513695cfec9d3301bc29ecab76d801c5580cdcd241152f3f2114dd0c4bbf8594b2ded903577bf0f948086c9bbe617f86ba6627724b7aa0ec1cc9b8a0002f19285a5d2c9a6c5ae604426d65ea12a2e01d12affb86509b73e36524cfa1a82611a7b9eec2d74363c2de7900a7f66230f529b26316771de03069b7fa4eea21590f81a2628c950dd3dae0df1217164e11f220113fa87cbaa1e6a3b489129ae3b9aa474025ae4aa7c32127fdc5b78c5ef284dbc88a5a1c986e75142f51763e8c2b0a2"], 0x1, 0x23b, &(0x7f00000005c0)="$eJzs3bFrU10YB+C3bb6vrUuKCIIIXhDBKbQF94ooFIuKJUhFitGmUppSsFDQoa2T4OTi6OhWEXRw0/9BcHERF3G0m4P0SnslaW0qVZtcMc+z5OWe88s95wznJkNOrh+dm52aX5heW/sYfX1dURi5tZ6mXTEQ3dETmZUAAP4lX9I0PqeZvMcCALSH5z8AdJ49Pv8vtXFIAECL/f73/0cTr95XqiOn9tA17a2X7yZ/fYwAwP4an7h6fv31if7RePEwYu7+YnmxnL1m7aenYyZqUY3BKMbXiLQuq8+Njp0dTDb0R5Tnlr/nlxfLPdvzQ1GMgYgrF3bmh5LM9vx/cWBrfjiKcaj5/Yeb5v+Pk8e35EtRjDc3Yz5qMbXxkWRLfmkoSc5cHPsh37vZDwAAAAAAAAAAAAAAAAAAAAAAWqGU1A00O7+nVNqtPcvv/Xygxvk8DzbzhThSiHv5zh4AAAAAAAAAAAAAAAAAAAD+Dgt37s5WarXq7Xpx4/LMwe1XFPtcbCx8C29xLCJaPYvnq9W3Tyavjee/mG0smq/qs/wH9pOiOyI2i8OPRyovlz582tknVhpXugrZvlCpNdkskjZvTgAAAAAAAAAAAAAAAAAA0GEaPwPerUfa3gEBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQA4a////B8Vqf/Zmu/TJGp/mOk8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADrbtwAAAP//j2usdg==")
perf_event_open(&(0x7f0000000000)={0x2, 0x80, 0x6f, 0x0, 0x0, 0x0, 0x0, 0x5, 0x0, 0xc, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1000, 0x2, @perf_config_ext={0xc, 0xfffffffffffffff3}, 0x481, 0x1, 0xfffffffe}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x9)
mkdir(&(0x7f0000000080)='./file0\x00', 0x0)
mount$tmpfs(0x0, &(0x7f0000000040)='./file0\x00', &(0x7f0000000140), 0x0, &(0x7f0000000180)={[{@nr_inodes={'nr_inodes', 0x3d, [0x31]}}]})
r0 = openat$dir(0xffffffffffffff9c, &(0x7f00000000c0)='./file0\x00', 0x0, 0x0)
mknodat$null(r0, &(0x7f0000000100)='./file0\x00', 0x0, 0x103)
execve(&(0x7f00000000c0)='./file1\x00', 0x0, 0x0)

kernel console output (not intermixed with test programs):

Warning: Permanently added '[localhost]:53846' (ED25519) to the list of known hosts.
syzkaller login: [   17.745836] cgroup: Unknown subsys name 'net'
[   17.746736] cgroup: Unknown subsys name 'net_prio'
[   17.747901] cgroup: Unknown subsys name 'devices'
[   17.748825] cgroup: Unknown subsys name 'blkio'
[   17.788956] cgroup: Unknown subsys name 'hugetlb'
[   17.789872] cgroup: Unknown subsys name 'rlimit'
Setting up swapspace version 1, size = 122.1 MiB (127995904 bytes)
no label, UUID=be6e7d0a-a097-4865-95d7-b48b6335253c
[   17.866412] Adding 124996k swap on ./swap-file.  Priority:0 extents:1 across:124996k 
[   18.544646] audit: type=1400 audit(1731317043.235:6): avc:  denied  { execmem } for  pid=226 comm="syz-executor" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
[   25.128561] EXT4-fs (loop1): 1 orphan inode deleted
[   25.129594] EXT4-fs (loop1): mounted filesystem without journal. Opts: ,errors=continue
[   25.131078] ext4 filesystem being mounted at /1/file1 supports timestamps until 2038 (0x7fffffff)
[   25.134647] FAT-fs (loop3): Directory bread(block 64) failed
[   25.135751] FAT-fs (loop3): Directory bread(block 65) failed
[   25.137310] FAT-fs (loop3): Directory bread(block 66) failed
[   25.138369] FAT-fs (loop3): Directory bread(block 67) failed
[   25.139832] FAT-fs (loop3): Directory bread(block 68) failed
[   25.141138] FAT-fs (loop3): Directory bread(block 69) failed
[   25.142507] FAT-fs (loop3): Directory bread(block 70) failed
[   25.143817] FAT-fs (loop3): Directory bread(block 71) failed
[   25.145131] FAT-fs (loop3): Directory bread(block 72) failed
[   25.146441] FAT-fs (loop3): Directory bread(block 73) failed
[   25.157396] EXT4-fs error (device loop1): ext4_xattr_block_get:536: inode #16: comm syz.1.5: corrupted xattr block 37
[   25.164569] audit: type=1400 audit(1731317049.855:7): avc:  denied  { open } for  pid=2041 comm="syz.3.4" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=perf_event permissive=1
[   25.168656] audit: type=1400 audit(1731317049.859:8): avc:  denied  { kernel } for  pid=2041 comm="syz.3.4" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=perf_event permissive=1
[   25.174155] ------------[ cut here ]------------
[   25.182481] kernel BUG at fs/ext4/ext4.h:3196!
[   25.183396] invalid opcode: 0000 [#1] PREEMPT SMP KASAN NOPTI
[   25.184470] CPU: 0 PID: 2034 Comm: syz.1.5 Not tainted 5.10.0 #1
[   25.185495] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   25.188176] RIP: 0010:ext4_get_group_info+0x3cb/0x440
[   25.189365] Code: ff 48 c7 c2 80 c5 52 84 be b3 02 00 00 48 c7 c7 e0 c4 52 84 c6 05 2d 0a 2c 04 01 e8 88 03 34 02 e9 9b fe ff ff e8 45 f0 9d ff <0f> 0b 48 c7 c7 60 75 30 85 e8 46 6d 38 02 e8 72 20 cb ff e9 81 fc
[   25.192450] RSP: 0018:ffff88800c6a6f40 EFLAGS: 00010212
[   25.193334] RAX: 0000000000005974 RBX: 0000000000000001 RCX: ffffc90000da3000
[   25.194519] RDX: 0000000000040000 RSI: ffffffff81a81e7b RDI: 0000000000000004
[   25.195742] RBP: ffff888012aa4000 R08: 0000000000000000 R09: ffff888013ea9407
[   25.196912] R10: 0000000000000001 R11: 0000000000000001 R12: ffff888012aa2000
[   25.198090] R13: ffff888012aa2650 R14: 0000000000000001 R15: 0000000000000001
[   25.199269] FS:  00007fec7b9596c0(0000) GS:ffff88806ce00000(0000) knlGS:0000000000000000
[   25.200615] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[   25.201588] CR2: 000000110c2b60a5 CR3: 000000000acb8000 CR4: 0000000000350ef0
[   25.202790] Call Trace:
[   25.203222]  ext4_mb_find_by_goal+0xf4/0x1030
[   25.203948]  ? __kasan_kmalloc.constprop.0+0xc2/0xd0
[   25.204789]  ? kmem_cache_alloc+0x145/0x330
[   25.205511]  ? ext4_mb_new_blocks+0x2261/0x4b60
[   25.206289]  ? ext4_ext_map_blocks+0x1f8e/0x5d50
[   25.207056]  ? __iomap_dio_rw+0x6cd/0x1200
[   25.207743]  ? ext4_mb_use_best_found+0x8e0/0x8e0
[   25.208544]  ? vfs_write+0x81b/0xac0
[   25.209174]  ? ksys_write+0x12d/0x250
[   25.209784]  ? do_syscall_64+0x33/0x40
[   25.210033] attempt to access beyond end of device
[   25.210033] loop3: rw=524288, want=1772, limit=256
[   25.210409]  ? entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   25.210418]  ? __bfs+0x740/0x740
[   25.210428]  ext4_mb_regular_allocator+0x235/0x1ee0
[   25.210440]  ? find_held_lock+0x2c/0x110
[   25.212041] attempt to access beyond end of device
[   25.212041] loop3: rw=0, want=1772, limit=256
[   25.212869]  ? ext4_mb_use_preallocated.constprop.0+0xb11/0x10a0
[   25.212878]  ? lock_downgrade+0x6d0/0x6d0
[   25.212888]  ? ext4_mb_prefetch_fini+0x350/0x350
[   25.212901]  ? rcu_read_lock_sched_held+0x3a/0x70
[   25.219572]  ? kmem_cache_alloc+0x302/0x330
[   25.220285]  ext4_mb_new_blocks+0x2322/0x4b60
[   25.221018]  ? kasan_unpoison_shadow+0x33/0x40
[   25.221796]  ? ext4_cache_extents+0x68/0x2d0
[   25.222521]  ? __kasan_kmalloc.constprop.0+0xc2/0xd0
[   25.223345]  ? ext4_discard_preallocations+0xe70/0xe70
[   25.224208]  ? ext4_ext_search_right+0x2e3/0xcc0
[   25.224978]  ? ext4_inode_to_goal_block+0x340/0x440
[   25.225787]  ext4_ext_map_blocks+0x1f8e/0x5d50
[   25.226538]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   25.227387]  ? perf_trace_lock+0xed/0x600
[   25.228061]  ? ext4_ext_release+0x10/0x10
[   25.228749]  ? lock_release+0x6f0/0x6f0
[   25.229422]  ? down_write_killable_nested+0x180/0x180
[   25.230283]  ext4_map_blocks+0x700/0x1740
[   25.230956]  ? ext4_issue_zeroout+0x1e0/0x1e0
[   25.231673]  ? ext4_journal_check_start+0x1ae/0x290
[   25.232474]  ? __ext4_journal_start_sb+0x1db/0x490
[   25.233260]  ? ext4_meta_trans_blocks+0x25c/0x310
[   25.234038]  ext4_iomap_begin+0x3ec/0x760
[   25.234719]  ? ext4_iomap_begin_report+0x600/0x600
[   25.235519]  ? __kasan_kmalloc.constprop.0+0xc2/0xd0
[   25.236356]  ? __iomap_dio_rw+0x1ee/0x1200
[   25.237045]  iomap_apply+0x164/0xb10
[   25.237669]  ? iomap_dio_rw+0x90/0x90
[   25.238290]  ? trace_event_raw_event_iomap_apply+0x430/0x430
[   25.239236]  ? filemap_check_errors+0xa5/0x150
[   25.239970]  __iomap_dio_rw+0x6cd/0x1200
[   25.240628]  ? iomap_dio_rw+0x90/0x90
[   25.241259]  ? iomap_dio_bio_actor+0xfc0/0xfc0
[   25.242002]  ? ext4_orphan_add+0x253/0x9d0
[   25.242693]  ? ext4_empty_dir+0x9f0/0x9f0
[   25.243367]  ? ext4_journal_check_start+0x1ae/0x290
[   25.244183]  iomap_dio_rw+0x31/0x90
[   25.244773]  ext4_file_write_iter+0xc55/0x1b20
[   25.245531]  ? ext4_file_read_iter+0x4c0/0x4c0
[   25.246286]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   25.247171]  new_sync_write+0x42c/0x670
[   25.247828]  ? new_sync_read+0x6f0/0x6f0
[   25.248511]  ? lock_release+0x6f0/0x6f0
[   25.249193]  ? selinux_file_permission+0xcc/0x590
[   25.249997]  vfs_write+0x81b/0xac0
[   25.250591]  ksys_write+0x12d/0x250
[   25.251192]  ? __ia32_sys_read+0xb0/0xb0
[   25.251839]  ? syscall_enter_from_user_mode+0x27/0x80
[   25.252682]  do_syscall_64+0x33/0x40
[   25.253270]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   25.254128] RIP: 0033:0x7fec7ccdfef9
[   25.254731] Code: ff ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 a8 ff ff ff f7 d8 64 89 01 48
[   25.257833] RSP: 002b:00007fec7b959038 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
[   25.259117] RAX: ffffffffffffffda RBX: 00007fec7ce97f80 RCX: 00007fec7ccdfef9
[   25.260289] RDX: 000000000000000b RSI: 0000000020000640 RDI: 0000000000000005
[   25.261470] RBP: 00007fec7cd52b76 R08: 0000000000000000 R09: 0000000000000000
[   25.262658] R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
[   25.263813] R13: 0000000000000000 R14: 00007fec7ce97f80 R15: 00007fff58cb3978
[   25.264971] Modules linked in:
[   25.267571] ---[ end trace 7d6a13badd27f4a2 ]---
[   25.268701] RIP: 0010:ext4_get_group_info+0x3cb/0x440
[   25.269667] Code: ff 48 c7 c2 80 c5 52 84 be b3 02 00 00 48 c7 c7 e0 c4 52 84 c6 05 2d 0a 2c 04 01 e8 88 03 34 02 e9 9b fe ff ff e8 45 f0 9d ff <0f> 0b 48 c7 c7 60 75 30 85 e8 46 6d 38 02 e8 72 20 cb ff e9 81 fc
[   25.273950] RSP: 0018:ffff88800c6a6f40 EFLAGS: 00010212
[   25.275285] RAX: 0000000000005974 RBX: 0000000000000001 RCX: ffffc90000da3000
[   25.280315] RDX: 0000000000040000 RSI: ffffffff81a81e7b RDI: 0000000000000004
[   25.285378] RBP: ffff888012aa4000 R08: 0000000000000000 R09: ffff888013ea9407
[   25.286703] R10: 0000000000000001 R11: 0000000000000001 R12: ffff888012aa2000
[   25.288139] R13: ffff888012aa2650 R14: 0000000000000001 R15: 0000000000000001
[   25.289466] FS:  00007fec7b9596c0(0000) GS:ffff88806cf00000(0000) knlGS:0000000000000000
[   25.292122] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[   25.293227] CR2: 00007f8677c6b6f4 CR3: 000000000acb8000 CR4: 0000000000350ee0
[   25.923132] EXT4-fs error (device loop1): ext4_readdir:243: inode #2: block 3: comm syz-executor: path /1/file1: bad entry in directory: rec_len is smaller than minimal - offset=0, inode=0, rec_len=0, name_len=0, size=4096
[   25.940163] syz-executor (233) used greatest stack depth: 24088 bytes left
[   30.503510] EXT4-fs warning (device loop1): kmmpd:182: kmmpd being stopped since MMP feature has been disabled.

VM DIAGNOSIS:
17:24:10  Registers:
info registers vcpu 0

CPU#0
RAX=dffffc0000000060 RBX=0000000000000005 RCX=0000000000000000 RDX=00000000000003fd
RSI=ffffffff823c0aec RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff88800c6a68b8
R8 =0000000000000000 R9 =ffffffff85d66c0f R10=000000000000001f R11=0000000000000001
R12=0000000000000000 R13=fffffbfff0f492a7 R14=fffffbfff0f4925e R15=dffffc0000000000
RIP=ffffffff823c0b14 RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007fec7b9596c0 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=000000110c2b60a5 CR3=000000000acb8000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM02=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM03=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM04=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM05=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM06=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM07=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 00007fec7cd53b19
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=0000000000000005 RBX=1ffff11001728f1d RCX=ffffffff860a38b9 RDX=0000000000000000
RSI=0000000000000001 RDI=0000000000000001 RBP=0000000000000001 RSP=ffff88800b947898
R8 =ffffffff860a38b4 R9 =ffffffff860a38b8 R10=ffffed1001728f3b R11=000000000000fc36
R12=ffff88800b9479c8 R13=ffff88800b9479b5 R14=ffff88800b9479d0 R15=ffff88800b947980
RIP=ffffffff8112a987 RFL=00000246 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007f441ca3e8c0 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f3215b56e48 CR3=000000000c03a000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 002f2e2e2f002e2e
YMM01=0000000000000000 0000000000000000 0000000000000000 00006c696146002f
YMM02=0000000000000000 0000000000000000 ffffffffffffffff ff0f0e0d0c0b0a09
YMM03=0000000000000000 0000000000000000 0000000000000031 000065636172742f
YMM04=0000000000000000 0000000000000000 2f2f2f2f2f2f2f2f 2f2f2f2f2f2f2f2f
YMM05=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM06=0000000000000000 0000000000000000 0000564277821660 0000000400000002
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 3a212d2b007b3d0d 0a0920002c0d0a09
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000002000000000 0000002000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
