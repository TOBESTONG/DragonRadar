Warning: Permanently added '[localhost]:6979' (ED25519) to the list of known hosts.
syzkaller login: [   20.679888] audit: type=1400 audit(1731173348.380:6): avc:  denied  { execmem } for  pid=236 comm="syz-executor900" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
executing program
[   24.789265] EXT4-fs (loop0): Unsupported encryption level 16
[   24.813383] EXT4-fs (loop0): 1 truncate cleaned up
[   24.814215] EXT4-fs (loop0): mounted filesystem without journal. Opts: ,errors=continue
[   24.856024] EXT4-fs error (device loop0): ext4_xattr_ibody_get:593: inode #15: comm syz-executor900: corrupted in-inode xattr
[   24.859193] ==================================================================
[   24.860713] BUG: KASAN: use-after-free in get_max_inline_xattr_value_size+0x49c/0x510
[   24.862187] Read of size 4 at addr ffff88801169e01c by task syz-executor900/237
[   24.863528] 
[   24.863850] CPU: 0 PID: 237 Comm: syz-executor900 Not tainted 5.10.0 #1
[   24.865055] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   24.866820] Call Trace:
[   24.867268]  dump_stack+0x107/0x163
[   24.868441]  ? get_max_inline_xattr_value_size+0x49c/0x510
[   24.869475]  ? get_max_inline_xattr_value_size+0x49c/0x510
[   24.870491]  print_address_description.constprop.0+0x1c/0x210
[   24.871500]  ? _raw_spin_lock_irqsave+0x4e/0x50
[   24.876132]  ? vprintk_func+0x95/0x250
[   24.876920]  ? get_max_inline_xattr_value_size+0x49c/0x510
[   24.877912]  ? get_max_inline_xattr_value_size+0x49c/0x510
[   24.882770]  kasan_report.cold+0x37/0x7c
[   24.883502]  ? down_write+0x130/0x150
[   24.887494]  ? get_max_inline_xattr_value_size+0x49c/0x510
[   24.888623]  get_max_inline_xattr_value_size+0x49c/0x510
[   24.889647]  ext4_get_max_inline_size.part.0+0xa8/0x180
[   24.890634]  ? get_max_inline_xattr_value_size+0x510/0x510
[   24.895670]  ? mark_lock+0xf5/0x32b0
[   24.896372]  ext4_try_to_write_inline_data+0xf1/0x1500
[   24.897404]  ? unlock_page_memcg+0xab/0x160
[   24.898216]  ? lock_downgrade+0x6d0/0x6d0
[   24.903027]  ? ext4_readpage_inline+0x410/0x410
[   24.903914]  ? mark_buffer_dirty+0x39e/0x4e0
[   24.904675]  ? ext4_ind_trans_blocks+0x75/0xa0
[   24.905566]  ? ext4_meta_trans_blocks+0x25c/0x310
[   24.906446]  ? ext4_inode_journal_mode+0x274/0x4f0
[   24.910360]  ext4_write_begin+0xbb5/0x1170
[   24.911205]  ? ext4_truncate+0x1390/0x1390
[   24.911964]  ? find_held_lock+0x2c/0x110
[   24.912700]  ext4_da_write_begin+0x61e/0xe60
[   24.913510]  ? do_raw_spin_lock+0x121/0x260
[   24.918312]  ? iov_iter_fault_in_readable+0x1f9/0x3f0
[   24.919327]  ? ext4_write_begin+0x1170/0x1170
[   24.920183]  ? copyout_mc+0x140/0x140
[   24.920892]  ? rcu_read_lock_sched_held+0x3a/0x70
[   24.921747]  ? __mark_inode_dirty+0x691/0x11a0
[   24.926623]  generic_perform_write+0x1fe/0x4d0
[   24.927510]  ? trace_event_raw_event_file_check_and_advance_wb_err+0x4a0/0x4a0
[   24.931867]  ? down_write_killable_nested+0x180/0x180
[   24.932877]  ext4_buffered_write_iter+0x244/0x4d0
[   24.933760]  ext4_file_write_iter+0x431/0x1b20
[   24.934598]  ? __lock_acquire+0x1661/0x5ca0
[   24.939468]  ? ext4_file_read_iter+0x4c0/0x4c0
[   24.940342]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   24.941295]  new_sync_write+0x42c/0x670
[   24.942029]  ? new_sync_read+0x6f0/0x6f0
[   24.945828]  ? lock_release+0x6f0/0x6f0
[   24.946579]  ? selinux_file_permission+0xcc/0x590
[   24.947549]  vfs_write+0x81b/0xac0
[   24.948224]  ksys_write+0x12d/0x250
[   24.948878]  ? __ia32_sys_read+0xb0/0xb0
[   24.949591]  ? syscall_enter_from_user_mode+0x27/0x80
[   24.953586]  do_syscall_64+0x33/0x40
[   24.954298]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   24.955283] RIP: 0033:0x7f0a93087b7d
[   24.955971] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[   24.963642] RSP: 002b:00007fff33b99138 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
[   24.969118] RAX: ffffffffffffffda RBX: 0000000000000003 RCX: 00007f0a93087b7d
[   24.970401] RDX: 000000000000000b RSI: 0000000020000580 RDI: 0000000000000004
[   24.971672] RBP: 00007fff33b99150 R08: 0000555555bb3440 R09: 0000555555bb3440
[   24.975948] R10: 0000555555bb3440 R11: 0000000000000246 R12: 0000000000000003
[   24.977200] R13: 00007fff33b99220 R14: 00007fff33b99200 R15: 0000000000000001
[   24.978515] 
[   24.985877] The buggy address belongs to the page:
[   24.986746] page:0000000061690692 refcount:0 mapcount:-128 mapping:0000000000000000 index:0x0 pfn:0x1169e
[   24.988532] flags: 0x100000000000000()
[   24.989247] raw: 0100000000000000 ffffea0000375488 ffffea0000302b08 0000000000000000
[   24.990670] raw: 0000000000000000 0000000000000001 00000000ffffff7f 0000000000000000
[   24.992053] page dumped because: kasan: bad access detected
[   24.997136] 
[   24.997428] Memory state around the buggy address:
[   24.998353]  ffff88801169df00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[   24.999705]  ffff88801169df80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[   25.005107] >ffff88801169e000: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
[   25.006465]                             ^
[   25.007292]  ffff88801169e080: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
[   25.008677]  ffff88801169e100: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
[   25.016060] ==================================================================
[   25.017366] Disabling lock debugging due to kernel taint
[   25.074057] syz-executor900 (237) used greatest stack depth: 23904 bytes left

VM DIAGNOSIS:
01:29:12  Registers:
info registers vcpu 0

CPU#0
RAX=dffffc0000000060 RBX=0000000000000005 RCX=0000000000000000 RDX=00000000000003fd
RSI=ffffffff823c0aec RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff88800df56f40
R8 =0000000000000001 R9 =0000000000000003 R10=000000000000001f R11=0000000000000001
R12=0000000000000000 R13=fffffbfff0f492a7 R14=fffffbfff0f4925e R15=dffffc0000000000
RIP=ffffffff823c0b14 RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000555555bb3480 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00000000200401bf CR3=000000000ffac000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM02=0000000000000000 0000000000000000 0000000000ff0000 00000000000000ff
YMM03=0000000000000000 0000000000000000 0000000000ff0000 00000000000000ff
YMM04=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM05=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM06=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=ffffffff83eca430 RBX=ffff888008250000 RCX=ffffffff83eb246c RDX=0000000000000000
RSI=0000000000000001 RDI=0000000000000000 RBP=0000000000000001 RSP=ffff88800825fe78
R8 =0000000000000001 R9 =ffff88806cf3416b R10=ffffed100d9e682d R11=0000000000000001
R12=ffffed100104a000 R13=ffffffff85d66c08 R14=0000000000000000 R15=dffffc0000000000
RIP=ffffffff83eca43e RFL=00000202 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=1
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=000055c536268308 CR3=000000000bfd0000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 ffffffff00000002 000055c53625cae0
YMM02=0000000000000000 0000000000000000 ffffff0f0e0d0c0b 0a09080706050403
YMM03=0000000000000000 0000000000000000 696e656420737365 636341002f737973
YMM04=0000000000000000 0000000000000000 414d003638323936 3030313d44455a49
YMM05=0000000000000000 0000000000000000 313d4d554e514553 006b7369643d4550
YMM06=0000000000000000 0000000000000000 3d454d414e564544 00303d444955555f
YMM07=0000000000000000 0000000000000000 5953425553003070 6f6f6c2f6b636f6c
YMM08=0000000000000000 0000000000000000 49006d756e203c20 69000a313a56000a
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
