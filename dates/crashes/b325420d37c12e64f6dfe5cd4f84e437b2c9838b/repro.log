Warning: Permanently added '[localhost]:13242' (ED25519) to the list of known hosts.
executing program
syzkaller login: [   52.198509] audit: type=1400 audit(1730916035.104:6): avc:  denied  { execmem } for  pid=236 comm="syz-executor389" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
[   52.232985] EXT4-fs (loop0): mounted filesystem without journal. Opts: ,errors=continue
[   52.234479] ext4 filesystem being mounted at /file0 supports timestamps until 2038 (0x7fffffff)
[   52.245145] 
[   52.245441] ======================================================
[   52.246454] WARNING: possible circular locking dependency detected
[   52.247493] 5.10.0 #1 Not tainted
[   52.248056] ------------------------------------------------------
[   52.249097] syz-executor389/236 is trying to acquire lock:
[   52.250530] ffff888018882828 (&ei->xattr_sem){++++}-{3:3}, at: ext4_xattr_set_handle+0x15e/0x12b0
[   52.253944] 
[   52.253944] but task is already holding lock:
[   52.255955] ffff888018882be8 (&ea_inode->i_rwsem#14/1){+.+.}-{3:3}, at: vfs_setxattr+0xca/0x270
[   52.258368] 
[   52.258368] which lock already depends on the new lock.
[   52.258368] 
[   52.260569] 
[   52.260569] the existing dependency chain (in reverse order) is:
[   52.262593] 
[   52.262593] -> #1 (&ea_inode->i_rwsem#14/1){+.+.}-{3:3}:
[   52.264530]        down_write+0x8d/0x150
[   52.265673]        ext4_xattr_set_entry+0x299e/0x37c0
[   52.267119]        ext4_xattr_block_set+0x834/0x2f50
[   52.268544]        ext4_xattr_set_handle+0xd01/0x12b0
[   52.269982]        ext4_xattr_set+0x13a/0x340
[   52.271206]        __vfs_setxattr+0x10f/0x170
[   52.272415]        __vfs_setxattr_noperm+0x11a/0x4c0
[   52.273795]        __vfs_setxattr_locked+0x1bf/0x250
[   52.275138]        vfs_setxattr+0xe8/0x270
[   52.276298]        setxattr+0x23d/0x330
[   52.277374]        path_setxattr+0x170/0x190
[   52.278556]        __x64_sys_setxattr+0xc0/0x160
[   52.279823]        do_syscall_64+0x33/0x40
[   52.280976]        entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   52.282349] 
[   52.282349] -> #0 (&ei->xattr_sem){++++}-{3:3}:
[   52.283340]        __lock_acquire+0x2ac4/0x5ca0
[   52.284077]        lock_acquire+0x293/0x9b0
[   52.284761]        down_write+0x8d/0x150
[   52.285422]        ext4_xattr_set_handle+0x15e/0x12b0
[   52.286232]        ext4_xattr_set+0x13a/0x340
[   52.286966]        __vfs_setxattr+0x10f/0x170
[   52.287685]        __vfs_setxattr_noperm+0x11a/0x4c0
[   52.288576]        __vfs_setxattr_locked+0x1bf/0x250
[   52.289374]        vfs_setxattr+0xe8/0x270
[   52.290054]        setxattr+0x23d/0x330
[   52.290708]        path_setxattr+0x170/0x190
[   52.291405]        __x64_sys_lsetxattr+0xbd/0x150
[   52.292176]        do_syscall_64+0x33/0x40
[   52.292886]        entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   52.293812] 
[   52.293812] other info that might help us debug this:
[   52.293812] 
[   52.295088]  Possible unsafe locking scenario:
[   52.295088] 
[   52.296019]        CPU0                    CPU1
[   52.296766]        ----                    ----
[   52.297510]   lock(&ea_inode->i_rwsem#14/1);
[   52.298219]                                lock(&ei->xattr_sem);
[   52.299192]                                lock(&ea_inode->i_rwsem#14/1);
[   52.300312]   lock(&ei->xattr_sem);
[   52.300878] 
[   52.300878]  *** DEADLOCK ***
[   52.300878] 
[   52.301867] 2 locks held by syz-executor389/236:
[   52.302617]  #0: ffff8880106ee438 (sb_writers#3){.+.+}-{0:0}, at: path_setxattr+0xb5/0x190
[   52.303987]  #1: ffff888018882be8 (&ea_inode->i_rwsem#14/1){+.+.}-{3:3}, at: vfs_setxattr+0xca/0x270
[   52.305461] 
[   52.305461] stack backtrace:
[   52.306173] CPU: 1 PID: 236 Comm: syz-executor389 Not tainted 5.10.0 #1
[   52.307245] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   52.308799] Call Trace:
[   52.309219]  dump_stack+0x107/0x163
[   52.309763]  check_noncircular+0x25f/0x2e0
[   52.310429]  ? print_circular_bug+0x450/0x450
[   52.311131]  ? mark_lock+0xf5/0x32b0
[   52.311716]  ? _raw_spin_unlock_irqrestore+0x2f/0x50
[   52.312551]  ? alloc_chain_hlocks+0x4bf/0xc80
[   52.313279]  __lock_acquire+0x2ac4/0x5ca0
[   52.313952]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   52.314817]  ? print_irqtrace_events+0x270/0x270
[   52.315608]  lock_acquire+0x293/0x9b0
[   52.316249]  ? ext4_xattr_set_handle+0x15e/0x12b0
[   52.317055]  ? lock_release+0x6f0/0x6f0
[   52.317726]  down_write+0x8d/0x150
[   52.318307]  ? ext4_xattr_set_handle+0x15e/0x12b0
[   52.319060]  ? down_write_killable_nested+0x180/0x180
[   52.319868]  ? avc_has_perm_noaudit+0x1c7/0x3e0
[   52.320604]  ext4_xattr_set_handle+0x15e/0x12b0
[   52.321360]  ? ext4_xattr_ibody_inline_set+0x2b0/0x2b0
[   52.322184]  ? avc_has_perm_noaudit+0x1ee/0x3e0
[   52.322921]  ? ext4_journal_check_start+0x1ae/0x290
[   52.323725]  ? __ext4_journal_start_sb+0x1db/0x490
[   52.324518]  ext4_xattr_set+0x13a/0x340
[   52.325139]  ? ext4_xattr_set_credits+0x210/0x210
[   52.325910]  ? xattr_resolve_name+0x26e/0x3d0
[   52.326639]  ? ext4_xattr_hurd_get+0xf0/0xf0
[   52.327351]  __vfs_setxattr+0x10f/0x170
[   52.327968]  ? xattr_resolve_name+0x3d0/0x3d0
[   52.328701]  ? security_capable+0x95/0xc0
[   52.329365]  __vfs_setxattr_noperm+0x11a/0x4c0
[   52.330093]  __vfs_setxattr_locked+0x1bf/0x250
[   52.330805]  vfs_setxattr+0xe8/0x270
[   52.331402]  ? __vfs_setxattr_locked+0x250/0x250
[   52.332141]  ? strncpy_from_user+0x9e/0x490
[   52.332820]  setxattr+0x23d/0x330
[   52.333369]  ? vfs_setxattr+0x270/0x270
[   52.333993]  ? filename_lookup+0x3b6/0x560
[   52.334662]  ? lock_release+0x6f0/0x6f0
[   52.335289]  ? preempt_count_add+0x74/0x140
[   52.335956]  ? __mnt_want_write+0x1bc/0x2a0
[   52.336629]  path_setxattr+0x170/0x190
[   52.337227]  ? setxattr+0x330/0x330
[   52.337782]  __x64_sys_lsetxattr+0xbd/0x150
[   52.338447]  ? syscall_enter_from_user_mode+0x27/0x80
[   52.339265]  do_syscall_64+0x33/0x40
[   52.339837]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   52.340650] RIP: 0033:0x7f725830fa8d
[   52.341233] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[   52.344090] RSP: 002b:00007ffc849ffba8 EFLAGS: 00000246 ORIG_RAX: 00000000000000bd
[   52.345314] RAX: ffffffffffffffda RBX: 0030656c69662f2e RCX: 00007f725830fa8d
[   52.346449] RDX: 0000000000000000 RSI: 0000000020000280 RDI: 0000000020000240
[   52.347584] RBP: 00007ffc849ffc60 R08: 0000000000000000 R09: 0000000000000000
[   52.348714] R10: 0000000000000000 R11: 0000000000000246 R12: 00007ffc849ffcd8
[   52.349835] R13: 00007ffc849ffce8 R14: 00007f725839dd10 R15: 0000000000000001

VM DIAGNOSIS:
02:00:35  Registers:
info registers vcpu 0

CPU#0
RAX=fffffbfff0bacd81 RBX=fffffbfff0bacd82 RCX=ffffffff812ad82f RDX=0000000000000001
RSI=0000000000000008 RDI=ffffffff85d66c08 RBP=fffffbfff0bacd81 RSP=ffff8880093efad8
R8 =0000000000000000 R9 =ffffffff85d66c0f R10=fffffbfff0bacd81 R11=0000000000000001
R12=0000000000000002 R13=ffffffff850e7f00 R14=0000000000000000 R15=0000000000000000
RIP=ffffffff81733c04 RFL=00000202 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007f06f1b4b8c0 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007fffac210f20 CR3=000000000fca2000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 372f6b636f6c622f 7665642f7379732f
YMM01=0000000000000000 0000000000000000 00303a372f6b636f 6c622f7665642f73
YMM02=0000000000000000 0000000000000000 00ff000000000000 0000000000000000
YMM03=0000000000000000 0000000000000000 696e656420737365 636341002f737973
YMM04=0000000000000000 0000000000000000 0000000100000000 000055d8ca815940
YMM05=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM06=0000000000000000 0000000000000000 000055d8ca81a9e0 0000000200000004
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 610064253a64252f 6b636f6c622f7665
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=000000000000002f RBX=0000000000000000 RCX=0000000000000000 RDX=00000000000003f8
RSI=ffffffff823c0a41 RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff888010da6e88
R8 =0000000000000001 R9 =0000000000000003 R10=000000000000001f R11=0000000000000001
R12=000000000000002f R13=0000000000000000 R14=ffffffff87a492a0 R15=dffffc0000000000
RIP=ffffffff823c0a6c RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000555557391380 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=000056390bbfd160 CR3=000000000fe82000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 2e79616c7265766f 2e64657473757274
YMM01=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM02=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM03=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM04=0000000000000000 0000000000000000 00007f7258390d60 00007f72583a2b60
YMM05=0000000000000000 0000000000000000 0000000000000001 0000000000000001
YMM06=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
