last executing test programs:

189.639753ms ago: executing program 0 (id=1):
syz_mount_image$ext4(&(0x7f0000001140)='ext4\x00', &(0x7f00000000c0)='./file0\x00', 0x4000, &(0x7f0000000040)={[], [{@audit}, {@obj_type={'obj_type', 0x3d, '@}{#'}}, {@fscontext={'fscontext', 0x3d, 'sysadm_u'}}, {@smackfstransmute}]}, 0x1, 0x774, &(0x7f0000000800)="$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")
perf_event_open(&(0x7f00000004c0)={0x1, 0x80, 0x2, 0x0, 0x0, 0x0, 0x0, 0x1, 0x26004, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffff7ffffffffffb, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x8000, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_bp={0x0}, 0x2000, 0x0, 0x0, 0x9}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
perf_event_open(&(0x7f00000004c0)={0x1, 0x80, 0x2, 0x0, 0x0, 0x0, 0x0, 0x1, 0x2, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffff7ffffffffffb, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x8000, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_bp={0x0}, 0x0, 0x0, 0x0, 0x9}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
syz_mount_image$ext4(&(0x7f0000000780)='ext4\x00', &(0x7f0000000080)='./file0\x00', 0x0, &(0x7f0000000000), 0x1, 0x78e, &(0x7f00000016c0)="$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")

102.930305ms ago: executing program 0 (id=5):
ioctl$AUTOFS_DEV_IOCTL_CATATONIC(0xffffffffffffffff, 0xc0189379, &(0x7f0000000000)={{0x1, 0x1, 0x18, <r0=>0xffffffffffffffff}, './file0\x00'})
r1 = syz_genetlink_get_family_id$devlink(&(0x7f0000000080), 0xffffffffffffffff)
sendmsg$DEVLINK_CMD_RATE_NEW(r0, &(0x7f0000000140)={&(0x7f0000000040)={0x10, 0x0, 0x0, 0x1}, 0xc, &(0x7f0000000100)={&(0x7f00000000c0)={0x30, r1, 0x200, 0x70bd2c, 0x25dfdbfc, {}, [@DEVLINK_ATTR_RATE_TX_SHARE={0xc, 0xa6, 0x3}, @DEVLINK_ATTR_RATE_NODE_NAME={0xf, 0xa8, @name2}]}, 0x30}, 0x1, 0x0, 0x0, 0x4000000}, 0x40)
r2 = openat$sysfs(0xffffffffffffff9c, &(0x7f0000000240)='/sys/power/sync_on_suspend', 0x0, 0x0)
read$FUSE(r2, &(0x7f0000002380)={0x2020}, 0x2020)

68.118794ms ago: executing program 0 (id=6):
perf_event_open(&(0x7f000001d000)={0x1, 0x80, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_bp={0x0}}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
add_key$fscrypt_v1(&(0x7f0000000000), &(0x7f0000000040)={'fscrypt:', @desc3}, 0x0, 0xfe, 0xffffffffffffffff)
syz_mount_image$msdos(&(0x7f0000000040), &(0x7f0000000080)='./file0\x00', 0x2, &(0x7f0000002540)=ANY=[@ANYBLOB="646f7473e0ff6d61736b3d304f0600000030303030303030303030303132353730322c6e66733d6e6f7374616c655f726f2c646f74732c6e6f646f74732c6e6f646f742c757365667265652c67696442000000000000000000000000009b457a81712df9742b8eb1b8f1da4bc098fb83c44a53602d094527e09fec", @ANYRESHEX=0xee01, @ANYBLOB=',tz=UTC,dots,dots,nodots,quiet,discard,nocase,dots,dots,tz=UTC,gid=', @ANYRESHEX=0x0, @ANYBLOB=',dots,\x00'], 0x4, 0x18e, &(0x7f0000002380)="$eJzs3bFq21AUBuBj17VNJ29dOgi6dDJtX6AuxYVSQaHFQzs14GSxQyBelEx+jDxgHiB48uaQyLES42QIWCL29y068Ouie5C4mnT1/93xaHgyObp8exHtdi3qvejFvBadqMedaQAAu2S+WMTVIlf1XACAcnj/A8D++fP338+vadr/nSTtiNk0G2SD/Jjn33+k/Y/JrU4xapZlg1er/FOeJw/z1/FmmX/emDfjw/s8v8m+/UrX8lYMt98+AAAAAAAAAAAAAAAAAAAAAABUopusbNzfp9t9LM+re/sDre3f04hGaV0AAAAAAAAAAAAAAAAAAADAyzY5Ox8djMeHpwpFOcWX7V8ieeKc1vLJL6PleN7wZkRUfpuKNaJV1eIEAAAAAAAAAAAAAAAAAAB7pvjot+qZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEB1iv//b6+oukcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB233UAAAD//+WtMYQ=")
r0 = inotify_init1(0xc0800)
clock_gettime(0x0, 0x0)
setitimer(0x0, &(0x7f0000000380)={{}, {0x77359400}}, 0x0)
r1 = open(&(0x7f0000000180)='./bus\x00', 0x14937e, 0x0)
ioctl$RNDGETENTCNT(r1, 0x80045200, 0x0)
perf_event_open(&(0x7f000001d000)={0x1, 0x80, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_bp={0x0}}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
r2 = socket$nl_audit(0x10, 0x3, 0x9)
ioctl$sock_SIOCETHTOOL(r2, 0x8946, &(0x7f0000000040)={'sit0\x00', &(0x7f0000000080)=@ethtool_drvinfo={0x3, "d03806390d882add6b5588081876fb5ca64774f6ceaabfe2e057da675f693fb0", "8acccab9c09aec49128d0e85e3d70a501efdef871fe8e02229ade9594ceed9eb", "25b13b55d709c6417a689f60b6fbed9a27b7ee404df4e825b7193a38d3c2b747", "acd7c4db6c4e20ec48796f98fff04c1c151dd685d3616dff7ff0b429dce707f6", "a012bb0a2d7376df680bbc83397023ebd521e7cdaf26ed3dd0f05403091a5b1c", "a279246aebf7c20f0fbb426c"}})
r3 = openat$cdrom(0xffffffffffffff9c, 0x0, 0x800, 0x0)
syz_mount_image$ext4(&(0x7f0000000440)='ext4\x00', &(0x7f0000000100)='./file1\x00', 0x0, &(0x7f0000000200), 0x2, 0x449, &(0x7f0000000d00)="$eJzs3MtvG8UfAPDvrpP29+uDhFIeLYUaCiLikTRpgR44AAKJA0hIcChHk6RVqdugJki0qqAgVI6oEicuiCMSfwEnuCDghMQRuKNKFeqlgZPR2ruJk9huHg5O689H2mTGM/bMd3dnM/twAuhb5exHErErIn6PiKFGdmmFcuPX/PWLk39fvziZRK32xl9Jvd6N6xcni6rF+3bmmZE0Iv0kWfaBDbPnL5yuVKvT5/L82NyZd8dmz1946tSZysnpk9NnJ44dO3pk/NlnJp7uSpxZXDf2fzBzYN8rb115bfL4lbd/+ibr1q68vDmObilHuVXodY92u7Ee292UTgZ62BHWpBQR2eYarI//oSjF4sYbipc/7mnngE1Vq9Vq29sXX6oBt7Eket0DoDeKP/TZ+W+x/EdTjy3h2guNE6As7vl8aZQMRJrXGVx2fttN5Yg4fumfL7MlNuk6BABAs++y+c+TreZ/adzTVO+O/B7KcETcGRF7IuKuiNgbEXdH1OveGxH3rbH98rL8yvlPenVdga1SNv97Lr+3tXT+V8z+YriU53bX4x9MTpyqTh/O18lIDG7P8uMd2vj+pV8/a1fWPP/Llqz9Yi6Y9+PqwLILdFOVucpGYm527aOI/QOt4k8W7gQkEbEvIvavs41Tj399oF3ZzePvoAv3mWpfRTzW2P6XYln8haTz/cmx/0V1+vBYsVes9PMvl19v1/6G4u+CbPvvaLn/L8Q/nDTfr51dexuX//i07TnNevf/bcmb9fS2/LX3K3Nz58YjtiWvrnx9YvG9Rb6on8U/cqj1+N8Ti2vi/ojIduIHIuLBiDiY9/2hiHg4Ig51iP/HFx95Z/3xb64s/qk1bf+WifloW1Splk7/8G279le3/Y/WUyP5K6s5/nXozpLERtYdAAAA3CrS+jPwSTq6kE7T0dHGM/x7Y0danZmde+LEzHtnpxrPyg/HYFpc6Rpquh46nl8bLvITEQd/azRRzx/Jrxt/Xvp/PT86OVOd6nXw0Od2thn/mT9Lve4dsOl8Xwv6l/EP/cv4h/5l/EP/utn47/QfAoBbW6vx/2HntzgiwG3C/B/6l/EP/cv4h/5l/ENfWtWX5Ps08UW+jrZKf3qVeL5lUaTr/+Ra/mT5FglQokWil0clAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACA7vk3AAD//z014u4=")
r4 = openat(0xffffffffffffff9c, &(0x7f0000000040)='.\x00', 0x0, 0x0)
ioctl$FS_IOC_FIEMAP(r4, 0xc020660b, &(0x7f0000000200)=ANY=[@ANYBLOB="000000000000000009000000002000000600"/32])
ioctl$CDROM_SEND_PACKET(r3, 0x5393, 0x0)
ioctl$sock_FIOGETOWN(r1, 0x8903, &(0x7f00000000c0))
ioctl$BLKTRACESETUP(r1, 0xc0481273, 0x0)
fcntl$setown(r0, 0x8, 0x0)

0s ago: executing program 3 (id=4):
syz_mount_image$ext4(&(0x7f00000004c0)='ext4\x00', &(0x7f0000000040)='./file0\x00', 0x0, &(0x7f00000000c0)={[{@quota}, {@jqfmt_vfsv0}, {@nouid32}]}, 0x1, 0x4ae, &(0x7f0000000540)="$eJzs3cFPXFsZAPDvXqBQHu9BYxdq1NZarabpDExb0nRVNxrTNDE2rly0CFNCmGEIM9SCXdD/wcQmrvRPcGHiwqQr9+5056YuTKo2mmLiYsy9M1CgDNDXwiTc3y85uffcM53vnE7uOcM3MCeAwroYERsRcSYiHkbEePd60i1xp1Oyx715/XR28/XT2STa7fv/TPL27Frs+DeZT7rPORIRP/p+xE+Td+M219YXZ2q16kq3Xm7Vl8vNtfVrC/WZ+ep8dalSmZ6anrx1/Wblo431Qv23r763cPfHf/j9V1/+aeM7P8+6NdZt2zmOj6kz9KHtOJnBiLh7HMH6YKA7njP97gifSxoRpYi4lN//4zGQv5oAwGnWbo9He3xnHQA47dI8B5akpW4uYCzStFTq5PDOx2haazRbVx81VpfmOrmyiRhKHy3UqpPdXOFEDCVZfSo/f1uv7Klfj4hzEfGL4bN5vTTbqM31840PABTYJ3vW//8Md9Z/AOCUG+l3BwCAE2f9B4Disf4DQPFY/wGgeKz/AFA81n8AKB7rPwAUyg/v3ctKe7P7/ddzj9dWFxuPr81Vm4ul+upsabaxslyabzTm8+/sqR/2fLVGY3nqRqw+KbeqzVa5ubb+oN5YXWo9yL/X+0F16ERGBQAc5NyFF39JImLj9tm8xI69HKzVcLql/e4A0DcD/e4A0Dd2+4Li8jM+sM8Wvbvs+BWhs7sanh9Pf4Djd+VL8v9QVPL/UFzy/1Bc8v9QXO12Ys9/ACgYOX7gPT7/383n/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABTYWF6StNTdC3ws0rRUivg0IiZiKHm0UKtORsRnEfHn4aHhrD7V704DAB8o/XvS3f/ryvjlsb2tZ5L/DufHiPjZr+7/8slMq7UylV3/1/b11vPu9Uo/+g8AHGZrnd5ax7e8ef10dqucZH9efbezuWgWd7NbOi2DMZgfR2IoIkb/nXTrHdn7lYGPEH/jWUR8cb/xJ3luZKK78+ne+FnsT080frorfpq3dY7Z/8UX3j90zy1doSheZPPPnf3uvzQu5sf97/+RfIb6cFvz3+Y781+6Pf8N9Jj/Lh41xo0//qBn27OILw/uFz/Zjp/0iH/5iPH/+pWvXerV1v51xJXYP/7OWOVWfbncXFu/tlCfma/OV5cqlemp6clb129WynmOuryVqX7XP25f/eyg8Y/2iD9yyPi/ecTx/+Z/D3/y9QPif/sb+7/+5w+In62J3zpi/JnR3/Wc67P4cz3Gf9jrf/WI8V/+bX3uiA8FAE5Ac219caZWq644ceLEyfZJv2cm4Li9ven73RMAAAAAAAAAAAAAAKCXk/hzon6PEQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgNPr/wEAAP//aDbZbg==")
setxattr$trusted_overlay_upper(&(0x7f0000000000)='./file0\x00', &(0x7f0000000140), 0x0, 0x0, 0x0)
lsetxattr$trusted_overlay_upper(&(0x7f0000000040)='./file0\x00', &(0x7f0000000080), &(0x7f0000000b40)=ANY=[], 0x701, 0x0)
open(&(0x7f0000000100)='./file0/file0\x00', 0xa00, 0x0)

kernel console output (not intermixed with test programs):

Warning: Permanently added '[localhost]:10741' (ED25519) to the list of known hosts.
syzkaller login: [   17.966478] cgroup: Unknown subsys name 'net'
[   17.967348] cgroup: Unknown subsys name 'net_prio'
[   17.968521] cgroup: Unknown subsys name 'devices'
[   17.969532] cgroup: Unknown subsys name 'blkio'
[   18.016808] cgroup: Unknown subsys name 'hugetlb'
[   18.017908] cgroup: Unknown subsys name 'rlimit'
Setting up swapspace version 1, size = 122.1 MiB (127995904 bytes)
no label, UUID=c4faf2e5-47b4-45e8-a89e-0a5634238dee
[   18.093152] Adding 124996k swap on ./swap-file.  Priority:0 extents:1 across:124996k 
[   18.641893] audit: type=1400 audit(1731119507.217:6): avc:  denied  { execmem } for  pid=227 comm="syz-executor" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
[   24.492641] EXT4-fs (loop0): Unrecognized mount option "audit" or missing value
[   24.503301] audit: type=1400 audit(1731119513.079:7): avc:  denied  { open } for  pid=1999 comm="syz.0.1" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=perf_event permissive=1
[   24.634951] hrtimer: interrupt took 32080 ns
[   24.664295] EXT4-fs (loop3): Quota format mount options ignored when QUOTA feature is enabled
[   24.673868] EXT4-fs (loop3): mounted filesystem without journal. Opts: quota,jqfmt=vfsv0,nouid32,,errors=continue
[   24.675585] ext4 filesystem being mounted at /0/file0 supports timestamps until 2038 (0x7fffffff)
[   24.685756] 
[   24.686039] ======================================================
[   24.686930] WARNING: possible circular locking dependency detected
[   24.687847] 5.10.0 #1 Not tainted
[   24.688518] ------------------------------------------------------
[   24.689607] syz.3.4/2036 is trying to acquire lock:
[   24.690605] ffff888013b6d1d0 (&ei->i_mmap_sem){++++}-{3:3}, at: ext4_setattr+0xc42/0x20c0
[   24.692317] 
[   24.692317] but task is already holding lock:
[   24.693428] ffff888013b6d348 (&ea_inode->i_rwsem#14/1){+.+.}-{3:3}, at: do_truncate+0x125/0x1f0
[   24.695008] 
[   24.695008] which lock already depends on the new lock.
[   24.695008] 
[   24.696229] 
[   24.696229] the existing dependency chain (in reverse order) is:
[   24.697349] 
[   24.697349] -> #3 (&ea_inode->i_rwsem#14/1){+.+.}-{3:3}:
[   24.698401]        down_write+0x8d/0x150
[   24.698992]        ext4_xattr_set_entry+0x299e/0x37c0
[   24.699724]        ext4_xattr_block_set+0x5b6/0x2f50
[   24.700427]        ext4_xattr_set_handle+0xd01/0x12b0
[   24.701161]        ext4_xattr_set+0x13a/0x340
[   24.701814]        __vfs_setxattr+0x10f/0x170
[   24.702461]        __vfs_setxattr_noperm+0x11a/0x4c0
[   24.703183]        __vfs_setxattr_locked+0x1bf/0x250
[   24.703927]        vfs_setxattr+0xe8/0x270
[   24.704518]        setxattr+0x23d/0x330
[   24.705068]        path_setxattr+0x170/0x190
[   24.705706]        __x64_sys_lsetxattr+0xbd/0x150
[   24.706413]        do_syscall_64+0x33/0x40
[   24.707008]        entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   24.707823] 
[   24.707823] -> #2 (&ei->xattr_sem){++++}-{3:3}:
[   24.708722]        down_write+0x8d/0x150
[   24.709294]        ext4_xattr_set_handle+0x15e/0x12b0
[   24.710066]        ext4_initxattrs+0xb5/0x120
[   24.710736]        security_inode_init_security+0x1a7/0x350
[   24.711557]        __ext4_new_inode+0x38ec/0x55b0
[   24.712234]        ext4_create+0x2ce/0x4d0
[   24.712849]        lookup_open+0xf52/0x1330
[   24.713483]        path_openat+0x93f/0x26f0
[   24.714105]        do_filp_open+0x17e/0x3c0
[   24.714737]        do_sys_openat2+0x16d/0x420
[   24.715379]        __x64_sys_openat+0x13f/0x1f0
[   24.716036]        do_syscall_64+0x33/0x40
[   24.716641]        entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   24.717458] 
[   24.717458] -> #1 (jbd2_handle){++++}-{0:0}:
[   24.718302]        start_this_handle+0x103d/0x1440
[   24.719021]        jbd2__journal_start+0x3d3/0x960
[   24.719747]        __ext4_journal_start_sb+0x210/0x490
[   24.720528]        ext4_truncate+0x50b/0x1390
[   24.721190]        ext4_setattr+0x13c9/0x20c0
[   24.721849]        notify_change+0xb9e/0x1090
[   24.722515]        do_truncate+0x134/0x1f0
[   24.723135]        do_sys_ftruncate+0x596/0x8b0
[   24.723815]        do_syscall_64+0x33/0x40
[   24.724431]        entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   24.725220] 
[   24.725220] -> #0 (&ei->i_mmap_sem){++++}-{3:3}:
[   24.726119]        __lock_acquire+0x2ac4/0x5ca0
[   24.726781]        lock_acquire+0x293/0x9b0
[   24.727388]        down_write+0x8d/0x150
[   24.727958]        ext4_setattr+0xc42/0x20c0
[   24.728592]        notify_change+0xb9e/0x1090
[   24.729233]        do_truncate+0x134/0x1f0
[   24.729842]        path_openat+0x1d7a/0x26f0
[   24.730478]        do_filp_open+0x17e/0x3c0
[   24.731082]        do_sys_openat2+0x16d/0x420
[   24.731731]        __x64_sys_open+0x119/0x1c0
[   24.732393]        do_syscall_64+0x33/0x40
[   24.733006]        entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   24.733821] 
[   24.733821] other info that might help us debug this:
[   24.733821] 
[   24.734983] Chain exists of:
[   24.734983]   &ei->i_mmap_sem --> &ei->xattr_sem --> &ea_inode->i_rwsem#14/1
[   24.734983] 
[   24.736632]  Possible unsafe locking scenario:
[   24.736632] 
[   24.737488]        CPU0                    CPU1
[   24.737546] FAT-fs (loop0): Unrecognized mount option "dotsàÿmask=0O" or missing value
[   24.738150]        ----                    ----
[   24.738152]   lock(&ea_inode->i_rwsem#14/1);
[   24.738161]                                lock(&ei->xattr_sem);
[   24.738166]                                lock(&ea_inode->i_rwsem#14/1);
[   24.742632]   lock(&ei->i_mmap_sem);
[   24.743152] 
[   24.743152]  *** DEADLOCK ***
[   24.743152] 
[   24.744013] 2 locks held by syz.3.4/2036:
[   24.744603]  #0: ffff88800abea438 (sb_writers#3){.+.+}-{0:0}, at: path_openat+0x1a6f/0x26f0
[   24.745828]  #1: ffff888013b6d348 (&ea_inode->i_rwsem#14/1){+.+.}-{3:3}, at: do_truncate+0x125/0x1f0
[   24.747184] 
[   24.747184] stack backtrace:
[   24.747830] CPU: 1 PID: 2036 Comm: syz.3.4 Not tainted 5.10.0 #1
[   24.748720] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   24.750135] Call Trace:
[   24.750530]  dump_stack+0x107/0x163
[   24.751060]  check_noncircular+0x25f/0x2e0
[   24.751693]  ? print_circular_bug+0x450/0x450
[   24.752325]  ? alloc_chain_hlocks+0x4bf/0xc80
[   24.752985]  __lock_acquire+0x2ac4/0x5ca0
[   24.753584]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   24.754340]  ? avc_has_extended_perms+0xf60/0xf60
[   24.755071]  lock_acquire+0x293/0x9b0
[   24.755625]  ? ext4_setattr+0xc42/0x20c0
[   24.756197]  ? lock_release+0x6f0/0x6f0
[   24.756764]  ? avc_has_perm+0x108/0x1b0
[   24.757330]  ? __dquot_initialize+0x2b2/0xd60
[   24.757989]  down_write+0x8d/0x150
[   24.758511]  ? ext4_setattr+0xc42/0x20c0
[   24.759094]  ? down_write_killable_nested+0x180/0x180
[   24.759847]  ? __inode_security_revalidate+0x108/0x150
[   24.760604]  ? inode_newsize_ok+0x121/0x1e0
[   24.761211]  ? ext4_fc_start_update+0xa2/0x2e0
[   24.761857]  ? selinux_inode_setattr+0x2c4/0x380
[   24.762534]  ext4_setattr+0xc42/0x20c0
[   24.763086]  ? current_time+0x1e6/0x2c0
[   24.763668]  ? igrab+0xb0/0xb0
[   24.764122]  ? ext4_journalled_write_end+0x1210/0x1210
[   24.764889]  notify_change+0xb9e/0x1090
[   24.765479]  do_truncate+0x134/0x1f0
[   24.766012]  ? file_open_root+0x420/0x420
[   24.766605]  ? security_file_open+0x20b/0x500
[   24.767255]  ? may_open+0x1e4/0x400
[   24.767777]  path_openat+0x1d7a/0x26f0
[   24.768331]  ? path_lookupat+0x6c0/0x6c0
[   24.768917]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   24.769676]  do_filp_open+0x17e/0x3c0
[   24.770223]  ? may_open_dev+0xf0/0xf0
[   24.770760]  ? do_raw_spin_lock+0x121/0x260
[   24.771365]  ? rwlock_bug.part.0+0x90/0x90
[   24.771953]  ? _raw_spin_unlock+0x24/0x40
[   24.772544]  ? __alloc_fd+0x2af/0x620
[   24.773073]  do_sys_openat2+0x16d/0x420
[   24.773630]  ? do_raw_spin_unlock+0x4f/0x210
[   24.774244]  ? build_open_flags+0x660/0x660
[   24.774856]  ? dput+0x47a/0xc70
[   24.775328]  __x64_sys_open+0x119/0x1c0
[   24.775910]  ? __x64_sys_openat2+0x280/0x280
[   24.776554]  ? syscall_enter_from_user_mode+0x27/0x80
[   24.777277]  do_syscall_64+0x33/0x40
[   24.777814]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   24.778552] RIP: 0033:0x7f4e35ba3ef9
[   24.779076] Code: ff ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 a8 ff ff ff f7 d8 64 89 01 48
[   24.781707] RSP: 002b:00007f4e3481d038 EFLAGS: 00000246 ORIG_RAX: 0000000000000002
[   24.782782] RAX: ffffffffffffffda RBX: 00007f4e35d5bf80 RCX: 00007f4e35ba3ef9
[   24.783807] RDX: 0000000000000000 RSI: 0000000000000a00 RDI: 0000000020000100
[   24.784827] RBP: 00007f4e35c16b76 R08: 0000000000000000 R09: 0000000000000000
[   24.785846] R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
[   24.786884] R13: 0000000000000000 R14: 00007f4e35d5bf80 R15: 00007ffefbda9318
[   24.942552] EXT4-fs (loop0): 1 truncate cleaned up
[   24.943496] EXT4-fs (loop0): mounted filesystem without journal. Opts: ,errors=continue

VM DIAGNOSIS:
10:31:53  Registers:
info registers vcpu 0

CPU#0
RAX=000055684dadf840 RBX=0000000000001000 RCX=000055684dade830 RDX=00007fa95bda8be0
RSI=0000000000600000 RDI=000055684dade830 RBP=0000000000001010 RSP=00007ffcb510e860
R8 =0000000000000003 R9 =00007fa95bda8be0 R10=0000000000200000 R11=0000000000000000
R12=00007fa95bda8b80 R13=0000000000007cc0 R14=0000000000006cb0 R15=000055684dade830
RIP=00007fa95bc5ed93 RFL=00000246 [---Z-P-] CPL=3 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0033 0000000000000000 ffffffff 00a0fb00 DPL=3 CS64 [-RA]
SS =002b 0000000000000000 ffffffff 00c0f300 DPL=3 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007fa95bbb1540 00000000 00000000
GS =0000 0000000000000000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=000055684dadf858 CR3=000000000c324000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 2525252525252525 2525252525252525
YMM01=0000000000000000 0000000000000000 0000000000000000 0000ffffffffffff
YMM02=0000000000000000 0000000000000000 0000000000000000 0000ffffffffffff
YMM03=0000000000000000 0000000000000000 0000000000000000 0000ff00000000ff
YMM04=0000000000000000 0000000000000000 2f2f2f2f2f2f2f2f 2f2f2f2f2f2f2f2f
YMM05=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM06=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 676f6c206d6f7473 7563000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=dffffc0000000060 RBX=0000000000000005 RCX=0000000000000000 RDX=00000000000003fd
RSI=ffffffff823c0aec RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff888018c66f88
R8 =0000000000000001 R9 =0000000000000003 R10=000000000000001f R11=0000000000000001
R12=0000000000000000 R13=fffffbfff0f492a7 R14=fffffbfff0f4925e R15=dffffc0000000000
RIP=ffffffff823c0b14 RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007f4e3481d6c0 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=000000110c2d204a CR3=0000000010d1a000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 65756e69746e6f63 3d73726f7272652c
YMM01=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM02=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM03=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM04=0000000000000000 0000000000000000 0000000000000000 00007f4e3481c5a0
YMM05=0000000000000000 0000000000000000 0000000000000000 00007f4e3481c6e0
YMM06=0000000000000000 0000000000000000 00007f4e3481c6e0 00007f4e3481c560
YMM07=0000000000000000 0000000000000000 00007f4e3481c5a0 00007f4e3481c580
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 00007f4e35c17b19
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
