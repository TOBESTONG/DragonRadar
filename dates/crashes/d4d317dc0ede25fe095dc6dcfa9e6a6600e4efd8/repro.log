Warning: Permanently added '[localhost]:39896' (ED25519) to the list of known hosts.
syzkaller login: [  165.930426] audit: type=1400 audit(1730922869.950:6): avc:  denied  { execmem } for  pid=237 comm="syz-executor274" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
executing program
[  165.985357] EXT4-fs (loop0): inline encryption not supported
[  165.986429] EXT4-fs (loop0): Test dummy encryption mount option ignored
[  165.987545] EXT4-fs: Warning: mounting with data=journal disables delayed allocation, dioread_nolock, O_DIRECT and fast_commit support!
[  165.995133] EXT4-fs error (device loop0) in ext4_do_update_inode:5151: error 27
[  165.996774] EXT4-fs (loop0): Remounting filesystem read-only
[  165.998610] EXT4-fs error (device loop0): ext4_dirty_inode:5942: inode #3: comm syz-executor274: mark_inode_dirty error
[  166.000992] EXT4-fs error (device loop0) in ext4_do_update_inode:5151: error 27
[  166.002445] EXT4-fs error (device loop0): __ext4_ext_dirty:169: inode #3: comm syz-executor274: mark_inode_dirty error
[  166.004474] Quota error (device loop0): write_blk: dquota write failed
[  166.005607] Quota error (device loop0): qtree_write_dquot: Error -27 occurred while creating quota
[  166.007462] EXT4-fs (loop0): 1 orphan inode deleted
[  166.008204] EXT4-fs (loop0): mounting with "discard" option, but the device does not support discard
[  166.009687] EXT4-fs (loop0): mounted filesystem without journal. Opts: grpjquota=,grpid,i_version,inlinecrypt,noinit_itable,test_dummy_encryption,errors=remount-ro,
[  166.012275] ext4 filesystem being mounted at /0/file1 supports timestamps until 2038 (0x7fffffff)
[  170.964593] syz-executor274 (240) used greatest stack depth: 23352 bytes left
[  170.970117] EXT4-fs warning (device loop0): ext4_empty_dir:2891: inode #11: comm syz-executor274: directory missing '..'
[  170.972802] EXT4-fs error (device loop0): mb_free_blocks:1506: group 0, inode 11: block 7:freeing already freed block (bit 7); block bitmap corrupt.
[  170.977013] EXT4-fs (loop0): Remounting filesystem read-only
[  170.978472] EXT4-fs error (device loop0): ext4_mb_generate_buddy:802: group 0, block bitmap and bg descriptor inconsistent: 44 vs 45 free clusters
[  170.991952] EXT4-fs error (device loop0): ext4_lookup:1708: inode #2: comm syz-executor274: deleted inode referenced: 16
[  170.994966] EXT4-fs error (device loop0): ext4_lookup:1708: inode #2: comm syz-executor274: deleted inode referenced: 16
[  171.004921] Quota error (device loop0): dqput: Can't write quota structure (error -30). Quota may get out of sync!
[  171.011626] ------------[ cut here ]------------
[  171.013286] kernel BUG at fs/ext4/inode.c:833!
[  171.016287] invalid opcode: 0000 [#1] PREEMPT SMP KASAN NOPTI
[  171.018885] CPU: 1 PID: 238 Comm: syz-executor274 Not tainted 5.10.0 #1
[  171.022280] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[  171.025351] RIP: 0010:ext4_getblk+0x5db/0x6a0
[  171.026723] Code: 02 e8 69 7a a0 ff 4c 89 ef e8 b1 8b e0 ff e9 33 fd ff ff e8 57 7a a0 ff 4c 89 ef e8 ff 70 e0 ff e9 85 fe ff ff e8 45 7a a0 ff <0f> 0b 48 c7 c7 a0 e1 2f 85 e8 46 f7 3a 02 48 89 ef e8 7f aa cd ff
[  171.032443] RSP: 0018:ffff888010f5f270 EFLAGS: 00010293
[  171.033968] RAX: 0000000000000000 RBX: 1ffff110021ebe50 RCX: ffffffff81a5939b
[  171.036039] RDX: ffff888008f88000 RSI: ffffffff81a5947b RDI: 0000000000000005
[  171.037985] RBP: ffff888018898360 R08: 0000000000001400 R09: ffffffff86e5f73f
[  171.040007] R10: 0000000000000000 R11: 0000000000000001 R12: ffff888018898338
[  171.042050] R13: 0000000000000021 R14: 0000000000000000 R15: 0000000000000001
[  171.044075] FS:  0000000000000000(0000) GS:ffff88806cf00000(0000) knlGS:0000000000000000
[  171.046381] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  171.047960] CR2: 00007f63edbd35f0 CR3: 000000000b816000 CR4: 0000000000350ee0
[  171.049935] Call Trace:
[  171.050662]  ? ext4_iomap_overwrite_begin+0xa0/0xa0
[  171.052022]  ? evict_inodes+0x3c1/0x5e0
[  171.053103]  ? kill_block_super+0x9d/0xf0
[  171.053966]  ? deactivate_super+0xad/0xd0
[  171.054637]  ? cleanup_mnt+0x3c8/0x580
[  171.055256]  ext4_bread+0x29/0x210
[  171.055825]  ext4_quota_write+0x26b/0x680
[  171.056491]  ? ext4_quota_on+0xa20/0xa20
[  171.057132]  ? slab_free_freelist_hook+0x53/0x130
[  171.057895]  ? ext4_quota_on+0xa20/0xa20
[  171.058539]  write_blk+0x12f/0x220
[  171.059108]  remove_free_dqentry+0x1eb/0x4b0
[  171.059816]  remove_tree+0xa0f/0x1100
[  171.060421]  ? qtree_read_dquot+0x760/0x760
[  171.061120]  ? qid_valid+0x140/0x140
[  171.061708]  ? ext4_quota_read+0x293/0x320
[  171.062385]  remove_tree+0x1eb/0x1100
[  171.062996]  ? qtree_read_dquot+0x760/0x760
[  171.063694]  ? qid_valid+0x140/0x140
[  171.064283]  ? ext4_quota_read+0x293/0x320
[  171.064947]  remove_tree+0x1eb/0x1100
[  171.065561]  ? qtree_read_dquot+0x760/0x760
[  171.066259]  ? qid_valid+0x140/0x140
[  171.066831]  ? ext4_quota_read+0x293/0x320
[  171.067500]  remove_tree+0x1eb/0x1100
[  171.068104]  ? qtree_read_dquot+0x760/0x760
[  171.068766]  qtree_release_dquot+0x1a2/0x1e0
[  171.069484]  ? qtree_delete_dquot+0x100/0x100
[  171.070200]  v2_release_dquot+0xce/0x120
[  171.070836]  dquot_release+0x1d5/0x450
[  171.071452]  ? v2_get_next_id+0xb0/0xb0
[  171.072098]  ext4_release_dquot+0x2a9/0x340
[  171.072781]  dqput.part.0+0x1d2/0x7e0
[  171.073387]  __dquot_drop+0x1cc/0x2a0
[  171.073980]  ? dquot_quota_enable+0x2a0/0x2a0
[  171.074692]  ? ext4_es_lookup_extent+0xc90/0xc90
[  171.075444]  ? _raw_spin_unlock_irq+0x1f/0x40
[  171.076150]  dquot_drop+0x151/0x1a0
[  171.076720]  ext4_clear_inode+0x52/0x1e0
[  171.077337]  ext4_evict_inode+0x1cb/0x1890
[  171.077983]  ? evict+0x24b/0x6d0
[  171.078516]  ? lock_downgrade+0x6d0/0x6d0
[  171.079165]  ? var_wake_function+0x130/0x130
[  171.079866]  ? ext4_da_write_begin+0xe60/0xe60
[  171.080589]  ? rwlock_bug.part.0+0x90/0x90
[  171.081263]  ? ext4_da_write_begin+0xe60/0xe60
[  171.081988]  evict+0x284/0x6d0
[  171.082497]  evict_inodes+0x3c1/0x5e0
[  171.083120]  ? new_inode+0x240/0x240
[  171.083705]  ? shrink_dcache_for_umount+0x165/0x330
[  171.084523]  generic_shutdown_super+0xa6/0x370
[  171.085258]  kill_block_super+0x9d/0xf0
[  171.085886]  deactivate_locked_super+0x95/0x110
[  171.086629]  deactivate_super+0xad/0xd0
[  171.087260]  cleanup_mnt+0x3c8/0x580
[  171.087841]  task_work_run+0xe2/0x1a0
[  171.088446]  do_exit+0xb29/0x28e0
[  171.088997]  ? mm_update_next_owner+0x7e0/0x7e0
[  171.089736]  ? vmacache_find+0x55/0x2c0
[  171.090383]  do_group_exit+0x125/0x310
[  171.091004]  __x64_sys_exit_group+0x3a/0x50
[  171.091694]  do_syscall_64+0x33/0x40
[  171.092296]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[  171.093120] RIP: 0033:0x7eff305651ed
[  171.093699] Code: Unable to access opcode bytes at RIP 0x7eff305651c3.
[  171.094759] RSP: 002b:00007ffc7101f038 EFLAGS: 00000202 ORIG_RAX: 00000000000000e7
[  171.095964] RAX: ffffffffffffffda RBX: 0000000000000001 RCX: 00007eff305651ed
[  171.097130] RDX: 00000000000000e7 RSI: ffffffffffffffc0 RDI: 0000000000000001
[  171.098231] RBP: 00007ffc7101f090 R08: 0000000000000000 R09: 0000000000000000
[  171.099336] R10: 0000000000000100 R11: 0000000000000202 R12: 0000000000000000
[  171.100449] R13: 0000000000000001 R14: 0000000000000001 R15: 00007eff305fc600
[  171.101561] Modules linked in:
[  171.102162] ---[ end trace 650fba2da9fc10e7 ]---
[  171.102948] RIP: 0010:ext4_getblk+0x5db/0x6a0
[  171.103697] Code: 02 e8 69 7a a0 ff 4c 89 ef e8 b1 8b e0 ff e9 33 fd ff ff e8 57 7a a0 ff 4c 89 ef e8 ff 70 e0 ff e9 85 fe ff ff e8 45 7a a0 ff <0f> 0b 48 c7 c7 a0 e1 2f 85 e8 46 f7 3a 02 48 89 ef e8 7f aa cd ff
[  171.106655] RSP: 0018:ffff888010f5f270 EFLAGS: 00010293
[  171.107521] RAX: 0000000000000000 RBX: 1ffff110021ebe50 RCX: ffffffff81a5939b
[  171.108705] RDX: ffff888008f88000 RSI: ffffffff81a5947b RDI: 0000000000000005
[  171.109885] RBP: ffff888018898360 R08: 0000000000001400 R09: ffffffff86e5f73f
[  171.111055] R10: 0000000000000000 R11: 0000000000000001 R12: ffff888018898338
[  171.112216] R13: 0000000000000021 R14: 0000000000000000 R15: 0000000000000001
[  171.113390] FS:  0000000000000000(0000) GS:ffff88806cf00000(0000) knlGS:0000000000000000
[  171.114705] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  171.115681] CR2: 00007f63edbd35f0 CR3: 000000000b816000 CR4: 0000000000350ee0
[  171.116868] Fixing recursive fault but reboot is needed!

VM DIAGNOSIS:
03:54:35  Registers:
info registers vcpu 0

CPU#0
RAX=0000000000000000 RBX=0000000000000000 RCX=ffffffff8177f0eb RDX=ffff888008c41a00
RSI=0000000000000000 RDI=0000000000000000 RBP=ffff888010680000 RSP=ffff88800b74fad0
R8 =0000000000000001 R9 =ffff88801068007f R10=0000000000000000 R11=0000000000000001
R12=ffff888008c41a00 R13=ffff88800b74fc48 R14=0000000000000001 R15=ffff88800b74fdf8
RIP=ffffffff81460684 RFL=00000246 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007f63ee73d900 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f63edbc4f50 CR3=000000000b816000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM01=0000000000000000 0000000000000000 6434653961613931 3133393166663836
YMM02=0000000000000000 0000000000000000 6164346539616139 3131333931666638
YMM03=0000000000000000 0000000000000000 2f6c616e72756f6a 2f676f6c2f6e7572
YMM04=0000000000000000 0000000000000000 5d51f400820a49fc 0000000000129e18
YMM05=0000000000000000 0000000000000000 d3fdd5f48436fbd7 00000000000aeab8
YMM06=0000000000000000 0000000000000000 cd40705f558bc00c 00000000000ae970
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 44495f474f4c5359 530069253d595449
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 2020000000002020 2020202020200000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=dffffc0000000060 RBX=0000000000000005 RCX=0000000000000000 RDX=00000000000003fd
RSI=ffffffff823c0aec RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff888010f5ebc8
R8 =0000000000000000 R9 =ffffffff85d66c0f R10=000000000000001f R11=0000000000000001
R12=0000000000000000 R13=fffffbfff0f492a7 R14=fffffbfff0f4925e R15=dffffc0000000000
RIP=ffffffff823c0b14 RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f63edbd35f0 CR3=000000000b816000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 3d3d3d3d3d3d3d3d 3d3d3d3d3d3d3d3d
YMM01=0000000000000000 0000000000000000 0000000000000000 333d595449524f49
YMM02=0000000000000000 0000000000000000 ffffffffffffffff ffffffffffffffff
YMM03=0000000000000000 0000000000000000 2f6c616e72756f6a 2f676f6c2f6e7572
YMM04=0000000000000000 0000000000000000 7d64647b5a7d40e5 00000000001295e8
YMM05=0000000000000000 0000000000000000 d3fdd5f48436fbd7 00000000000aeab8
YMM06=0000000000000000 0000000000000000 cd40705f558bc00c 00000000000ae970
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 44495f474f4c5359 530069253d595449
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 2020000000002020 2020202020200000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
