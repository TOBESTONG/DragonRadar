Warning: Permanently added '[localhost]:60260' (ED25519) to the list of known hosts.
syzkaller login: [   21.577880] audit: type=1400 audit(1731336955.146:6): avc:  denied  { execmem } for  pid=237 comm="syz-executor953" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
executing program
[   21.604227] ------------[ cut here ]------------
[   21.605046] WARNING: CPU: 0 PID: 238 at mm/page_alloc.c:4930 __alloc_pages_nodemask+0x58a/0x6a0
[   21.606634] Modules linked in:
[   21.607186] CPU: 0 PID: 238 Comm: syz-executor953 Not tainted 5.10.0 #1
[   21.608263] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   21.610211] RIP: 0010:__alloc_pages_nodemask+0x58a/0x6a0
[   21.611841] Code: 00 00 0c 00 0f 85 86 00 00 00 4c 89 c2 44 89 e6 44 89 ff c6 44 24 70 00 4c 89 6c 24 58 e8 de d6 ff ff 49 89 c6 e9 17 fd ff ff <0f> 0b e9 d6 fd ff ff 4c 89 44 24 18 4c 89 44 24 10 89 74 24 0c 4c
[   21.615141] RSP: 0018:ffff88800ad97590 EFLAGS: 00010246
[   21.615932] RAX: 0000000000000000 RBX: 1ffff110015b2eb6 RCX: 0000000000000000
[   21.617103] RDX: 0000000000000000 RSI: dffffc0000000000 RDI: 0000000000040dc0
[   21.618227] RBP: 0000000000000000 R08: 0000000000000001 R09: ffff88800ad977cf
[   21.619356] R10: 0000000000000000 R11: 0000000000000001 R12: 0000000000000015
[   21.620488] R13: 0000000000000015 R14: 0000000000000000 R15: ffff8880107c4808
[   21.621615] FS:  0000555555a5e380(0000) GS:ffff88806ce00000(0000) knlGS:0000000000000000
[   21.622884] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[   21.623831] CR2: 0000000020000000 CR3: 000000000ff12000 CR4: 0000000000350ef0
[   21.624955] Call Trace:
[   21.625402]  ? __alloc_pages_slowpath.constprop.0+0x23a0/0x23a0
[   21.626529]  ? fs_reclaim_release+0x90/0xd0
[   21.627237]  alloc_pages_current+0x191/0x2a0
[   21.627932]  kmalloc_order+0x32/0xa0
[   21.628554]  kmalloc_order_trace+0x14/0x110
[   21.629252]  hashtab_init+0xe0/0x1c0
[   21.629808]  ? memcpy+0x39/0x60
[   21.630349]  class_read+0x1d5/0x9b0
[   21.630904]  ? user_write+0x440/0x440
[   21.631535]  ? __kasan_kmalloc.constprop.0+0xc2/0xd0
[   21.632364]  policydb_read+0x8b7/0x6410
[   21.633028]  ? string_to_av_perm+0x1e0/0x1e0
[   21.633703]  ? find_held_lock+0x2c/0x110
[   21.634375]  ? fs_reclaim_release+0x90/0xd0
[   21.635104]  ? kasan_unpoison_shadow+0x33/0x40
[   21.635802]  ? __kasan_kmalloc.constprop.0+0xc2/0xd0
[   21.636644]  security_load_policy+0x1ab/0xfa0
[   21.637394]  ? security_get_bools+0x7c0/0x7c0
[   21.638146]  ? find_held_lock+0x2c/0x110
[   21.638783]  ? __might_fault+0xd3/0x180
[   21.639465]  ? lock_downgrade+0x6d0/0x6d0
[   21.640273]  sel_write_load+0x3a5/0x1e50
[   21.640890]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   21.641771]  ? sel_make_dir+0x2c0/0x2c0
[   21.642445]  ? lock_release+0x6f0/0x6f0
[   21.643115]  ? selinux_file_permission+0xcc/0x590
[   21.643872]  ? sel_make_dir+0x2c0/0x2c0
[   21.644518]  vfs_write+0x29a/0xac0
[   21.645108]  ksys_write+0x12d/0x250
[   21.645654]  ? __ia32_sys_read+0xb0/0xb0
[   21.646309]  ? syscall_enter_from_user_mode+0x27/0x80
[   21.647152]  do_syscall_64+0x33/0x40
[   21.647720]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   21.648562] RIP: 0033:0x7f76b506286d
[   21.649196] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[   21.652103] RSP: 002b:00007fff5e443dd8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
[   21.653306] RAX: ffffffffffffffda RBX: 0000555555a5e340 RCX: 00007f76b506286d
[   21.654434] RDX: 000000000000005c RSI: 0000000020000000 RDI: 0000000000000003
[   21.655555] RBP: 00007fff5e443e10 R08: 0000000000000000 R09: 0000000120080522
[   21.656675] R10: 0000000000000073 R11: 0000000000000246 R12: 00007fff5e443df0
[   21.657839] R13: 00007fff5e443fd8 R14: 00007f76b50f8c50 R15: 0000000000000001
[   21.659071] irq event stamp: 5743
[   21.659612] hardirqs last  enabled at (5751): [<ffffffff812d54e1>] console_unlock+0x991/0xba0
[   21.660979] hardirqs last disabled at (5760): [<ffffffff812d53cf>] console_unlock+0x87f/0xba0
[   21.662495] softirqs last  enabled at (5846): [<ffffffff84000f92>] asm_call_irq_on_stack+0x12/0x20
[   21.663890] softirqs last disabled at (5781): [<ffffffff84000f92>] asm_call_irq_on_stack+0x12/0x20
[   21.665299] ---[ end trace 7ee820b6b21d2e59 ]---
[   21.666096] general protection fault, probably for non-canonical address 0xdffffc0000000000: 0000 [#1] PREEMPT SMP KASAN NOPTI
[   21.667799] KASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007]
[   21.668941] CPU: 0 PID: 238 Comm: syz-executor953 Tainted: G        W         5.10.0 #1
[   21.670180] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   21.671703] RIP: 0010:hashtab_map+0x9e/0x1b0
[   21.672389] Code: 89 44 24 08 e8 03 d7 5e ff 48 8b 44 24 08 80 38 00 0f 85 f5 00 00 00 49 8b 55 00 8b 44 24 04 4c 8d 34 c2 4c 89 f2 48 c1 ea 03 <80> 3c 1a 00 0f 85 e5 00 00 00 4d 8b 36 4d 85 f6 75 25 eb 7d e8 c9
[   21.675202] RSP: 0018:ffff88800ad976b0 EFLAGS: 00010256
[   21.675989] RAX: 0000000000000000 RBX: dffffc0000000000 RCX: ffffffff81e7378e
[   21.677069] RDX: 0000000000000000 RSI: ffffffff81e737bd RDI: 0000000000000005
[   21.678128] RBP: ffffffff81e7d680 R08: 0000000000000001 R09: ffff88800ad977cf
[   21.679213] R10: 0000000000000000 R11: 0000000000000001 R12: 0000000000000000
[   21.680293] R13: ffff888008f07a98 R14: 0000000000000000 R15: 1ffff110011e0f53
[   21.681387] FS:  0000555555a5e380(0000) GS:ffff88806ce00000(0000) knlGS:0000000000000000
[   21.682643] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[   21.683526] CR2: 0000000020000000 CR3: 000000000ff12000 CR4: 0000000000350ef0
[   21.684626] Call Trace:
[   21.685026]  cls_destroy+0x48/0x3d0
[   21.685559]  class_read+0x1fa/0x9b0
[   21.686107]  ? user_write+0x440/0x440
[   21.686669]  ? __kasan_kmalloc.constprop.0+0xc2/0xd0
[   21.687428]  policydb_read+0x8b7/0x6410
[   21.688031]  ? string_to_av_perm+0x1e0/0x1e0
[   21.688677]  ? find_held_lock+0x2c/0x110
[   21.689297]  ? fs_reclaim_release+0x90/0xd0
[   21.689926]  ? kasan_unpoison_shadow+0x33/0x40
[   21.690614]  ? __kasan_kmalloc.constprop.0+0xc2/0xd0
[   21.691367]  security_load_policy+0x1ab/0xfa0
[   21.692051]  ? security_get_bools+0x7c0/0x7c0
[   21.692703]  ? find_held_lock+0x2c/0x110
[   21.693314]  ? __might_fault+0xd3/0x180
[   21.693892]  ? lock_downgrade+0x6d0/0x6d0
[   21.694515]  sel_write_load+0x3a5/0x1e50
[   21.695125]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   21.695890]  ? sel_make_dir+0x2c0/0x2c0
[   21.696506]  ? lock_release+0x6f0/0x6f0
[   21.697112]  ? selinux_file_permission+0xcc/0x590
[   21.697833]  ? sel_make_dir+0x2c0/0x2c0
[   21.698448]  vfs_write+0x29a/0xac0
[   21.698979]  ksys_write+0x12d/0x250
[   21.699543]  ? __ia32_sys_read+0xb0/0xb0
[   21.700165]  ? syscall_enter_from_user_mode+0x27/0x80
[   21.700946]  do_syscall_64+0x33/0x40
[   21.701495]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   21.702249] RIP: 0033:0x7f76b506286d
[   21.702792] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[   21.705564] RSP: 002b:00007fff5e443dd8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
[   21.706713] RAX: ffffffffffffffda RBX: 0000555555a5e340 RCX: 00007f76b506286d
[   21.707805] RDX: 000000000000005c RSI: 0000000020000000 RDI: 0000000000000003
[   21.708904] RBP: 00007fff5e443e10 R08: 0000000000000000 R09: 0000000120080522
[   21.709978] R10: 0000000000000073 R11: 0000000000000246 R12: 00007fff5e443df0
[   21.711073] R13: 00007fff5e443fd8 R14: 00007f76b50f8c50 R15: 0000000000000001
[   21.712157] Modules linked in:
[   21.712717] ---[ end trace 7ee820b6b21d2e5a ]---
[   21.713519] RIP: 0010:hashtab_map+0x9e/0x1b0
[   21.714203] Code: 89 44 24 08 e8 03 d7 5e ff 48 8b 44 24 08 80 38 00 0f 85 f5 00 00 00 49 8b 55 00 8b 44 24 04 4c 8d 34 c2 4c 89 f2 48 c1 ea 03 <80> 3c 1a 00 0f 85 e5 00 00 00 4d 8b 36 4d 85 f6 75 25 eb 7d e8 c9
[   21.717048] RSP: 0018:ffff88800ad976b0 EFLAGS: 00010256
[   21.717872] RAX: 0000000000000000 RBX: dffffc0000000000 RCX: ffffffff81e7378e
[   21.718988] RDX: 0000000000000000 RSI: ffffffff81e737bd RDI: 0000000000000005
[   21.720119] RBP: ffffffff81e7d680 R08: 0000000000000001 R09: ffff88800ad977cf
[   21.721244] R10: 0000000000000000 R11: 0000000000000001 R12: 0000000000000000
[   21.722349] R13: ffff888008f07a98 R14: 0000000000000000 R15: 1ffff110011e0f53
[   21.723436] FS:  0000555555a5e380(0000) GS:ffff88806ce00000(0000) knlGS:0000000000000000
[   21.724676] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[   21.725578] CR2: 0000000020000000 CR3: 000000000ff12000 CR4: 0000000000350ef0

VM DIAGNOSIS:
22:55:55  Registers:
info registers vcpu 0

CPU#0
RAX=dffffc0000000060 RBX=0000000000000005 RCX=0000000000000000 RDX=00000000000003fd
RSI=ffffffff823c0aec RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff88800ad96f30
R8 =0000000000000001 R9 =0000000000000003 R10=000000000000001f R11=0000000000000001
R12=0000000000000000 R13=fffffbfff0f492a7 R14=fffffbfff0f4925e R15=dffffc0000000000
RIP=ffffffff823c0b14 RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000555555a5e380 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=0000000020000000 CR3=000000000ff12000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 2525252525252525 2525252525252525
YMM01=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM02=0000000000000000 0000000000000000 0000000000000000 00000000000000ff
YMM03=0000000000000000 0000000000000000 0000000000000000 00000000000000ff
YMM04=0000000000000000 0000000000000000 00007f76b50eb8c0 00007f76b50fdb60
YMM05=0000000000000000 0000000000000000 0000000000000001 0000000000000001
YMM06=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM07=0000000000000000 0000000000000000 2f2f2f2f2f2f2f2f 2f2f2f2f2f2f2f2f
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=dffffc0000000000 RBX=ffff88800fd528a0 RCX=0000000000000001 RDX=ffffed10016f1f9c
RSI=0000000000000001 RDI=ffff88800fd528a4 RBP=1ffff110016f1f9c RSP=ffff88800b78fcd8
R8 =0000000000000000 R9 =ffffffff86e5f6b7 R10=fffffbfff0dcbed6 R11=0000000000000001
R12=00007fcce2891e50 R13=0000000008993067 R14=0000000000000001 R15=ffffffff84caa790
RIP=ffffffff812b8fe3 RFL=00000216 [----AP-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0000 0000000000000000 00000000 00000000
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007fcce3471900 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007fcce2891e50 CR3=000000000bd5a000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 3030203a65646f43 3d4547415353454d
YMM01=0000000000000000 0000000000000000 3820633420303020 3030203030203638
YMM02=0000000000000000 0000000000000000 2034322034342036 6320666620393820
YMM03=0000000000000000 0000000000000000 6666203664206564 2038652038352034
YMM04=0000000000000000 0000000000000000 3120343220343420 3938206334203831
YMM05=0000000000000000 0000000000000000 6666206466203664 203965206230203e
YMM06=0000000000000000 0000000000000000 3965203663203938 2039342066662066
YMM07=0000000000000000 0000000000000000 2063362039382063 3420303020303720
YMM08=0000000000000000 0000000000000000 44495f474f4c5359 530069253d595449
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
