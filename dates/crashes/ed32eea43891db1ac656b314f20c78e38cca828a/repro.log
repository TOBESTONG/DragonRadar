Warning: Permanently added '[localhost]:48298' (ED25519) to the list of known hosts.
syzkaller login: [  135.701316] audit: type=1400 audit(1730920890.482:6): avc:  denied  { execmem } for  pid=239 comm="syz-executor159" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
executing program
[  135.723853] EXT4-fs: Warning: mounting with data=journal disables delayed allocation, dioread_nolock, O_DIRECT and fast_commit support!
[  135.726488] EXT4-fs (loop0): encrypted files will use data=ordered instead of data journaling mode
[  135.734973] EXT4-fs error (device loop0): ext4_mb_generate_buddy:802: group 0, block bitmap and bg descriptor inconsistent: 191 vs 220 free clusters
[  135.738963] EXT4-fs warning (device loop0): ext4_expand_extra_isize_ea:2782: Unable to expand inode 15. Delete some EAs or run e2fsck.
[  135.741646] EXT4-fs (loop0): 1 truncate cleaned up
[  135.743070] EXT4-fs (loop0): mounted filesystem without journal. Opts: noload,resuid=0x000000000000ee01,debug_want_extra_isize=0x000000000000002e,lazytime,i_version,quota,,errors=continue
[  135.768990] ==================================================================
[  135.770638] BUG: KASAN: use-after-free in ext4_search_dir+0x25d/0x2a0
[  135.771959] Read of size 1 at addr ffff8880092d7ba9 by task syz-executor159/241
[  135.773999] 
[  135.774338] CPU: 0 PID: 241 Comm: syz-executor159 Not tainted 5.10.0 #1
[  135.776840] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[  135.779405] Call Trace:
[  135.780012]  dump_stack+0x107/0x163
[  135.780762]  ? ext4_search_dir+0x25d/0x2a0
[  135.781617]  ? ext4_search_dir+0x25d/0x2a0
[  135.782474]  print_address_description.constprop.0+0x1c/0x210
[  135.783663]  ? _raw_spin_lock_irqsave+0x4e/0x50
[  135.784633]  ? vprintk_func+0x95/0x250
[  135.785513]  ? ext4_search_dir+0x25d/0x2a0
[  135.786406]  ? ext4_search_dir+0x25d/0x2a0
[  135.787301]  kasan_report.cold+0x37/0x7c
[  135.788116]  ? ext4_search_dir+0x25d/0x2a0
[  135.788983]  ext4_search_dir+0x25d/0x2a0
[  135.789798]  ext4_find_inline_entry+0x2ba/0x4a0
[  135.790740]  ? ext4_try_create_inline_dir+0x2d0/0x2d0
[  135.791810]  __ext4_find_entry+0xb7c/0x10d0
[  135.792699]  ? d_alloc_parallel+0x821/0x1c30
[  135.793624]  ? ext4_dx_find_entry+0x430/0x430
[  135.794543]  ? d_alloc_parallel+0xa31/0x1c30
[  135.795472]  ext4_lookup+0x16b/0x650
[  135.796223]  ? __ext4_find_entry+0x10d0/0x10d0
[  135.797162]  ? find_held_lock+0x2c/0x110
[  135.798018]  ? lockdep_init_map_waits+0x26a/0x720
[  135.799034]  ? lockdep_init_map_waits+0x26a/0x720
[  135.800029]  ? __raw_spin_lock_init+0x34/0x100
[  135.801128]  __lookup_slow+0x252/0x490
[  135.801912]  ? vfs_unlink+0x610/0x610
[  135.802748]  ? inode_permission+0xa4/0x380
[  135.803676]  walk_component+0x41a/0x6a0
[  135.804583]  ? handle_dots.part.0+0x15a0/0x15a0
[  135.805590]  ? walk_component+0x6a0/0x6a0
[  135.806536]  path_lookupat+0x146/0x6c0
[  135.807371]  ? find_held_lock+0x2c/0x110
[  135.808227]  filename_lookup+0x19f/0x560
[  135.809077]  ? may_linkat+0x230/0x230
[  135.809907]  ? __check_object_size+0x319/0x440
[  135.810851]  ? strncpy_from_user+0x9e/0x490
[  135.811727]  ? getname_flags.part.0+0x1dd/0x4f0
[  135.812670]  __x64_sys_mount+0x1e9/0x300
[  135.813507]  ? path_mount+0x2060/0x2060
[  135.814319]  ? syscall_enter_from_user_mode+0x27/0x80
[  135.815368]  do_syscall_64+0x33/0x40
[  135.816153]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[  135.817243] RIP: 0033:0x7f754b32caad
[  135.817998] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[  135.821657] RSP: 002b:00007ffc77561f88 EFLAGS: 00000246 ORIG_RAX: 00000000000000a5
[  135.823225] RAX: ffffffffffffffda RBX: 00007ffc77562250 RCX: 00007f754b32caad
[  135.824615] RDX: 0000000000000000 RSI: 0000000020000180 RDI: 0000000000000000
[  135.826090] RBP: 0000000000000000 R08: 0000000000000000 R09: 00007ffc77561fb0
[  135.827576] R10: 0000000000000041 R11: 0000000000000246 R12: 00007ffc77562250
[  135.829006] R13: 00007ffc77561fd0 R14: 0000000000000000 R15: 00007ffc77561ff0
[  135.830434] 
[  135.830761] The buggy address belongs to the page:
[  135.831753] page:000000005d0f96d6 refcount:0 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x92d7
[  135.833598] flags: 0x100000000000000()
[  135.834400] raw: 0100000000000000 ffffea000024b508 ffffea000024b648 0000000000000000
[  135.836005] raw: 0000000000000000 0000000000100000 00000000ffffffff 0000000000000000
[  135.837538] page dumped because: kasan: bad access detected
[  135.838746] 
[  135.839136] Memory state around the buggy address:
[  135.840119]  ffff8880092d7a80: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
[  135.841630]  ffff8880092d7b00: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
[  135.843142] >ffff8880092d7b80: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
[  135.844636]                                   ^
[  135.845593]  ffff8880092d7c00: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
[  135.847042]  ffff8880092d7c80: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
[  135.848495] ==================================================================
[  135.849948] Disabling lock debugging due to kernel taint
[  135.861681] EXT4-fs error (device loop0): ext4_map_blocks:584: inode #2: block 13: comm syz-executor159: lblock 0 mapped to illegal pblock 13 (length 1)

VM DIAGNOSIS:
03:21:30  Registers:
info registers vcpu 0

CPU#0
RAX=dffffc0000000060 RBX=0000000000000005 RCX=0000000000000000 RDX=00000000000003fd
RSI=ffffffff823c0aec RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff888010fe70c8
R8 =0000000000000001 R9 =0000000000000003 R10=000000000000001f R11=0000000000000001
R12=0000000000000000 R13=fffffbfff0f492a7 R14=fffffbfff0f4925e R15=dffffc0000000000
RIP=ffffffff823c0b14 RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000555557133380 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=0000000020000180 CR3=000000000f91a000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 65756e69746e6f63 3d73726f7272652c
YMM01=0000000000000000 0000000000000000 ffffffffffffffff ffffffff00000000
YMM02=0000000000000000 0000000000000000 0000000000000000 00000000000000ff
YMM03=0000000000000000 0000000000000000 00000000000000ff 0000000000000000
YMM04=0000000000000000 0000000000000000 00007f754b3ae0c0 00007f754b3c0b80
YMM05=0000000000000000 0000000000000000 0000000000000001 0000000000000001
YMM06=0000000000000000 0000000000000000 ffffffffffffffff ffffffff00000000
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=0000000000000000 RBX=00007f852686f6c0 RCX=00007f8526e160f3 RDX=00007ffdeb840dc0
RSI=00007ffdeb840dc0 RDI=0000000000000010 RBP=0000000000000010 RSP=00007ffdeb840d70
R8 =0000000000000001 R9 =00007f8526dfebe0 R10=0000000000000000 R11=0000000000000246
R12=0000000000000000 R13=0000000000000011 R14=0000000000000011 R15=0000564547241721
RIP=0000564545e86815 RFL=00000246 [---Z-P-] CPL=3 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0033 0000000000000000 ffffffff 00a0fb00 DPL=3 CS64 [-RA]
SS =002b 0000000000000000 ffffffff 00c0f300 DPL=3 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007f852686f8c0 00000000 00000000
GS =0000 0000000000000000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f8526c84b90 CR3=000000000ff40000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 002f2e2e2f002e2e
YMM01=0000000000000000 0000000000000000 0000000000000000 00006c696146002f
YMM02=0000000000000000 0000000000000000 ffffffffffffffff ff0f0e0d0c0b0a09
YMM03=0000000000000000 0000000000000000 696e656420737365 636341002f737973
YMM04=0000000000000000 0000000000000000 2f2f2f2f2f2f2f2f 2f2f2f2f2f2f2f2f
YMM05=0000000000000000 0000000000000000 000056454721d3d0 000056454721d3b0
YMM06=0000000000000000 0000000000000000 000056454721d370 0000000000000000
YMM07=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM08=0000000000000000 0000000000000000 3a212d2b007b3d0d 0a0920002c0d0a09
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
