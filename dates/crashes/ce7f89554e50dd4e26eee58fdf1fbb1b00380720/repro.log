Warning: Permanently added '[localhost]:5378' (ED25519) to the list of known hosts.
executing program
syzkaller login: [   21.744144] audit: type=1400 audit(1730890557.547:6): avc:  denied  { execmem } for  pid=236 comm="syz-executor197" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
[   21.857930] 
[   21.858245] ============================================
[   21.859083] WARNING: possible recursive locking detected
[   21.859913] 5.10.0 #1 Not tainted
[   21.860469] --------------------------------------------
[   21.861332] syz-executor197/237 is trying to acquire lock:
[   21.862642] ffff8880194b0e50 (&type->i_mutex_dir_key#7){++++}-{3:3}, at: fuse_reverse_inval_entry+0x1f5/0x530
[   21.865305] 
[   21.865305] but task is already holding lock:
[   21.866835] ffff8880194b0150 (&type->i_mutex_dir_key#7){++++}-{3:3}, at: fuse_reverse_inval_entry+0x4c/0x530
[   21.868499] 
[   21.868499] other info that might help us debug this:
[   21.869566]  Possible unsafe locking scenario:
[   21.869566] 
[   21.870582]        CPU0
[   21.871030]        ----
[   21.871497]   lock(&type->i_mutex_dir_key#7);
[   21.872213]   lock(&type->i_mutex_dir_key#7);
[   21.872912] 
[   21.872912]  *** DEADLOCK ***
[   21.872912] 
[   21.873847]  May be due to missing lock nesting notation
[   21.873847] 
[   21.874955] 2 locks held by syz-executor197/237:
[   21.875730]  #0: ffff88801071cb38 (&fc->killsb){.+.+}-{3:3}, at: fuse_dev_do_write+0x2364/0x2a90
[   21.877228]  #1: ffff8880194b0150 (&type->i_mutex_dir_key#7){++++}-{3:3}, at: fuse_reverse_inval_entry+0x4c/0x530
[   21.878984] 
[   21.878984] stack backtrace:
[   21.879703] CPU: 0 PID: 237 Comm: syz-executor197 Not tainted 5.10.0 #1
[   21.880765] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[   21.882373] Call Trace:
[   21.882813]  dump_stack+0x107/0x163
[   21.883419]  __lock_acquire.cold+0x211/0x3d1
[   21.884121]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   21.884965]  ? find_held_lock+0x2c/0x110
[   21.885618]  lock_acquire+0x293/0x9b0
[   21.886233]  ? fuse_reverse_inval_entry+0x1f5/0x530
[   21.887019]  ? lock_release+0x6f0/0x6f0
[   21.887657]  ? do_raw_spin_unlock+0x4f/0x210
[   21.888372]  down_write+0x8d/0x150
[   21.888920]  ? fuse_reverse_inval_entry+0x1f5/0x530
[   21.889736]  ? down_write_killable_nested+0x180/0x180
[   21.890593]  ? dput+0x21a/0xc70
[   21.891168]  fuse_reverse_inval_entry+0x1f5/0x530
[   21.892547]  fuse_dev_do_write+0x2384/0x2a90
[   21.893800]  ? mark_lock+0xf5/0x32b0
[   21.894841]  ? mark_lock+0xf5/0x32b0
[   21.895859]  ? fuse_dev_read+0x1e0/0x1e0
[   21.896962]  ? futex_wait_setup+0x300/0x300
[   21.898224]  ? __lock_acquire+0xc2d/0x5ca0
[   21.899411]  fuse_dev_write+0x14d/0x1e0
[   21.900541]  ? fuse_dev_splice_write+0xa40/0xa40
[   21.901863]  ? lockdep_hardirqs_on_prepare+0x420/0x420
[   21.903331]  ? iov_iter_init+0x3c/0x130
[   21.904441]  new_sync_write+0x42c/0x670
[   21.905509]  ? new_sync_read+0x6f0/0x6f0
[   21.906642]  ? avc_policy_seqno+0x9/0x70
[   21.907775]  ? selinux_file_permission+0xcc/0x590
[   21.909101]  vfs_write+0x81b/0xac0
[   21.910085]  ksys_write+0x12d/0x250
[   21.911097]  ? __ia32_sys_read+0xb0/0xb0
[   21.912241]  ? syscall_enter_from_user_mode+0x27/0x80
[   21.913648]  do_syscall_64+0x33/0x40
[   21.914669]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   21.916111] RIP: 0033:0x7f02baeb082d
[   21.916861] Code: b3 66 2e 0f 1f 84 00 00 00 00 00 66 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48
[   21.919868] RSP: 002b:00007f02bae91208 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
[   21.921107] RAX: ffffffffffffffda RBX: 00007f02baf69a60 RCX: 00007f02baeb082d
[   21.922345] RDX: 000000000000002e RSI: 00000000200000c0 RDI: 0000000000000003
[   21.923550] RBP: 00007f02baf370f4 R08: 0000000000000000 R09: 0000000000000000
[   21.924777] R10: 0000000000000000 R11: 0000000000000246 R12: 00007f02baf350f0
[   21.925894] R13: 6573756600000000 R14: 0000600000000000 R15: 00007f02baf69a68

VM DIAGNOSIS:
18:55:57  Registers:
info registers vcpu 0

CPU#0
RAX=dffffc0000000060 RBX=0000000000000005 RCX=0000000000000000 RDX=00000000000003fd
RSI=ffffffff823c0aec RDI=ffffffff87a492e0 RBP=ffffffff87a492a0 RSP=ffff888010e1f1c0
R8 =0000000000000001 R9 =0000000000000003 R10=000000000000001f R11=0000000000000001
R12=0000000000000000 R13=fffffbfff0f492a7 R14=fffffbfff0f4925e R15=dffffc0000000000
RIP=ffffffff823c0b14 RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007f02bae916c0 00000000 00000000
GS =0000 ffff88806ce00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=0000000020001180 CR3=000000000ab5e000 CR4=00350ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM02=0000000000000000 0000000000000000 0000000000000000 00000000000000ff
YMM03=0000000000000000 0000000000000000 0000000000000000 00000000000000ff
YMM04=0000000000000000 0000000000000000 0000000000000340 00007f02baf37b24
YMM05=0000000000000000 0000000000000000 0000034000000340 0000000000000000
YMM06=0000000000000000 0000000000000000 000055555711d3d0 00007f02baf635e0
YMM07=0000000000000000 0000000000000000 0000000068308f53 00007f02baf37b24
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=ffffffff83eca430 RBX=ffff888008250000 RCX=ffffffff83eb246c RDX=0000000000000000
RSI=0000000000000001 RDI=0000000000000000 RBP=0000000000000001 RSP=ffff88800825fe78
R8 =0000000000000001 R9 =ffff88806cf3416b R10=ffffed100d9e682d R11=0000000000000001
R12=ffffed100104a000 R13=ffffffff85d66c08 R14=0000000000000000 R15=dffffc0000000000
RIP=ffffffff83eca43e RFL=00000206 [-----P-] CPL=0 II=0 A20=1 SMM=0 HLT=1
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ffff88806cf00000 00000000 00000000
LDT=0000 fffffe0000000000 00000000 00000000
TR =0040 fffffe000003e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe000003c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f02bae70d58 CR3=000000000ab5e000 CR4=00350ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM02=0000000000000000 0000000000000000 008003f701a0c23d 0000000000000013
YMM03=0000000000000000 0000000000000000 0000000068308f53 00007ffdd3d72d00
YMM04=0000000000000000 0000000000000000 0000000000000340 00007f02baf37b24
YMM05=0000000000000000 0000000000000000 0000034000000340 0000000000000000
YMM06=0000000000000000 0000000000000000 000055555711d3d0 00007f02baf635e0
YMM07=0000000000000000 0000000000000000 0000000068308f53 00007f02baf37b24
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM09=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
